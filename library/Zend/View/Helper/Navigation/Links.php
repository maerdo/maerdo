<php?php
php/php*php*
php php*php Zendphp Framework
php php*
php php*php LICENSE
php php*
php php*php Thisphp sourcephp filephp isphp subjectphp tophp thephp newphp BSDphp licensephp thatphp isphp bundled
php php*php withphp thisphp packagephp inphp thephp filephp LICENSEphp.txtphp.
php php*php Itphp isphp alsophp availablephp throughphp thephp worldphp-widephp-webphp atphp thisphp URLphp:
php php*php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsd
php php*php Ifphp youphp didphp notphp receivephp aphp copyphp ofphp thephp licensephp andphp arephp unablephp to
php php*php obtainphp itphp throughphp thephp worldphp-widephp-webphp,php pleasephp sendphp anphp email
php php*php tophp licensephp@zendphp.comphp sophp wephp canphp sendphp youphp aphp copyphp immediatelyphp.
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_View
php php*php php@subpackagephp Helper
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@versionphp php php php php$Idphp:php Linksphp.phpphp php2php0php0php9php6php php2php0php1php0php-php0php1php-php0php6php php0php2php:php0php5php:php0php9Zphp bkarwinphp php$
php php*php/

php/php*php*
php php*php php@seephp Zendphp_Viewphp_Helperphp_Navigationphp_HelperAbstract
php php*php/
requirephp_oncephp php'Zendphp/Viewphp/Helperphp/Navigationphp/HelperAbstractphp.phpphp'php;

php/php*php*
php php*php Helperphp forphp printingphp php<linkphp>php elements
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_View
php php*php php@subpackagephp Helper
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php/
classphp Zendphp_Viewphp_Helperphp_Navigationphp_Links
php php php php extendsphp Zendphp_Viewphp_Helperphp_Navigationphp_HelperAbstract
php{
php php php php php/php*php*php#php@php+
php php php php php php*php Constantsphp usedphp forphp specifyingphp whichphp linkphp typesphp tophp findphp andphp render
php php php php php php*
php php php php php php*php php@varphp int
php php php php php php*php/
php php php php constphp RENDERphp_ALTERNATEphp php php=php php0xphp0php0php0php1php;
php php php php constphp RENDERphp_STYLESHEETphp php=php php0xphp0php0php0php2php;
php php php php constphp RENDERphp_STARTphp php php php php php php=php php0xphp0php0php0php4php;
php php php php constphp RENDERphp_NEXTphp php php php php php php php=php php0xphp0php0php0php8php;
php php php php constphp RENDERphp_PREVphp php php php php php php php=php php0xphp0php0php1php0php;
php php php php constphp RENDERphp_CONTENTSphp php php php=php php0xphp0php0php2php0php;
php php php php constphp RENDERphp_INDEXphp php php php php php php=php php0xphp0php0php4php0php;
php php php php constphp RENDERphp_GLOSSARYphp php php php=php php0xphp0php0php8php0php;
php php php php constphp RENDERphp_COPYRIGHTphp php php=php php0xphp0php1php0php0php;
php php php php constphp RENDERphp_CHAPTERphp php php php php=php php0xphp0php2php0php0php;
php php php php constphp RENDERphp_SECTIONphp php php php php=php php0xphp0php4php0php0php;
php php php php constphp RENDERphp_SUBSECTIONphp php=php php0xphp0php8php0php0php;
php php php php constphp RENDERphp_APPENDIXphp php php php=php php0xphp1php0php0php0php;
php php php php constphp RENDERphp_HELPphp php php php php php php php=php php0xphp2php0php0php0php;
php php php php constphp RENDERphp_BOOKMARKphp php php php=php php0xphp4php0php0php0php;
php php php php constphp RENDERphp_CUSTOMphp php php php php php=php php0xphp8php0php0php0php;
php php php php constphp RENDERphp_ALLphp php php php php php php php php=php php0xffffphp;
php php php php php/php*php*php#php@php+php*php*php/

php php php php php/php*php*
php php php php php php*php Mapsphp renderphp constantsphp tophp Wphp3Cphp linkphp types
php php php php php php*
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp staticphp php$php_RELATIONSphp php=php arrayphp(
php php php php php php php php selfphp:php:RENDERphp_ALTERNATEphp php php=php>php php'alternatephp'php,
php php php php php php php php selfphp:php:RENDERphp_STYLESHEETphp php=php>php php'stylesheetphp'php,
php php php php php php php php selfphp:php:RENDERphp_STARTphp php php php php php php=php>php php'startphp'php,
php php php php php php php php selfphp:php:RENDERphp_NEXTphp php php php php php php php=php>php php'nextphp'php,
php php php php php php php php selfphp:php:RENDERphp_PREVphp php php php php php php php=php>php php'prevphp'php,
php php php php php php php php selfphp:php:RENDERphp_CONTENTSphp php php php=php>php php'contentsphp'php,
php php php php php php php php selfphp:php:RENDERphp_INDEXphp php php php php php php=php>php php'indexphp'php,
php php php php php php php php selfphp:php:RENDERphp_GLOSSARYphp php php php=php>php php'glossaryphp'php,
php php php php php php php php selfphp:php:RENDERphp_COPYRIGHTphp php php=php>php php'copyrightphp'php,
php php php php php php php php selfphp:php:RENDERphp_CHAPTERphp php php php php=php>php php'chapterphp'php,
php php php php php php php php selfphp:php:RENDERphp_SECTIONphp php php php php=php>php php'sectionphp'php,
php php php php php php php php selfphp:php:RENDERphp_SUBSECTIONphp php=php>php php'subsectionphp'php,
php php php php php php php php selfphp:php:RENDERphp_APPENDIXphp php php php=php>php php'appendixphp'php,
php php php php php php php php selfphp:php:RENDERphp_HELPphp php php php php php php php=php>php php'helpphp'php,
php php php php php php php php selfphp:php:RENDERphp_BOOKMARKphp php php php=php>php php'bookmarkphp'
php php php php php)php;

php php php php php/php*php*
php php php php php php*php Thephp helperphp'sphp renderphp flag
php php php php php php*
php php php php php php*php php@seephp renderphp(php)
php php php php php php*php php@seephp setRenderFlagphp(php)
php php php php php php*php php@varphp int
php php php php php php*php/
php php php php protectedphp php$php_renderFlagphp php=php selfphp:php:RENDERphp_ALLphp;

php php php php php/php*php*
php php php php php php*php Rootphp container
php php php php php php*
php php php php php php*php Usedphp forphp preventingphp methodsphp tophp traversephp abovephp thephp containerphp givenphp to
php php php php php php*php thephp php{php@linkphp renderphp(php)php}php methodphp.
php php php php php php*
php php php php php php*php php@seephp php_findRootphp(php)
php php php php php php*
php php php php php php*php php@varphp Zendphp_Navigationphp_Container
php php php php php php*php/
php php php php protectedphp php$php_rootphp;

php php php php php/php*php*
php php php php php php*php Viewphp helperphp entryphp pointphp:
php php php php php php*php Retrievesphp helperphp andphp optionallyphp setsphp containerphp tophp operatephp on
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Containerphp php$containerphp php php[optionalphp]php containerphp to
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php operatephp on
php php php php php php*php php@returnphp Zendphp_Viewphp_Helperphp_Navigationphp_Linksphp php php php php fluentphp interfacephp,php returns
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php self
php php php php php php*php/
php php php php publicphp functionphp linksphp(Zendphp_Navigationphp_Containerphp php$containerphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(nullphp php!php=php=php php$containerphp)php php{
php php php php php php php php php php php php php$thisphp-php>setContainerphp(php$containerphp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Magicphp overloadphp:php Proxyphp callsphp tophp php{php@linkphp findRelationphp(php)php}php orphp container
php php php php php php*
php php php php php php*php Examplesphp ofphp finderphp callsphp:
php php php php php php*php php<codephp>
php php php php php php*php php/php/php METHODphp php php php php php php php php php php php php php php php php php php/php/php SAMEphp AS
php php php php php php*php php$hphp-php>findRelNextphp(php$pagephp)php;php php php php php/php/php php$hphp-php>findRelationphp(php$pagephp,php php'relphp'php,php php'nextphp'php)
php php php php php php*php php$hphp-php>findRevSectionphp(php$pagephp)php;php php/php/php php$hphp-php>findRelationphp(php$pagephp,php php'revphp'php,php php'sectionphp'php)php;
php php php php php php*php php$hphp-php>findRelFoophp(php$pagephp)php;php php php php php php/php/php php$hphp-php>findRelationphp(php$pagephp,php php'relphp'php,php php'foophp'php)php;
php php php php php php*php <php/codephp>
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$methodphp php php php php php php php php php php php php methodphp name
php php php php php php*php php@paramphp php arrayphp php php$argumentsphp php php php php php php php php php methodphp arguments
php php php php php php*php php@throwsphp Zendphp_Navigationphp_Exceptionphp php ifphp methodphp doesphp notphp existphp inphp container
php php php php php php*php/
php php php php publicphp functionphp php_php_callphp(php$methodphp,php arrayphp php$argumentsphp php=php arrayphp(php)php)
php php php php php{
php php php php php php php php ifphp php(php@pregphp_matchphp(php'php/findphp(Relphp|Revphp)php(php.php+php)php/php'php,php php$methodphp,php php$matchphp)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>findRelationphp(php$argumentsphp[php0php]php,
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php strtolowerphp(php$matchphp[php1php]php)php,
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php strtolowerphp(php$matchphp[php2php]php)php)php;
php php php php php php php php php}

php php php php php php php php returnphp parentphp:php:php_php_callphp(php$methodphp,php php$argumentsphp)php;
php php php php php}

php php php php php/php/php Accessorsphp:

php php php php php/php*php*
php php php php php php*php Setsphp thephp helperphp'sphp renderphp flag
php php php php php php*
php php php php php php*php Thephp helperphp usesphp thephp bitwisephp php'php&php'php operatorphp againstphp thephp hexphp valuesphp ofphp the
php php php php php php*php renderphp constantsphp.php Thisphp meansphp thatphp thephp flagphp canphp isphp php"bitwisedphp"php valuephp of
php php php php php php*php thephp renderphp constantsphp.php Examplesphp:
php php php php php php*php php<codephp>
php php php php php php*php php/php/php renderphp allphp linksphp exceptphp glossary
php php php php php php*php php$flagphp php=php Zendphp_Viewphp_Helperphp_Navigationphp_Linksphp:RENDERphp_ALLphp php^
php php php php php php*php php php php php php php php php Zendphp_Viewphp_Helperphp_Navigationphp_Linksphp:RENDERphp_GLOSSARYphp;
php php php php php php*php php$helperphp-php>setRenderFlagphp(php$flagphp)php;
php php php php php php*
php php php php php php*php php/php/php renderphp onlyphp chaptersphp andphp sections
php php php php php php*php php$flagphp php=php Zendphp_Viewphp_Helperphp_Navigationphp_Linksphp:RENDERphp_CHAPTERphp php|
php php php php php php*php php php php php php php php php Zendphp_Viewphp_Helperphp_Navigationphp_Linksphp:RENDERphp_SECTIONphp;
php php php php php php*php php$helperphp-php>setRenderFlagphp(php$flagphp)php;
php php php php php php*
php php php php php php*php php/php/php renderphp onlyphp relationsphp thatphp arephp notphp nativephp Wphp3Cphp relations
php php php php php php*php php$helperphp-php>setRenderFlagphp(Zendphp_Viewphp_Helperphp_Navigationphp_Linksphp:RENDERphp_CUSTOMphp)php;
php php php php php php*
php php php php php php*php php/php/php renderphp allphp relationsphp php(defaultphp)
php php php php php php*php php$helperphp-php>setRenderFlagphp(Zendphp_Viewphp_Helperphp_Navigationphp_Linksphp:RENDERphp_ALLphp)php;
php php php php php php*php <php/codephp>
php php php php php php*
php php php php php php*php Notephp thatphp customphp relationsphp canphp alsophp bephp renderedphp directlyphp usingphp the
php php php php php php*php php{php@linkphp renderLinkphp(php)php}php methodphp.
php php php php php php*
php php php php php php*php php@paramphp php intphp php$renderFlagphp php php php php php php php php php php php php php php php php php php php renderphp flag
php php php php php php*php php@returnphp Zendphp_Viewphp_Helperphp_Navigationphp_Linksphp php fluentphp interfacephp,php returnsphp self
php php php php php php*php/
php php php php publicphp functionphp setRenderFlagphp(php$renderFlagphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_renderFlagphp php=php php(intphp)php php$renderFlagphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp helperphp'sphp renderphp flag
php php php php php php*
php php php php php php*php php@returnphp intphp php renderphp flag
php php php php php php*php/
php php php php publicphp functionphp getRenderFlagphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_renderFlagphp;
php php php php php}

php php php php php/php/php Finderphp methodsphp:

php php php php php/php*php*
php php php php php php*php Findsphp allphp relationsphp php(forwardphp andphp reversephp)php forphp thephp givenphp php$page
php php php php php php*
php php php php php php*php Thephp formphp ofphp thephp returnedphp arrayphp:
php php php php php php*php php<codephp>
php php php php php php*php php/php/php php$pagephp denotesphp anphp instancephp ofphp Zendphp_Navigationphp_Page
php php php php php php*php php$returnedphp php=php arrayphp(
php php php php php php*php php php php php php'relphp'php php=php>php arrayphp(
php php php php php php*php php php php php php php php php php'alternatephp'php php=php>php arrayphp(php$pagephp,php php$pagephp,php php$pagephp)php,
php php php php php php*php php php php php php php php php php'startphp'php php php php php php=php>php arrayphp(php$pagephp)php,
php php php php php php*php php php php php php php php php php'nextphp'php php php php php php php=php>php arrayphp(php$pagephp)php,
php php php php php php*php php php php php php php php php php'prevphp'php php php php php php php=php>php arrayphp(php$pagephp)php,
php php php php php php*php php php php php php php php php php'canonicalphp'php php=php>php arrayphp(php$pagephp)
php php php php php php*php php php php php php)php,
php php php php php php*php php php php php php'revphp'php php=php>php arrayphp(
php php php php php php*php php php php php php php php php php'sectionphp'php php php php=php>php arrayphp(php$pagephp)
php php php php php php*php php php php php php)
php php php php php php*php php)php;
php php php php php php*php <php/codephp>
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php pagephp tophp findphp linksphp for
php php php php php php*php php@returnphp arrayphp php php php php php php php php php php php php php php php php php php php php php php relatedphp pages
php php php php php php*php/
php php php php publicphp functionphp findAllRelationsphp(Zendphp_Navigationphp_Pagephp php$pagephp,
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php$flagphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(php!isphp_intphp(php$flagphp)php)php php{
php php php php php php php php php php php php php$flagphp php=php selfphp:php:RENDERphp_ALLphp;
php php php php php php php php php}

php php php php php php php php php$resultphp php=php arrayphp(php'relphp'php php=php>php arrayphp(php)php,php php'revphp'php php=php>php arrayphp(php)php)php;
php php php php php php php php php$nativephp php=php arrayphp_valuesphp(selfphp:php:php$php_RELATIONSphp)php;

php php php php php php php php foreachphp php(arrayphp_keysphp(php$resultphp)php asphp php$relphp)php php{
php php php php php php php php php php php php php$methphp php=php php'getDefinedphp'php php.php ucfirstphp(php$relphp)php;
php php php php php php php php php php php php php$typesphp php=php arrayphp_mergephp(php$nativephp,php arrayphp_diffphp(php$pagephp-php>php$methphp(php)php,php php$nativephp)php)php;

php php php php php php php php php php php php foreachphp php(php$typesphp asphp php$typephp)php php{
php php php php php php php php php php php php php php php php ifphp php(php!php$relFlagphp php=php arrayphp_searchphp(php$typephp,php selfphp:php:php$php_RELATIONSphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php$relFlagphp php=php selfphp:php:RENDERphp_CUSTOMphp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php ifphp php(php!php(php$flagphp php&php php$relFlagphp)php)php php{
php php php php php php php php php php php php php php php php php php php php continuephp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php ifphp php(php$foundphp php=php php$thisphp-php>findRelationphp(php$pagephp,php php$relphp,php php$typephp)php)php php{
php php php php php php php php php php php php php php php php php php php php ifphp php(php!isphp_arrayphp(php$foundphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$foundphp php=php arrayphp(php$foundphp)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php php$resultphp[php$relphp]php[php$typephp]php php=php php$foundphp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$resultphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Findsphp relationsphp ofphp thephp givenphp php$relphp=php$typephp fromphp php$page
php php php php php php*
php php php php php php*php Thisphp methodphp willphp firstphp lookphp forphp relationsphp inphp thephp pagephp instancephp,php then
php php php php php php*php byphp searchingphp thephp rootphp containerphp ifphp nothingphp wasphp foundphp inphp thephp pagephp.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php php php php php php pagephp tophp findphp relationsphp for
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php php$relphp php php php php php php php php relationphp,php php"relphp"php orphp php"revphp"
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php php$typephp php php php php php php php linkphp typephp,php ephp.gphp.php php'startphp'php,php php'nextphp'
php php php php php php*php php@returnphp Zendphp_Navigaitonphp_Pagephp|arrayphp|nullphp php pagephp(sphp)php,php orphp nullphp ifphp notphp found
php php php php php php*php php@throwsphp Zendphp_Viewphp_Exceptionphp php php php php php php php php php php php php php ifphp php$relphp isphp notphp php"relphp"php orphp php"revphp"
php php php php php php*php/
php php php php publicphp functionphp findRelationphp(Zendphp_Navigationphp_Pagephp php$pagephp,php php$relphp,php php$typephp)
php php php php php{
php php php php php php php php ifphp php(php!inphp_arrayphp(php$relphp,php arrayphp(php'relphp'php,php php'revphp'php)php)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Viewphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php$ephp php=php newphp Zendphp_Viewphp_Exceptionphp(sprintfphp(
php php php php php php php php php php php php php php php php php'Invalidphp argumentphp:php php$relphp mustphp bephp php"relphp"php orphp php"revphp"php;php php"php%sphp"php givenphp'php,
php php php php php php php php php php php php php php php php php$relphp)php)php;
php php php php php php php php php php php php php$ephp-php>setViewphp(php$thisphp-php>viewphp)php;
php php php php php php php php php php php php throwphp php$ephp;
php php php php php php php php php}

php php php php php php php php ifphp php(php!php$resultphp php=php php$thisphp-php>php_findFromPropertyphp(php$pagephp,php php$relphp,php php$typephp)php)php php{
php php php php php php php php php php php php php$resultphp php=php php$thisphp-php>php_findFromSearchphp(php$pagephp,php php$relphp,php php$typephp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$resultphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Findsphp relationsphp ofphp givenphp php$typephp forphp php$pagephp byphp checkingphp ifphp the
php php php php php php*php relationphp isphp specifiedphp asphp aphp propertyphp ofphp php$page
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php php php php php php pagephp tophp findphp relationsphp for
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php php$relphp php php php php php php php php relationphp,php php'relphp'php orphp php'revphp'
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php php$typephp php php php php php php php linkphp typephp,php ephp.gphp.php php'startphp'php,php php'nextphp'
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|arrayphp|nullphp php pagephp(sphp)php,php orphp nullphp ifphp notphp found
php php php php php php*php/
php php php php protectedphp functionphp php_findFromPropertyphp(Zendphp_Navigationphp_Pagephp php$pagephp,php php$relphp,php php$typephp)
php php php php php{
php php php php php php php php php$methodphp php=php php'getphp'php php.php ucfirstphp(php$relphp)php;
php php php php php php php php ifphp php(php$resultphp php=php php$pagephp-php>php$methodphp(php$typephp)php)php php{
php php php php php php php php php php php php ifphp php(php$resultphp php=php php$thisphp-php>php_convertToPagesphp(php$resultphp)php)php php{
php php php php php php php php php php php php php php php php ifphp php(php!isphp_arrayphp(php$resultphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php$resultphp php=php arrayphp(php$resultphp)php;
php php php php php php php php php php php php php php php php php}

php php php php php php php php php php php php php php php php foreachphp php(php$resultphp asphp php$keyphp php=php>php php$pagephp)php php{
php php php php php php php php php php php php php php php php php php php php ifphp php(php!php$thisphp-php>acceptphp(php$pagephp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php unsetphp(php$resultphp[php$keyphp]php)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php}

php php php php php php php php php php php php php php php php returnphp countphp(php$resultphp)php php=php=php php1php php?php php$resultphp[php0php]php php:php php$resultphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp nullphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Findsphp relationsphp ofphp givenphp php$relphp=php$typephp forphp php$pagephp byphp usingphp thephp helperphp to
php php php php php php*php searchphp forphp thephp relationphp inphp thephp rootphp container
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php pagephp tophp findphp relationsphp for
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php php$relphp php php php relationphp,php php'relphp'php orphp php'revphp'
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php php$typephp php php linkphp typephp,php ephp.gphp.php php'startphp'php,php php'nextphp'php,php etc
php php php php php php*php php@returnphp arrayphp|nullphp php php php php php php php php php php php php php php php php php arrayphp ofphp pagesphp,php orphp nullphp ifphp notphp found
php php php php php php*php/
php php php php protectedphp functionphp php_findFromSearchphp(Zendphp_Navigationphp_Pagephp php$pagephp,php php$relphp,php php$typephp)
php php php php php{
php php php php php php php php php$foundphp php=php nullphp;

php php php php php php php php php$methodphp php=php php'searchphp'php php.php ucfirstphp(php$relphp)php php.php ucfirstphp(php$typephp)php;
php php php php php php php php ifphp php(methodphp_existsphp(php$thisphp,php php$methodphp)php)php php{
php php php php php php php php php php php php php$foundphp php=php php$thisphp-php>php$methodphp(php$pagephp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$foundphp;
php php php php php}

php php php php php/php/php Searchphp methodsphp:

php php php php php/php*php*
php php php php php php*php Searchesphp thephp rootphp containerphp forphp thephp forwardphp php'startphp'php relationphp ofphp thephp given
php php php php php php*php php$page
php php php php php php*
php php php php php php*php Fromphp php{php@linkphp httpphp:php/php/wwwphp.wphp3php.orgphp/TRphp/htmlphp4php/typesphp.htmlphp#typephp-linksphp}php:
php php php php php php*php Refersphp tophp thephp firstphp documentphp inphp aphp collectionphp ofphp documentsphp.php Thisphp linkphp type
php php php php php php*php tellsphp searchphp enginesphp whichphp documentphp isphp consideredphp byphp thephp authorphp tophp bephp the
php php php php php php*php startingphp pointphp ofphp thephp collectionphp.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php pagephp tophp findphp relationphp for
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|nullphp php php pagephp orphp null
php php php php php php*php/
php php php php publicphp functionphp searchRelStartphp(Zendphp_Navigationphp_Pagephp php$pagephp)
php php php php php{
php php php php php php php php php$foundphp php=php php$thisphp-php>php_findRootphp(php$pagephp)php;
php php php php php php php php ifphp php(php!php$foundphp instanceofphp Zendphp_Navigationphp_Pagephp)php php{
php php php php php php php php php php php php php$foundphp-php>rewindphp(php)php;
php php php php php php php php php php php php php$foundphp php=php php$foundphp-php>currentphp(php)php;
php php php php php php php php php}

php php php php php php php php ifphp php(php$foundphp php=php=php=php php$pagephp php|php|php php!php$thisphp-php>acceptphp(php$foundphp)php)php php{
php php php php php php php php php php php php php$foundphp php=php nullphp;
php php php php php php php php php}

php php php php php php php php returnphp php$foundphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Searchesphp thephp rootphp containerphp forphp thephp forwardphp php'nextphp'php relationphp ofphp thephp given
php php php php php php*php php$page
php php php php php php*
php php php php php php*php Fromphp php{php@linkphp httpphp:php/php/wwwphp.wphp3php.orgphp/TRphp/htmlphp4php/typesphp.htmlphp#typephp-linksphp}php:
php php php php php php*php Refersphp tophp thephp nextphp documentphp inphp aphp linearphp sequencephp ofphp documentsphp.php User
php php php php php php*php agentsphp mayphp choosephp tophp preloadphp thephp php"nextphp"php documentphp,php tophp reducephp thephp perceived
php php php php php php*php loadphp timephp.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php pagephp tophp findphp relationphp for
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|nullphp php php pagephp(sphp)php orphp null
php php php php php php*php/
php php php php publicphp functionphp searchRelNextphp(Zendphp_Navigationphp_Pagephp php$pagephp)
php php php php php{
php php php php php php php php php$foundphp php=php nullphp;
php php php php php php php php php$breakphp php=php falsephp;
php php php php php php php php php$iteratorphp php=php newphp RecursiveIteratorIteratorphp(php$thisphp-php>php_findRootphp(php$pagephp)php,
php php php php php php php php php php php php php php php php RecursiveIteratorIteratorphp:php:SELFphp_FIRSTphp)php;
php php php php php php php php foreachphp php(php$iteratorphp asphp php$intermediatephp)php php{
php php php php php php php php php php php php ifphp php(php$intermediatephp php=php=php=php php$pagephp)php php{
php php php php php php php php php php php php php php php php php/php/php currentphp pagephp;php breakphp atphp nextphp acceptedphp page
php php php php php php php php php php php php php php php php php$breakphp php=php truephp;
php php php php php php php php php php php php php php php php continuephp;
php php php php php php php php php php php php php}

php php php php php php php php php php php php ifphp php(php$breakphp php&php&php php$thisphp-php>acceptphp(php$intermediatephp)php)php php{
php php php php php php php php php php php php php php php php php$foundphp php=php php$intermediatephp;
php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$foundphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Searchesphp thephp rootphp containerphp forphp thephp forwardphp php'prevphp'php relationphp ofphp thephp given
php php php php php php*php php$page
php php php php php php*
php php php php php php*php Fromphp php{php@linkphp httpphp:php/php/wwwphp.wphp3php.orgphp/TRphp/htmlphp4php/typesphp.htmlphp#typephp-linksphp}php:
php php php php php php*php Refersphp tophp thephp previousphp documentphp inphp anphp orderedphp seriesphp ofphp documentsphp.php Some
php php php php php php*php userphp agentsphp alsophp supportphp thephp synonymphp php"Previousphp"php.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php pagephp tophp findphp relationphp for
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|nullphp php php pagephp orphp null
php php php php php php*php/
php php php php publicphp functionphp searchRelPrevphp(Zendphp_Navigationphp_Pagephp php$pagephp)
php php php php php{
php php php php php php php php php$foundphp php=php nullphp;
php php php php php php php php php$prevphp php=php nullphp;
php php php php php php php php php$iteratorphp php=php newphp RecursiveIteratorIteratorphp(
php php php php php php php php php php php php php php php php php$thisphp-php>php_findRootphp(php$pagephp)php,
php php php php php php php php php php php php php php php php RecursiveIteratorIteratorphp:php:SELFphp_FIRSTphp)php;
php php php php php php php php foreachphp php(php$iteratorphp asphp php$intermediatephp)php php{
php php php php php php php php php php php php ifphp php(php!php$thisphp-php>acceptphp(php$intermediatephp)php)php php{
php php php php php php php php php php php php php php php php continuephp;
php php php php php php php php php php php php php}
php php php php php php php php php php php php ifphp php(php$intermediatephp php=php=php=php php$pagephp)php php{
php php php php php php php php php php php php php php php php php$foundphp php=php php$prevphp;
php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php}

php php php php php php php php php php php php php$prevphp php=php php$intermediatephp;
php php php php php php php php php}

php php php php php php php php returnphp php$foundphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Searchesphp thephp rootphp containerphp forphp forwardphp php'chapterphp'php relationsphp ofphp thephp given
php php php php php php*php php$page
php php php php php php*
php php php php php php*php Fromphp php{php@linkphp httpphp:php/php/wwwphp.wphp3php.orgphp/TRphp/htmlphp4php/typesphp.htmlphp#typephp-linksphp}php:
php php php php php php*php Refersphp tophp aphp documentphp servingphp asphp aphp chapterphp inphp aphp collectionphp ofphp documentsphp.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php php php php php php pagephp tophp findphp relationphp for
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|arrayphp|nullphp php pagephp(sphp)php orphp null
php php php php php php*php/
php php php php publicphp functionphp searchRelChapterphp(Zendphp_Navigationphp_Pagephp php$pagephp)
php php php php php{
php php php php php php php php php$foundphp php=php arrayphp(php)php;

php php php php php php php php php/php/php findphp firstphp levelphp ofphp pages
php php php php php php php php php$rootphp php=php php$thisphp-php>php_findRootphp(php$pagephp)php;

php php php php php php php php php/php/php findphp startphp pagephp(sphp)
php php php php php php php php php$startphp php=php php$thisphp-php>findRelationphp(php$pagephp,php php'relphp'php,php php'startphp'php)php;
php php php php php php php php ifphp php(php!isphp_arrayphp(php$startphp)php)php php{
php php php php php php php php php php php php php$startphp php=php arrayphp(php$startphp)php;
php php php php php php php php php}

php php php php php php php php foreachphp php(php$rootphp asphp php$chapterphp)php php{
php php php php php php php php php php php php php/php/php excludephp selfphp andphp startphp pagephp fromphp chapters
php php php php php php php php php php php php ifphp php(php$chapterphp php!php=php=php php$pagephp php&php&
php php php php php php php php php php php php php php php php php!inphp_arrayphp(php$chapterphp,php php$startphp)php php&php&
php php php php php php php php php php php php php php php php php$thisphp-php>acceptphp(php$chapterphp)php)php php{
php php php php php php php php php php php php php php php php php$foundphp[php]php php=php php$chapterphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php switchphp php(countphp(php$foundphp)php)php php{
php php php php php php php php php php php php casephp php0php:
php php php php php php php php php php php php php php php php returnphp nullphp;
php php php php php php php php php php php php casephp php1php:
php php php php php php php php php php php php php php php php returnphp php$foundphp[php0php]php;
php php php php php php php php php php php php defaultphp:
php php php php php php php php php php php php php php php php returnphp php$foundphp;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Searchesphp thephp rootphp containerphp forphp forwardphp php'sectionphp'php relationsphp ofphp thephp given
php php php php php php*php php$page
php php php php php php*
php php php php php php*php Fromphp php{php@linkphp httpphp:php/php/wwwphp.wphp3php.orgphp/TRphp/htmlphp4php/typesphp.htmlphp#typephp-linksphp}php:
php php php php php php*php Refersphp tophp aphp documentphp servingphp asphp aphp sectionphp inphp aphp collectionphp ofphp documentsphp.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php php php php php php pagephp tophp findphp relationphp for
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|arrayphp|nullphp php pagephp(sphp)php orphp null
php php php php php php*php/
php php php php publicphp functionphp searchRelSectionphp(Zendphp_Navigationphp_Pagephp php$pagephp)
php php php php php{
php php php php php php php php php$foundphp php=php arrayphp(php)php;

php php php php php php php php php/php/php checkphp ifphp givenphp pagephp hasphp pagesphp andphp isphp aphp chapterphp page
php php php php php php php php ifphp php(php$pagephp-php>hasPagesphp(php)php php&php&php php$thisphp-php>php_findRootphp(php$pagephp)php-php>hasPagephp(php$pagephp)php)php php{
php php php php php php php php php php php php foreachphp php(php$pagephp asphp php$sectionphp)php php{
php php php php php php php php php php php php php php php php ifphp php(php$thisphp-php>acceptphp(php$sectionphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php$foundphp[php]php php=php php$sectionphp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php switchphp php(countphp(php$foundphp)php)php php{
php php php php php php php php php php php php casephp php0php:
php php php php php php php php php php php php php php php php returnphp nullphp;
php php php php php php php php php php php php casephp php1php:
php php php php php php php php php php php php php php php php returnphp php$foundphp[php0php]php;
php php php php php php php php php php php php defaultphp:
php php php php php php php php php php php php php php php php returnphp php$foundphp;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Searchesphp thephp rootphp containerphp forphp forwardphp php'subsectionphp'php relationsphp ofphp the
php php php php php php*php givenphp php$page
php php php php php php*
php php php php php php*php Fromphp php{php@linkphp httpphp:php/php/wwwphp.wphp3php.orgphp/TRphp/htmlphp4php/typesphp.htmlphp#typephp-linksphp}php:
php php php php php php*php Refersphp tophp aphp documentphp servingphp asphp aphp subsectionphp inphp aphp collectionphp of
php php php php php php*php documentsphp.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php php php php php php pagephp tophp findphp relationphp for
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|arrayphp|nullphp php pagephp(sphp)php orphp null
php php php php php php*php/
php php php php publicphp functionphp searchRelSubsectionphp(Zendphp_Navigationphp_Pagephp php$pagephp)
php php php php php{
php php php php php php php php php$foundphp php=php arrayphp(php)php;

php php php php php php php php ifphp php(php$pagephp-php>hasPagesphp(php)php)php php{
php php php php php php php php php php php php php/php/php givenphp pagephp hasphp childphp pagesphp,php loopphp chapters
php php php php php php php php php php php php foreachphp php(php$thisphp-php>php_findRootphp(php$pagephp)php asphp php$chapterphp)php php{
php php php php php php php php php php php php php php php php php/php/php isphp pagephp aphp sectionphp?
php php php php php php php php php php php php php php php php ifphp php(php$chapterphp-php>hasPagephp(php$pagephp)php)php php{
php php php php php php php php php php php php php php php php php php php php foreachphp php(php$pagephp asphp php$subsectionphp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php ifphp php(php$thisphp-php>acceptphp(php$subsectionphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php$foundphp[php]php php=php php$subsectionphp;
php php php php php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php switchphp php(countphp(php$foundphp)php)php php{
php php php php php php php php php php php php casephp php0php:
php php php php php php php php php php php php php php php php returnphp nullphp;
php php php php php php php php php php php php casephp php1php:
php php php php php php php php php php php php php php php php returnphp php$foundphp[php0php]php;
php php php php php php php php php php php php defaultphp:
php php php php php php php php php php php php php php php php returnphp php$foundphp;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Searchesphp thephp rootphp containerphp forphp thephp reversephp php'sectionphp'php relationphp ofphp the
php php php php php php*php givenphp php$page
php php php php php php*
php php php php php php*php Fromphp php{php@linkphp httpphp:php/php/wwwphp.wphp3php.orgphp/TRphp/htmlphp4php/typesphp.htmlphp#typephp-linksphp}php:
php php php php php php*php Refersphp tophp aphp documentphp servingphp asphp aphp sectionphp inphp aphp collectionphp ofphp documentsphp.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php pagephp tophp findphp relationphp for
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|nullphp php php pagephp(sphp)php orphp null
php php php php php php*php/
php php php php publicphp functionphp searchRevSectionphp(Zendphp_Navigationphp_Pagephp php$pagephp)
php php php php php{
php php php php php php php php php$foundphp php=php nullphp;

php php php php php php php php ifphp php(php$parentphp php=php php$pagephp-php>getParentphp(php)php)php php{
php php php php php php php php php php php php ifphp php(php$parentphp instanceofphp Zendphp_Navigationphp_Pagephp php&php&
php php php php php php php php php php php php php php php php php$thisphp-php>php_findRootphp(php$pagephp)php-php>hasPagephp(php$parentphp)php)php php{
php php php php php php php php php php php php php php php php php$foundphp php=php php$parentphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$foundphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Searchesphp thephp rootphp containerphp forphp thephp reversephp php'sectionphp'php relationphp ofphp the
php php php php php php*php givenphp php$page
php php php php php php*
php php php php php php*php Fromphp php{php@linkphp httpphp:php/php/wwwphp.wphp3php.orgphp/TRphp/htmlphp4php/typesphp.htmlphp#typephp-linksphp}php:
php php php php php php*php Refersphp tophp aphp documentphp servingphp asphp aphp subsectionphp inphp aphp collectionphp of
php php php php php php*php documentsphp.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php pagephp tophp findphp relationphp for
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|nullphp php php pagephp(sphp)php orphp null
php php php php php php*php/
php php php php publicphp functionphp searchRevSubsectionphp(Zendphp_Navigationphp_Pagephp php$pagephp)
php php php php php{
php php php php php php php php php$foundphp php=php nullphp;

php php php php php php php php ifphp php(php$parentphp php=php php$pagephp-php>getParentphp(php)php)php php{
php php php php php php php php php php php php ifphp php(php$parentphp instanceofphp Zendphp_Navigationphp_Pagephp)php php{
php php php php php php php php php php php php php php php php php$rootphp php=php php$thisphp-php>php_findRootphp(php$pagephp)php;
php php php php php php php php php php php php php php php php foreachphp php(php$rootphp asphp php$chapterphp)php php{
php php php php php php php php php php php php php php php php php php php php ifphp php(php$chapterphp-php>hasPagephp(php$parentphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$foundphp php=php php$parentphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$foundphp;
php php php php php}

php php php php php/php/php Utilphp methodsphp:

php php php php php/php*php*
php php php php php php*php Returnsphp thephp rootphp containerphp ofphp thephp givenphp page
php php php php php php*
php php php php php php*php Whenphp renderingphp aphp containerphp,php thephp renderphp methodphp stillphp storephp thephp given
php php php php php php*php containerphp asphp thephp rootphp containerphp,php andphp unsetphp itphp whenphp donephp renderingphp.php This
php php php php php php*php makesphp surephp finderphp methodsphp willphp notphp traversephp abovephp thephp containerphp given
php php php php php php*php tophp thephp renderphp methodphp.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigaitonphp_Pagephp php$pagephp php pagephp tophp findphp rootphp for
php php php php php php*php php@returnphp Zendphp_Navigationphp_Containerphp php php thephp rootphp containerphp ofphp thephp givenphp page
php php php php php php*php/
php php php php protectedphp functionphp php_findRootphp(Zendphp_Navigationphp_Pagephp php$pagephp)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_rootphp)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_rootphp;
php php php php php php php php php}

php php php php php php php php php$rootphp php=php php$pagephp;

php php php php php php php php whilephp php(php$parentphp php=php php$pagephp-php>getParentphp(php)php)php php{
php php php php php php php php php php php php php$rootphp php=php php$parentphp;
php php php php php php php php php php php php ifphp php(php$parentphp instanceofphp Zendphp_Navigationphp_Pagephp)php php{
php php php php php php php php php php php php php php php php php$pagephp php=php php$parentphp;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$rootphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Convertsphp aphp php$mixedphp valuephp tophp anphp arrayphp ofphp pages
php php php php php php*
php php php php php php*php php@paramphp php mixedphp php$mixedphp php php php php php php php php php php php php php php php php php php php php mixedphp valuephp tophp getphp pagephp(sphp)php from
php php php php php php*php php@paramphp php boolphp php php$recursivephp php php php php php php php php php php php php php php php php whetherphp php$valuephp shouldphp bephp looped
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php ifphp itphp isphp anphp arrayphp orphp aphp config
php php php php php php*php php@returnphp Zendphp_Navigationphp_Pagephp|arrayphp|nullphp php emptyphp ifphp unablephp tophp convert
php php php php php php*php/
php php php php protectedphp functionphp php_convertToPagesphp(php$mixedphp,php php$recursivephp php=php truephp)
php php php php php{
php php php php php php php php ifphp php(isphp_objectphp(php$mixedphp)php)php php{
php php php php php php php php php php php php ifphp php(php$mixedphp instanceofphp Zendphp_Navigationphp_Pagephp)php php{
php php php php php php php php php php php php php php php php php/php/php valuephp isphp aphp pagephp instancephp;php returnphp directly
php php php php php php php php php php php php php php php php returnphp php$mixedphp;
php php php php php php php php php php php php php}php elseifphp php(php$mixedphp instanceofphp Zendphp_Navigationphp_Containerphp)php php{
php php php php php php php php php php php php php php php php php/php/php valuephp isphp aphp containerphp;php returnphp pagesphp inphp it
php php php php php php php php php php php php php php php php php$pagesphp php=php arrayphp(php)php;
php php php php php php php php php php php php php php php php foreachphp php(php$mixedphp asphp php$pagephp)php php{
php php php php php php php php php php php php php php php php php php php php php$pagesphp[php]php php=php php$pagephp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php returnphp php$pagesphp;
php php php php php php php php php php php php php}php elseifphp php(php$mixedphp instanceofphp Zendphp_Configphp)php php{
php php php php php php php php php php php php php php php php php/php/php convertphp configphp objectphp tophp arrayphp andphp extract
php php php php php php php php php php php php php php php php returnphp php$thisphp-php>php_convertToPagesphp(php$mixedphp-php>toArrayphp(php)php,php php$recursivephp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}php elseifphp php(isphp_stringphp(php$mixedphp)php)php php{
php php php php php php php php php php php php php/php/php valuephp isphp aphp stringphp;php makephp anphp URIphp page
php php php php php php php php php php php php returnphp Zendphp_Navigationphp_Pagephp:php:factoryphp(arrayphp(
php php php php php php php php php php php php php php php php php'typephp'php php=php>php php'uriphp'php,
php php php php php php php php php php php php php php php php php'uriphp'php php php=php>php php$mixed
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php elseifphp php(isphp_arrayphp(php$mixedphp)php php&php&php php!emptyphp(php$mixedphp)php)php php{
php php php php php php php php php php php php ifphp php(php$recursivephp php&php&php isphp_numericphp(keyphp(php$mixedphp)php)php)php php{
php php php php php php php php php php php php php php php php php/php/php firstphp keyphp isphp numericphp;php assumephp severalphp pages
php php php php php php php php php php php php php php php php php$pagesphp php=php arrayphp(php)php;
php php php php php php php php php php php php php php php php foreachphp php(php$mixedphp asphp php$valuephp)php php{
php php php php php php php php php php php php php php php php php php php php ifphp php(php$valuephp php=php php$thisphp-php>php_convertToPagesphp(php$valuephp,php falsephp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$pagesphp[php]php php=php php$valuephp;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php returnphp php$pagesphp;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php/php/php passphp arrayphp tophp factoryphp directly
php php php php php php php php php php php php php php php php tryphp php{
php php php php php php php php php php php php php php php php php php php php php$pagephp php=php Zendphp_Navigationphp_Pagephp:php:factoryphp(php$mixedphp)php;
php php php php php php php php php php php php php php php php php php php php returnphp php$pagephp;
php php php php php php php php php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php php/php/php nothingphp found
php php php php php php php php returnphp nullphp;
php php php php php}

php php php php php/php/php Renderphp methodsphp:

php php php php php/php*php*
php php php php php php*php Rendersphp thephp givenphp php$pagephp asphp aphp linkphp elementphp,php withphp php$attribphp php=php php$relation
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Pagephp php$pagephp php php php php php thephp pagephp tophp renderphp thephp linkphp for
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php php php$attribphp php php php thephp attributephp tophp usephp forphp php$typephp,
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php eitherphp php'relphp'php orphp php'revphp'
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php php php$relationphp php relationphp typephp,php musephp bephp onephp ofphp;
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php alternatephp,php appendixphp,php bookmarkphp,
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php chapterphp,php contentsphp,php copyrightphp,
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php glossaryphp,php helpphp,php homephp,php indexphp,php nextphp,
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php prevphp,php sectionphp,php startphp,php stylesheetphp,
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php subsection
php php php php php php*php php@returnphp stringphp php php php php php php php php php php php php php php php php php php php php php php php php php renderedphp linkphp element
php php php php php php*php php@throwsphp Zendphp_Viewphp_Exceptionphp php php php php php php php php php php php php ifphp php$attribphp isphp invalid
php php php php php php*php/
php php php php publicphp functionphp renderLinkphp(Zendphp_Navigationphp_Pagephp php$pagephp,php php$attribphp,php php$relationphp)
php php php php php{
php php php php php php php php ifphp php(php!inphp_arrayphp(php$attribphp,php arrayphp(php'relphp'php,php php'revphp'php)php)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Viewphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php$ephp php=php newphp Zendphp_Viewphp_Exceptionphp(sprintfphp(
php php php php php php php php php php php php php php php php php php php php php'Invalidphp relationphp attributephp php"php%sphp"php,php mustphp bephp php"relphp"php orphp php"revphp"php'php,
php php php php php php php php php php php php php php php php php php php php php$attribphp)php)php;
php php php php php php php php php php php php php$ephp-php>setViewphp(php$thisphp-php>viewphp)php;
php php php php php php php php php php php php throwphp php$ephp;
php php php php php php php php php}

php php php php php php php php ifphp php(php!php$hrefphp php=php php$pagephp-php>getHrefphp(php)php)php php{
php php php php php php php php php php php php returnphp php'php'php;
php php php php php php php php php}

php php php php php php php php php/php/php TODOphp:php addphp morephp attribs
php php php php php php php php php/php/php httpphp:php/php/wwwphp.wphp3php.orgphp/TRphp/htmlphp4php0php1php/structphp/linksphp.htmlphp#hphp-php1php2php.php2
php php php php php php php php php$attribsphp php=php arrayphp(
php php php php php php php php php php php php php$attribphp php php=php>php php$relationphp,
php php php php php php php php php php php php php'hrefphp'php php php php=php>php php$hrefphp,
php php php php php php php php php php php php php'titlephp'php php php=php>php php$pagephp-php>getLabelphp(php)
php php php php php php php php php)php;

php php php php php php php php returnphp php'php<linkphp'php php.
php php php php php php php php php php php php php php php php$thisphp-php>php_htmlAttribsphp(php$attribsphp)php php.
php php php php php php php php php php php php php php php php$thisphp-php>getClosingBracketphp(php)php;
php php php php php}

php php php php php/php/php Zendphp_Viewphp_Helperphp_Navigationphp_Helperphp:

php php php php php/php*php*
php php php php php php*php Rendersphp helper
php php php php php php*
php php php php php php*php Implementsphp php{php@linkphp Zendphp_Viewphp_Helperphp_Navigationphp_Helperphp:php:renderphp(php)php}php.
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Navigationphp_Containerphp php$containerphp php php[optionalphp]php containerphp to
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php renderphp.php Defaultphp isphp to
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php renderphp thephp container
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php registeredphp inphp thephp helperphp.
php php php php php php*php php@returnphp stringphp php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php helperphp output
php php php php php php*php/
php php php php publicphp functionphp renderphp(Zendphp_Navigationphp_Containerphp php$containerphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(nullphp php=php=php=php php$containerphp)php php{
php php php php php php php php php php php php php$containerphp php=php php$thisphp-php>getContainerphp(php)php;
php php php php php php php php php}

php php php php php php php php ifphp php(php$activephp php=php php$thisphp-php>findActivephp(php$containerphp)php)php php{
php php php php php php php php php php php php php$activephp php=php php$activephp[php'pagephp'php]php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php/php/php nophp activephp page
php php php php php php php php php php php php returnphp php'php'php;
php php php php php php php php php}

php php php php php php php php php$outputphp php=php php'php'php;
php php php php php php php php php$indentphp php=php php$thisphp-php>getIndentphp(php)php;
php php php php php php php php php$thisphp-php>php_rootphp php=php php$containerphp;

php php php php php php php php php$resultphp php=php php$thisphp-php>findAllRelationsphp(php$activephp,php php$thisphp-php>getRenderFlagphp(php)php)php;
php php php php php php php php foreachphp php(php$resultphp asphp php$attribphp php=php>php php$typesphp)php php{
php php php php php php php php php php php php foreachphp php(php$typesphp asphp php$relationphp php=php>php php$pagesphp)php php{
php php php php php php php php php php php php php php php php foreachphp php(php$pagesphp asphp php$pagephp)php php{
php php php php php php php php php php php php php php php php php php php php ifphp php(php$rphp php=php php$thisphp-php>renderLinkphp(php$pagephp,php php$attribphp,php php$relationphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$outputphp php.php=php php$indentphp php.php php$rphp php.php selfphp:php:EOLphp;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_rootphp php=php nullphp;

php php php php php php php php php/php/php returnphp outputphp php(trimphp lastphp newlinephp byphp specphp)
php php php php php php php php returnphp strlenphp(php$outputphp)php php?php rtrimphp(php$outputphp,php selfphp:php:EOLphp)php php:php php'php'php;
php php php php php}
php}
