<php?php

php/php*php*
php php*php Zendphp Framework
php php*
php php*php LICENSE
php php*
php php*php Thisphp sourcephp filephp isphp subjectphp tophp thephp newphp BSDphp licensephp thatphp isphp bundled
php php*php withphp thisphp packagephp inphp thephp filephp LICENSEphp.txtphp.
php php*php Itphp isphp alsophp availablephp throughphp thephp worldphp-widephp-webphp atphp thisphp URLphp:
php php*php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsd
php php*php Ifphp youphp didphp notphp receivephp aphp copyphp ofphp thephp licensephp andphp arephp unablephp to
php php*php obtainphp itphp throughphp thephp worldphp-widephp-webphp,php pleasephp sendphp anphp email
php php*php tophp licensephp@zendphp.comphp sophp wephp canphp sendphp youphp aphp copyphp immediatelyphp.
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Gdata
php php*php php@subpackagephp Gdata
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@versionphp php php php php$Idphp:php Gdataphp.phpphp php2php0php0php9php6php php2php0php1php0php-php0php1php-php0php6php php0php2php:php0php5php:php0php9Zphp bkarwinphp php$
php php*php/

php/php*php*
php php*php Zendphp_Gdataphp_App
php php*php/
requirephp_oncephp php'Zendphp/Gdataphp/Appphp.phpphp'php;

php/php*php*
php php*php Providesphp functionalityphp tophp interactphp withphp Googlephp dataphp APIs
php php*php Subclassesphp existphp tophp implementphp servicephp-specificphp features
php php*
php php*php Asphp thephp Googlephp dataphp APIphp protocolphp isphp basedphp uponphp thephp Atomphp Publishingphp Protocol
php php*php php(APPphp)php,php Gdataphp functionalityphp extendsphp thephp appropriatephp Zendphp_Gdataphp_Appphp classes
php php*
php php*php php@linkphp httpphp:php/php/codephp.googlephp.comphp/apisphp/gdataphp/overviewphp.html
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Gdata
php php*php php@subpackagephp Gdata
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php/
classphp Zendphp_Gdataphp extendsphp Zendphp_Gdataphp_App
php{

php php php php php/php*php*
php php php php php php*php Servicephp namephp forphp usephp withphp Googlephp'sphp authenticationphp mechanisms
php php php php php php*
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php constphp AUTHphp_SERVICEphp_NAMEphp php=php php'xapiphp'php;

php php php php php/php*php*
php php php php php php*php Defaultphp URIphp tophp whichphp tophp POSTphp.
php php php php php php*
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_defaultPostUriphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Packagesphp tophp searchphp forphp classesphp whenphp usingphp magicphp php_php_callphp methodphp,php inphp orderphp.
php php php php php php*
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_registeredPackagesphp php=php arrayphp(
php php php php php php php php php php php php php'Zendphp_Gdataphp_Kindphp'php,
php php php php php php php php php php php php php'Zendphp_Gdataphp_Extensionphp'php,
php php php php php php php php php php php php php'Zendphp_Gdataphp'php,
php php php php php php php php php php php php php'Zendphp_Gdataphp_Appphp_Extensionphp'php,
php php php php php php php php php php php php php'Zendphp_Gdataphp_Appphp'php)php;

php php php php php/php*php*
php php php php php php*php Namespacesphp usedphp forphp Gdataphp data
php php php php php php*
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php publicphp staticphp php$namespacesphp php=php arrayphp(
php php php php php php php php arrayphp(php'gdphp'php,php php'httpphp:php/php/schemasphp.googlephp.comphp/gphp/php2php0php0php5php'php,php php1php,php php0php)php,
php php php php php php php php arrayphp(php'openSearchphp'php,php php'httpphp:php/php/aphp9php.comphp/php-php/specphp/opensearchrssphp/php1php.php0php/php'php,php php1php,php php0php)php,
php php php php php php php php arrayphp(php'openSearchphp'php,php php'httpphp:php/php/aphp9php.comphp/php-php/specphp/opensearchphp/php1php.php1php/php'php,php php2php,php php0php)php,
php php php php php php php php arrayphp(php'rssphp'php,php php'httpphp:php/php/blogsphp.lawphp.harvardphp.eduphp/techphp/rssphp'php,php php1php,php php0php)
php php php php php)php;

php php php php php/php*php*
php php php php php php*php Clientphp objectphp usedphp tophp communicate
php php php php php php*
php php php php php php*php php@varphp Zendphp_Gdataphp_HttpClient
php php php php php php*php/
php php php php protectedphp php$php_httpClientphp;

php php php php php/php*php*
php php php php php php*php Clientphp objectphp usedphp tophp communicatephp inphp staticphp context
php php php php php php*
php php php php php php*php php@varphp Zendphp_Gdataphp_HttpClient
php php php php php php*php/
php php php php protectedphp staticphp php$php_staticHttpClientphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Createphp Gdataphp object
php php php php php php*
php php php php php php*php php@paramphp Zendphp_Httpphp_Clientphp php$client
php php php php php php*php php@paramphp stringphp php$applicationIdphp Thephp identityphp ofphp thephp appphp inphp thephp formphp of
php php php php php php*php php php php php php php php php php Companyphp-AppNamephp-Version
php php php php php php*php/
php php php php publicphp functionphp php_php_constructphp(php$clientphp php=php nullphp,php php$applicationIdphp php=php php'MyCompanyphp-MyAppphp-php1php.php0php'php)
php php php php php{
php php php php php php php php parentphp:php:php_php_constructphp(php$clientphp,php php$applicationIdphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Importsphp aphp feedphp locatedphp atphp php$uriphp.
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$uri
php php php php php php*php php@paramphp php Zendphp_Httpphp_Clientphp php$clientphp Thephp clientphp usedphp forphp communication
php php php php php php*php php@paramphp php stringphp php$classNamephp Thephp classphp whichphp isphp usedphp asphp thephp returnphp type
php php php php php php*php php@throwsphp Zendphp_Gdataphp_Appphp_Exception
php php php php php php*php php@returnphp stringphp|Zendphp_Gdataphp_Appphp_Feedphp Returnsphp stringphp onlyphp ifphp thephp object
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php mappingphp hasphp beenphp disabledphp explicitly
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php byphp passingphp falsephp tophp the
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php useObjectMappingphp(php)php functionphp.
php php php php php php*php/
php php php php publicphp staticphp functionphp importphp(php$uriphp,php php$clientphp php=php nullphp,
php php php php php php php php php$classNamephp=php'Zendphp_Gdataphp_Feedphp'php)
php php php php php{
php php php php php php php php php$appphp php=php newphp Zendphp_Gdataphp(php$clientphp)php;
php php php php php php php php php$requestDataphp php=php php$appphp-php>decodeRequestphp(php'GETphp'php,php php$uriphp)php;
php php php php php php php php php$responsephp php=php php$appphp-php>performHttpRequestphp(php$requestDataphp[php'methodphp'php]php,php php$requestDataphp[php'urlphp'php]php)php;

php php php php php php php php php$feedContentphp php=php php$responsephp-php>getBodyphp(php)php;

php php php php php php php php php$feedphp php=php selfphp:php:importStringphp(php$feedContentphp,php php$classNamephp)php;
php php php php php php php php ifphp php(php$clientphp php!php=php nullphp)php php{
php php php php php php php php php php php php php$feedphp-php>setHttpClientphp(php$clientphp)php;
php php php php php php php php php}
php php php php php php php php returnphp php$feedphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp feedphp asphp stringphp orphp object
php php php php php php*
php php php php php php*php php@paramphp mixedphp php$locationphp Thephp locationphp asphp stringphp orphp Zendphp_Gdataphp_Query
php php php php php php*php php@paramphp stringphp php$classNamephp Thephp classphp typephp tophp usephp forphp returningphp thephp feed
php php php php php php*php php@throwsphp Zendphp_Gdataphp_Appphp_InvalidArgumentException
php php php php php php*php php@returnphp stringphp|Zendphp_Gdataphp_Appphp_Feedphp Returnsphp stringphp onlyphp ifphp thephp object
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php mappingphp hasphp beenphp disabledphp explicitly
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php byphp passingphp falsephp tophp the
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php useObjectMappingphp(php)php functionphp.
php php php php php php*php/
php php php php publicphp functionphp getFeedphp(php$locationphp,php php$classNamephp=php'Zendphp_Gdataphp_Feedphp'php)
php php php php php{
php php php php php php php php ifphp php(isphp_stringphp(php$locationphp)php)php php{
php php php php php php php php php php php php php$uriphp php=php php$locationphp;
php php php php php php php php php}php elseifphp php(php$locationphp instanceofphp Zendphp_Gdataphp_Queryphp)php php{
php php php php php php php php php php php php php$uriphp php=php php$locationphp-php>getQueryUrlphp(php)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Gdataphp/Appphp/InvalidArgumentExceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Gdataphp_Appphp_InvalidArgumentExceptionphp(
php php php php php php php php php php php php php php php php php php php php php'Youphp mustphp specifyphp thephp locationphp asphp eitherphp aphp stringphp URIphp php'php php.
php php php php php php php php php php php php php php php php php php php php php'orphp aphp childphp ofphp Zendphp_Gdataphp_Queryphp'php)php;
php php php php php php php php php}
php php php php php php php php returnphp parentphp:php:getFeedphp(php$uriphp,php php$classNamephp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp entryphp asphp stringphp orphp object
php php php php php php*
php php php php php php*php php@paramphp mixedphp php$locationphp Thephp locationphp asphp stringphp orphp Zendphp_Gdataphp_Query
php php php php php php*php php@throwsphp Zendphp_Gdataphp_Appphp_InvalidArgumentException
php php php php php php*php php@returnphp stringphp|Zendphp_Gdataphp_Appphp_Entryphp Returnsphp stringphp onlyphp ifphp thephp object
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php mappingphp hasphp beenphp disabledphp explicitly
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php byphp passingphp falsephp tophp the
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php useObjectMappingphp(php)php functionphp.
php php php php php php*php/
php php php php publicphp functionphp getEntryphp(php$locationphp,php php$classNamephp=php'Zendphp_Gdataphp_Entryphp'php)
php php php php php{
php php php php php php php php ifphp php(isphp_stringphp(php$locationphp)php)php php{
php php php php php php php php php php php php php$uriphp php=php php$locationphp;
php php php php php php php php php}php elseifphp php(php$locationphp instanceofphp Zendphp_Gdataphp_Queryphp)php php{
php php php php php php php php php php php php php$uriphp php=php php$locationphp-php>getQueryUrlphp(php)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Gdataphp/Appphp/InvalidArgumentExceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Gdataphp_Appphp_InvalidArgumentExceptionphp(
php php php php php php php php php php php php php php php php php php php php php'Youphp mustphp specifyphp thephp locationphp asphp eitherphp aphp stringphp URIphp php'php php.
php php php php php php php php php php php php php php php php php php php php php'orphp aphp childphp ofphp Zendphp_Gdataphp_Queryphp'php)php;
php php php php php php php php php}
php php php php php php php php returnphp parentphp:php:getEntryphp(php$uriphp,php php$classNamephp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Performsphp aphp HTTPphp requestphp usingphp thephp specifiedphp methodphp.
php php php php php php*
php php php php php php*php Overridesphp thephp definitionphp inphp thephp parentphp php(Zendphp_Gdataphp_Appphp)
php php php php php php*php andphp usesphp thephp Zendphp_Gdataphp_HttpClientphp functionality
php php php php php php*php tophp filterphp thephp HTTPphp requestsphp andphp responsesphp.
php php php php php php*
php php php php php php*php php@paramphp stringphp php$methodphp Thephp HTTPphp methodphp forphp thephp requestphp php-
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php'GETphp'php,php php'POSTphp'php,php php'PUTphp'php,php php'DELETEphp'
php php php php php php*php php@paramphp stringphp php$urlphp Thephp URLphp tophp whichphp thisphp requestphp isphp beingphp performedphp,
php php php php php php*php php php php php php php php php php php php php php php php php php php php orphp nullphp ifphp foundphp inphp php$data
php php php php php php*php php@paramphp arrayphp php$headersphp Anphp associativephp arrayphp ofphp HTTPphp headers
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php forphp thisphp request
php php php php php php*php php@paramphp stringphp php$bodyphp Thephp bodyphp ofphp thephp HTTPphp request
php php php php php php*php php@paramphp stringphp php$contentTypephp Thephp valuephp forphp thephp contentphp typephp ofphp the
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php requestphp body
php php php php php php*php php@paramphp intphp php$remainingRedirectsphp Numberphp ofphp redirectsphp tophp follow
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php ifphp requestsphp resultsphp inphp one
php php php php php php*php php@returnphp Zendphp_Httpphp_Responsephp Thephp responsephp object
php php php php php php*php/
php php php php publicphp functionphp performHttpRequestphp(php$methodphp,php php$urlphp,php php$headersphp php=php arrayphp(php)php,php php$bodyphp php=php nullphp,php php$contentTypephp php=php nullphp,php php$remainingRedirectsphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_httpClientphp instanceofphp Zendphp_Gdataphp_HttpClientphp)php php{
php php php php php php php php php php php php php$filterResultphp php=php php$thisphp-php>php_httpClientphp-php>filterHttpRequestphp(php$methodphp,php php$urlphp,php php$headersphp,php php$bodyphp,php php$contentTypephp)php;
php php php php php php php php php php php php php$methodphp php=php php$filterResultphp[php'methodphp'php]php;
php php php php php php php php php php php php php$urlphp php=php php$filterResultphp[php'urlphp'php]php;
php php php php php php php php php php php php php$bodyphp php=php php$filterResultphp[php'bodyphp'php]php;
php php php php php php php php php php php php php$headersphp php=php php$filterResultphp[php'headersphp'php]php;
php php php php php php php php php php php php php$contentTypephp php=php php$filterResultphp[php'contentTypephp'php]php;
php php php php php php php php php php php php returnphp php$thisphp-php>php_httpClientphp-php>filterHttpResponsephp(parentphp:php:performHttpRequestphp(php$methodphp,php php$urlphp,php php$headersphp,php php$bodyphp,php php$contentTypephp,php php$remainingRedirectsphp)php)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php returnphp parentphp:php:performHttpRequestphp(php$methodphp,php php$urlphp,php php$headersphp,php php$bodyphp,php php$contentTypephp,php php$remainingRedirectsphp)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Determinesphp whetherphp servicephp objectphp isphp authenticatedphp.
php php php php php php*
php php php php php php*php php@returnphp booleanphp Truephp ifphp servicephp objectphp isphp authenticatedphp,php falsephp otherwisephp.
php php php php php php*php/
php php php php publicphp functionphp isAuthenticatedphp(php)
php php php php php{
php php php php php php php php php$clientphp php=php parentphp:php:getHttpClientphp(php)php;
php php php php php php php php ifphp php(php$clientphp-php>getClientLoginTokenphp(php)php php|php|
php php php php php php php php php php php php php$clientphp-php>getAuthSubTokenphp(php)php)php php{
php php php php php php php php php php php php php php php php returnphp truephp;
php php php php php php php php php}

php php php php php php php php returnphp falsephp;
php php php php php}

php}
