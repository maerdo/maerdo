<php?php
php/php*php*
php php*php Zendphp Framework
php php*
php php*php LICENSE
php php*
php php*php Thisphp sourcephp filephp isphp subjectphp tophp thephp newphp BSDphp licensephp thatphp isphp bundled
php php*php withphp thisphp packagephp inphp thephp filephp LICENSEphp.txtphp.
php php*php Itphp isphp alsophp availablephp throughphp thephp worldphp-widephp-webphp atphp thisphp URLphp:
php php*php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsd
php php*php Ifphp youphp didphp notphp receivephp aphp copyphp ofphp thephp licensephp andphp arephp unablephp to
php php*php obtainphp itphp throughphp thephp worldphp-widephp-webphp,php pleasephp sendphp anphp email
php php*php tophp licensephp@zendphp.comphp sophp wephp canphp sendphp youphp aphp copyphp immediatelyphp.
php php*
php php*php php@categoryphp php Zend
php php*php php@packagephp php php Zendphp_Currency
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@versionphp php php php$Idphp:php Currencyphp.phpphp php2php3php4php9php4php php2php0php1php0php-php1php2php-php1php1php php1php8php:php4php7php:php3php6Zphp ramonphp php$
php php*php/

php/php*php*
php php*php includephp neededphp classes
php php*php/
requirephp_oncephp php'Zendphp/Localephp.phpphp'php;
requirephp_oncephp php'Zendphp/Localephp/Dataphp.phpphp'php;
requirephp_oncephp php'Zendphp/Localephp/Formatphp.phpphp'php;

php/php*php*
php php*php Classphp forphp handlingphp currencyphp notations
php php*
php php*php php@categoryphp php Zend
php php*php php@packagephp php php Zendphp_Currency
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php/
classphp Zendphp_Currency
php{
php php php php php/php/php Constantsphp forphp definingphp whatphp currencyphp symbolphp shouldphp bephp displayed
php php php php constphp NOphp_SYMBOLphp php php php php php=php php1php;
php php php php constphp USEphp_SYMBOLphp php php php php=php php2php;
php php php php constphp USEphp_SHORTNAMEphp php=php php3php;
php php php php constphp USEphp_NAMEphp php php php php php php=php php4php;

php php php php php/php/php Constantsphp forphp definingphp thephp positionphp ofphp thephp currencysign
php php php php constphp STANDARDphp php=php php8php;
php php php php constphp RIGHTphp php php php php=php php1php6php;
php php php php constphp LEFTphp php php php php php=php php3php2php;

php php php php php/php*php*
php php php php php php*php Optionsphp array
php php php php php php*
php php php php php php*php Thephp followingphp optionsphp arephp available
php php php php php php*php php'positionphp'php php php=php>php Positionphp forphp thephp currencyphp sign
php php php php php php*php php'scriptphp'php php php php php=php>php Scriptphp forphp thephp output
php php php php php php*php php'formatphp'php php php php php=php>php Localephp forphp numericphp output
php php php php php php*php php'displayphp'php php php php=php>php Currencyphp detailphp tophp show
php php php php php php*php php'precisionphp'php php=php>php Precisionphp forphp thephp currency
php php php php php php*php php'namephp'php php php php php php php=php>php Namephp forphp thisphp currency
php php php php php php*php php'currencyphp'php php php=php>php php3php letteredphp internationalphp abbreviation
php php php php php php*php php'symbolphp'php php php php php=php>php Currencyphp symbol
php php php php php php*php php'localephp'php php php php php=php>php Localephp forphp thisphp currency
php php php php php php*php php'valuephp'php php php php php php=php>php Moneyphp value
php php php php php php*php php'servicephp'php php php php=php>php Exchangephp servicephp tophp use
php php php php php php*
php php php php php php*php php@varphp array
php php php php php php*php php@seephp Zendphp_Locale
php php php php php php*php/
php php php php protectedphp php$php_optionsphp php=php arrayphp(
php php php php php php php php php'positionphp'php php php=php>php selfphp:php:STANDARDphp,
php php php php php php php php php'scriptphp'php php php php php=php>php nullphp,
php php php php php php php php php'formatphp'php php php php php=php>php nullphp,
php php php php php php php php php'displayphp'php php php php=php>php selfphp:php:NOphp_SYMBOLphp,
php php php php php php php php php'precisionphp'php php=php>php php2php,
php php php php php php php php php'namephp'php php php php php php php=php>php nullphp,
php php php php php php php php php'currencyphp'php php php=php>php nullphp,
php php php php php php php php php'symbolphp'php php php php php=php>php nullphp,
php php php php php php php php php'localephp'php php php php php=php>php nullphp,
php php php php php php php php php'valuephp'php php php php php php=php>php php0php,
php php php php php php php php php'servicephp'php php php php=php>php nullphp,
php php php php php php php php php'tagphp'php php php php php php php php=php>php php'Zendphp_Localephp'
php php php php php)php;

php php php php php/php*php*
php php php php php php*php Createsphp aphp currencyphp instancephp.php Everyphp supressedphp parameterphp isphp usedphp fromphp thephp actualphp orphp thephp givenphp localephp.
php php php php php php*
php php php php php php*php php@paramphp php stringphp|arrayphp php php php php php php php$optionsphp OPTIONALphp Optionsphp arrayphp orphp currencyphp shortphp name
php php php php php php*php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php whenphp stringphp isphp given
php php php php php php*php php@paramphp php stringphp|Zendphp_Localephp php$localephp php OPTIONALphp localephp name
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Whenphp currencyphp isphp invalid
php php php php php php*php/
php php php php publicphp functionphp php_php_constructphp(php$optionsphp php=php nullphp,php php$localephp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(isphp_arrayphp(php$optionsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>setLocalephp(php$localephp)php;
php php php php php php php php php php php php php$thisphp-php>setFormatphp(php$optionsphp)php;
php php php php php php php php php}php elsephp ifphp php(Zendphp_Localephp:php:isLocalephp(php$optionsphp,php falsephp,php falsephp)php)php php{
php php php php php php php php php php php php php$thisphp-php>setLocalephp(php$optionsphp)php;
php php php php php php php php php php php php php$optionsphp php=php php$localephp;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php$thisphp-php>setLocalephp(php$localephp)php;
php php php php php php php php php}

php php php php php php php php php/php/php Getphp currencyphp details
php php php php php php php php ifphp php(php!issetphp(php$thisphp-php>php_optionsphp[php'currencyphp'php]php)php php|php|php php!isphp_arrayphp(php$optionsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_optionsphp[php'currencyphp'php]php php=php selfphp:php:getShortNamephp(php$optionsphp,php php$thisphp-php>php_optionsphp[php'localephp'php]php)php;
php php php php php php php php php}

php php php php php php php php ifphp php(php!issetphp(php$thisphp-php>php_optionsphp[php'namephp'php]php)php php|php|php php!isphp_arrayphp(php$optionsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_optionsphp[php'namephp'php]php php php php php php=php selfphp:php:getNamephp(php$optionsphp,php php$thisphp-php>php_optionsphp[php'localephp'php]php)php;
php php php php php php php php php}

php php php php php php php php ifphp php(php!issetphp(php$thisphp-php>php_optionsphp[php'symbolphp'php]php)php php|php|php php!isphp_arrayphp(php$optionsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_optionsphp[php'symbolphp'php]php php php php=php selfphp:php:getSymbolphp(php$optionsphp,php php$thisphp-php>php_optionsphp[php'localephp'php]php)php;
php php php php php php php php php}

php php php php php php php php ifphp php(php(php$thisphp-php>php_optionsphp[php'currencyphp'php]php php=php=php=php nullphp)php andphp php(php$thisphp-php>php_optionsphp[php'namephp'php]php php=php=php=php nullphp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php"Currencyphp php'php$optionsphp'php notphp foundphp"php)php;
php php php php php php php php php}

php php php php php php php php php/php/php Getphp thephp format
php php php php php php php php ifphp php(php!emptyphp(php$thisphp-php>php_optionsphp[php'symbolphp'php]php)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_optionsphp[php'displayphp'php]php php=php selfphp:php:USEphp_SYMBOLphp;
php php php php php php php php php}php elsephp ifphp php(php!emptyphp(php$thisphp-php>php_optionsphp[php'currencyphp'php]php)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_optionsphp[php'displayphp'php]php php=php selfphp:php:USEphp_SHORTNAMEphp;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp aphp localizedphp currencyphp string
php php php php php php*
php php php php php php*php php@paramphp php integerphp|floatphp php$valuephp php php OPTIONALphp Currencyphp value
php php php php php php*php php@paramphp php arrayphp php php php php php php php php php$optionsphp OPTIONALphp optionsphp tophp setphp temporary
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Whenphp thephp valuephp isphp notphp aphp number
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp toCurrencyphp(php$valuephp php=php nullphp,php arrayphp php$optionsphp php=php arrayphp(php)php)
php php php php php{
php php php php php php php php ifphp php(php$valuephp php=php=php=php nullphp)php php{
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$optionsphp)php php&php&php issetphp(php$optionsphp[php'valuephp'php]php)php)php php{
php php php php php php php php php php php php php php php php php$valuephp php=php php$optionsphp[php'valuephp'php]php;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$valuephp php=php php$thisphp-php>php_optionsphp[php'valuephp'php]php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php ifphp php(isphp_arrayphp(php$valuephp)php)php php{
php php php php php php php php php php php php php$optionsphp php+php=php php$valuephp;
php php php php php php php php php php php php ifphp php(issetphp(php$optionsphp[php'valuephp'php]php)php)php php{
php php php php php php php php php php php php php php php php php$valuephp php=php php$optionsphp[php'valuephp'php]php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php php/php/php Validatephp thephp passedphp number
php php php php php php php php ifphp php(php!php(issetphp(php$valuephp)php)php orphp php(isphp_numericphp(php$valuephp)php php=php=php=php falsephp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php"Valuephp php'php$valuephp'php hasphp tophp bephp numericphp"php)php;
php php php php php php php php php}

php php php php php php php php ifphp php(issetphp(php$optionsphp[php'currencyphp'php]php)php)php php{
php php php php php php php php php php php php ifphp php(php!issetphp(php$optionsphp[php'localephp'php]php)php)php php{
php php php php php php php php php php php php php php php php php$optionsphp[php'localephp'php]php php=php php$thisphp-php>php_optionsphp[php'localephp'php]php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php php$optionsphp[php'currencyphp'php]php php=php selfphp:php:getShortNamephp(php$optionsphp[php'currencyphp'php]php,php php$optionsphp[php'localephp'php]php)php;
php php php php php php php php php php php php php$optionsphp[php'namephp'php]php php php php php php=php selfphp:php:getNamephp(php$optionsphp[php'currencyphp'php]php,php php$optionsphp[php'localephp'php]php)php;
php php php php php php php php php php php php php$optionsphp[php'symbolphp'php]php php php php=php selfphp:php:getSymbolphp(php$optionsphp[php'currencyphp'php]php,php php$optionsphp[php'localephp'php]php)php;
php php php php php php php php php}

php php php php php php php php php$optionsphp php=php php$thisphp-php>php_checkOptionsphp(php$optionsphp)php php+php php$thisphp-php>php_optionsphp;

php php php php php php php php php/php/php Formatphp thephp number
php php php php php php php php php$formatphp php=php php$optionsphp[php'formatphp'php]php;
php php php php php php php php php$localephp php=php php$optionsphp[php'localephp'php]php;
php php php php php php php php ifphp php(emptyphp(php$formatphp)php)php php{
php php php php php php php php php php php php php$formatphp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$localephp,php php'currencynumberphp'php)php;
php php php php php php php php php}php elsephp ifphp php(Zendphp_Localephp:php:isLocalephp(php$formatphp,php truephp,php falsephp)php)php php{
php php php php php php php php php php php php php$localephp php=php php$formatphp;
php php php php php php php php php php php php php$formatphp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$formatphp,php php'currencynumberphp'php)php;
php php php php php php php php php}

php php php php php php php php php$originalphp php=php php$valuephp;
php php php php php php php php php$valuephp php php php php=php Zendphp_Localephp_Formatphp:php:toNumberphp(php$valuephp,php arrayphp(php'localephp'php php php php php php php php php=php>php php$localephp,
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php'numberphp_formatphp'php php=php>php php$formatphp,
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php'precisionphp'php php php php php php=php>php php$optionsphp[php'precisionphp'php]php)php)php;

php php php php php php php php ifphp php(php$optionsphp[php'positionphp'php]php php!php=php=php selfphp:php:STANDARDphp)php php{
php php php php php php php php php php php php php$valuephp php=php strphp_replacephp(php'php¤php'php,php php'php'php,php php$valuephp)php;
php php php php php php php php php php php php php$spacephp php=php php'php'php;
php php php php php php php php php php php php ifphp php(iconvphp_strposphp(php$valuephp,php php'php php'php)php php!php=php=php falsephp)php php{
php php php php php php php php php php php php php php php php php$valuephp php=php strphp_replacephp(php'php php'php,php php'php'php,php php$valuephp)php;
php php php php php php php php php php php php php php php php php$spacephp php=php php'php php'php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php ifphp php(php$optionsphp[php'positionphp'php]php php=php=php selfphp:php:LEFTphp)php php{
php php php php php php php php php php php php php php php php php$valuephp php=php php'php¤php'php php.php php$spacephp php.php php$valuephp;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$valuephp php=php php$valuephp php.php php$spacephp php.php php'php¤php'php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php php/php/php Localizephp thephp numberphp digits
php php php php php php php php ifphp php(emptyphp(php$optionsphp[php'scriptphp'php]php)php php=php=php=php falsephp)php php{
php php php php php php php php php php php php php$valuephp php=php Zendphp_Localephp_Formatphp:php:convertNumeralsphp(php$valuephp,php php'Latnphp'php,php php$optionsphp[php'scriptphp'php]php)php;
php php php php php php php php php}

php php php php php php php php php/php/php Getphp thephp signphp tophp bephp placedphp nextphp tophp thephp number
php php php php php php php php ifphp php(isphp_numericphp(php$optionsphp[php'displayphp'php]php)php php=php=php=php falsephp)php php{
php php php php php php php php php php php php php$signphp php=php php$optionsphp[php'displayphp'php]php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php switchphp(php$optionsphp[php'displayphp'php]php)php php{
php php php php php php php php php php php php php php php php casephp selfphp:php:USEphp_SYMBOLphp:
php php php php php php php php php php php php php php php php php php php php php$signphp php=php php$thisphp-php>php_extractPatternphp(php$optionsphp[php'symbolphp'php]php,php php$originalphp)php;
php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php casephp selfphp:php:USEphp_SHORTNAMEphp:
php php php php php php php php php php php php php php php php php php php php php$signphp php=php php$optionsphp[php'currencyphp'php]php;
php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php casephp selfphp:php:USEphp_NAMEphp:
php php php php php php php php php php php php php php php php php php php php php$signphp php=php php$optionsphp[php'namephp'php]php;
php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php defaultphp:
php php php php php php php php php php php php php php php php php php php php php$signphp php=php php'php'php;
php php php php php php php php php php php php php php php php php php php php php$valuephp php=php strphp_replacephp(php'php php'php,php php'php'php,php php$valuephp)php;
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php php$valuephp php=php strphp_replacephp(php'php¤php'php,php php$signphp,php php$valuephp)php;
php php php php php php php php returnphp php$valuephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Internalphp methodphp tophp extractphp thephp currencyphp pattern
php php php php php php*php whenphp aphp choicephp isphp givenphp basedphp onphp thephp givenphp value
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$pattern
php php php php php php*php php@paramphp php floatphp|integerphp php$value
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php privatephp functionphp php_extractPatternphp(php$patternphp,php php$valuephp)
php php php php php{
php php php php php php php php ifphp php(strposphp(php$patternphp,php php'php|php'php)php php=php=php=php falsephp)php php{
php php php php php php php php php php php php returnphp php$patternphp;
php php php php php php php php php}

php php php php php php php php php$patternsphp php=php explodephp(php'php|php'php,php php$patternphp)php;
php php php php php php php php php$tokenphp php php php php=php php$patternphp;
php php php php php php php php php$valuephp php php php php=php trimphp(strphp_replacephp(php'php¤php'php,php php'php'php,php php$valuephp)php)php;
php php php php php php php php krsortphp(php$patternsphp)php;
php php php php php php php php foreachphp(php$patternsphp asphp php$contentphp)php php{
php php php php php php php php php php php php ifphp php(strposphp(php$contentphp,php php'<php'php)php php!php=php=php falsephp)php php{
php php php php php php php php php php php php php php php php php$checkphp php=php iconvphp_substrphp(php$contentphp,php php0php,php iconvphp_strposphp(php$contentphp,php php'<php'php)php)php;
php php php php php php php php php php php php php php php php php$tokenphp php=php iconvphp_substrphp(php$contentphp,php iconvphp_strposphp(php$contentphp,php php'<php'php)php php+php php1php)php;
php php php php php php php php php php php php php php php php ifphp php(php$checkphp <php php$valuephp)php php{
php php php php php php php php php php php php php php php php php php php php returnphp php$tokenphp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$checkphp php=php iconvphp_substrphp(php$contentphp,php php0php,php iconvphp_strposphp(php$contentphp,php php'php≤php'php)php)php;
php php php php php php php php php php php php php php php php php$tokenphp php=php iconvphp_substrphp(php$contentphp,php iconvphp_strposphp(php$contentphp,php php'php≤php'php)php php+php php1php)php;
php php php php php php php php php php php php php php php php ifphp php(php$checkphp <php=php php$valuephp)php php{
php php php php php php php php php php php php php php php php php php php php returnphp php$tokenphp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}

php php php php php php php php php}

php php php php php php php php returnphp php$tokenphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setsphp thephp formatingphp optionsphp ofphp thephp localizedphp currencyphp string
php php php php php php*php Ifphp nophp parameterphp isphp passedphp,php thephp standardphp settingphp ofphp the
php php php php php php*php actualphp setphp localephp willphp bephp used
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$optionsphp php(Optionalphp)php Optionsphp tophp set
php php php php php php*php php@returnphp Zendphp_Currency
php php php php php php*php/
php php php php publicphp functionphp setFormatphp(arrayphp php$optionsphp php=php arrayphp(php)php)
php php php php php{
php php php php php php php php php$thisphp-php>php_optionsphp php=php php$thisphp-php>php_checkOptionsphp(php$optionsphp)php php+php php$thisphp-php>php_optionsphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Internalphp functionphp forphp checkingphp staticphp givenphp localephp parameter
php php php php php php*
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php$currencyphp php(Optionalphp)php Currencyphp name
php php php php php php*php php@paramphp php stringphp|Zendphp_Localephp php$localephp php php php(Optionalphp)php Localephp tophp displayphp informations
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Whenphp localephp containsphp nophp region
php php php php php php*php php@returnphp stringphp Thephp extractedphp localephp representationphp asphp string
php php php php php php*php/
php php php php privatephp functionphp php_checkParamsphp(php$currencyphp php=php nullphp,php php$localephp php=php nullphp)
php php php php php{
php php php php php php php php php/php/php Managephp thephp params
php php php php php php php php ifphp php(php(emptyphp(php$localephp)php)php andphp php(php!emptyphp(php$currencyphp)php)php and
php php php php php php php php php php php php php(Zendphp_Localephp:php:isLocalephp(php$currencyphp,php truephp,php falsephp)php)php)php php{
php php php php php php php php php php php php php$localephp php php php=php php$currencyphp;
php php php php php php php php php php php php php$currencyphp php=php nullphp;
php php php php php php php php php}

php php php php php php php php php/php/php Validatephp thephp localephp andphp getphp thephp countryphp shortphp name
php php php php php php php php php$countryphp php=php nullphp;
php php php php php php php php ifphp php(php(Zendphp_Localephp:php:isLocalephp(php$localephp,php truephp,php falsephp)php)php andphp php(strlenphp(php$localephp)php php>php php4php)php)php php{
php php php php php php php php php php php php php$countryphp php=php substrphp(php$localephp,php php(strposphp(php$localephp,php php'php_php'php)php php+php php1php)php)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php"Nophp regionphp foundphp withinphp thephp localephp php'php"php php.php php(stringphp)php php$localephp php.php php"php'php"php)php;
php php php php php php php php php}

php php php php php php php php php/php/php Getphp thephp availablephp currenciesphp forphp thisphp country
php php php php php php php php php$dataphp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$localephp,php php'currencytoregionphp'php,php php$countryphp)php;
php php php php php php php php ifphp php(php(emptyphp(php$currencyphp)php php=php=php=php falsephp)php andphp php(emptyphp(php$dataphp)php php=php=php=php falsephp)php)php php{
php php php php php php php php php php php php php$abbreviationphp php=php php$currencyphp;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php$abbreviationphp php=php php$dataphp;
php php php php php php php php php}

php php php php php php php php returnphp arrayphp(php'localephp'php php=php>php php$localephp,php php'currencyphp'php php=php>php php$currencyphp,php php'namephp'php php=php>php php$abbreviationphp,php php'countryphp'php php=php>php php$countryphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp actualphp orphp detailsphp ofphp otherphp currencyphp symbolsphp,
php php php php php php*php whenphp nophp symbolphp isphp availablephp itphp returnsphp thephp currencyphp shortnamephp php(fphp.ephp.php FIMphp forphp Finnianphp Markphp)
php php php php php php*
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php$currencyphp php(Optionalphp)php Currencyphp name
php php php php php php*php php@paramphp php stringphp|Zendphp_Localephp php$localephp php php php(Optionalphp)php Localephp tophp displayphp informations
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getSymbolphp(php$currencyphp php=php nullphp,php php$localephp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(php(php$currencyphp php=php=php=php nullphp)php andphp php(php$localephp php=php=php=php nullphp)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_optionsphp[php'symbolphp'php]php;
php php php php php php php php php}

php php php php php php php php php$paramsphp php=php selfphp:php:php_checkParamsphp(php$currencyphp,php php$localephp)php;

php php php php php php php php php/php/php Getphp thephp symbol
php php php php php php php php php$symbolphp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$paramsphp[php'localephp'php]php,php php'currencysymbolphp'php,php php$paramsphp[php'currencyphp'php]php)php;
php php php php php php php php ifphp php(emptyphp(php$symbolphp)php php=php=php=php truephp)php php{
php php php php php php php php php php php php php$symbolphp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$paramsphp[php'localephp'php]php,php php'currencysymbolphp'php,php php$paramsphp[php'namephp'php]php)php;
php php php php php php php php php}

php php php php php php php php ifphp php(emptyphp(php$symbolphp)php php=php=php=php truephp)php php{
php php php php php php php php php php php php returnphp nullphp;
php php php php php php php php php}

php php php php php php php php returnphp php$symbolphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp actualphp orphp detailsphp ofphp otherphp currencyphp shortnames
php php php php php php*
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php$currencyphp OPTIONALphp Currencyphp'sphp name
php php php php php php*php php@paramphp php stringphp|Zendphp_Localephp php$localephp php php OPTIONALphp Thephp locale
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getShortNamephp(php$currencyphp php=php nullphp,php php$localephp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(php(php$currencyphp php=php=php=php nullphp)php andphp php(php$localephp php=php=php=php nullphp)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_optionsphp[php'currencyphp'php]php;
php php php php php php php php php}

php php php php php php php php php$paramsphp php=php selfphp:php:php_checkParamsphp(php$currencyphp,php php$localephp)php;

php php php php php php php php php/php/php Getphp thephp shortname
php php php php php php php php ifphp php(emptyphp(php$paramsphp[php'currencyphp'php]php)php php=php=php=php truephp)php php{
php php php php php php php php php php php php returnphp php$paramsphp[php'namephp'php]php;
php php php php php php php php php}

php php php php php php php php php$listphp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$paramsphp[php'localephp'php]php,php php'currencytonamephp'php,php php$paramsphp[php'currencyphp'php]php)php;
php php php php php php php php ifphp php(emptyphp(php$listphp)php php=php=php=php truephp)php php{
php php php php php php php php php php php php php$listphp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$paramsphp[php'localephp'php]php,php php'nametocurrencyphp'php,php php$paramsphp[php'currencyphp'php]php)php;
php php php php php php php php php php php php ifphp php(emptyphp(php$listphp)php php=php=php=php falsephp)php php{
php php php php php php php php php php php php php php php php php$listphp php=php php$paramsphp[php'currencyphp'php]php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php ifphp php(emptyphp(php$listphp)php php=php=php=php truephp)php php{
php php php php php php php php php php php php returnphp nullphp;
php php php php php php php php php}

php php php php php php php php returnphp php$listphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp actualphp orphp detailsphp ofphp otherphp currencyphp names
php php php php php php*
php php php php php php*php php@paramphp php stringphp php php php php php php php php php php php php php$currencyphp php(Optionalphp)php Currencyphp'sphp shortphp name
php php php php php php*php php@paramphp php stringphp|Zendphp_Localephp php$localephp php php php(Optionalphp)php Thephp locale
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getNamephp(php$currencyphp php=php nullphp,php php$localephp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(php(php$currencyphp php=php=php=php nullphp)php andphp php(php$localephp php=php=php=php nullphp)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_optionsphp[php'namephp'php]php;
php php php php php php php php php}

php php php php php php php php php$paramsphp php=php selfphp:php:php_checkParamsphp(php$currencyphp,php php$localephp)php;

php php php php php php php php php/php/php Getphp thephp name
php php php php php php php php php$namephp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$paramsphp[php'localephp'php]php,php php'nametocurrencyphp'php,php php$paramsphp[php'currencyphp'php]php)php;
php php php php php php php php ifphp php(emptyphp(php$namephp)php php=php=php=php truephp)php php{
php php php php php php php php php php php php php$namephp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$paramsphp[php'localephp'php]php,php php'nametocurrencyphp'php,php php$paramsphp[php'namephp'php]php)php;
php php php php php php php php php}

php php php php php php php php ifphp php(emptyphp(php$namephp)php php=php=php=php truephp)php php{
php php php php php php php php php php php php returnphp nullphp;
php php php php php php php php php}

php php php php php php php php returnphp php$namephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp aphp listphp ofphp regionsphp wherephp thisphp currencyphp isphp orphp wasphp known
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$currencyphp OPTIONALphp Currencyphp'sphp shortphp name
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Whenphp nophp currencyphp wasphp defined
php php php php php php*php php@returnphp arrayphp Listphp ofphp regions
php php php php php php*php/
php php php php publicphp functionphp getRegionListphp(php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(php$currencyphp php=php=php=php nullphp)php php{
php php php php php php php php php php php php php$currencyphp php=php php$thisphp-php>php_optionsphp[php'currencyphp'php]php;
php php php php php php php php php}

php php php php php php php php ifphp php(emptyphp(php$currencyphp)php php=php=php=php truephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php'Nophp currencyphp definedphp'php)php;
php php php php php php php php php}

php php php php php php php php php$dataphp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$thisphp-php>php_optionsphp[php'localephp'php]php,php php'regiontocurrencyphp'php,php php$currencyphp)php;

php php php php php php php php php$resultphp php=php explodephp(php'php php'php,php php$dataphp)php;
php php php php php php php php returnphp php$resultphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp aphp listphp ofphp currenciesphp whichphp arephp usedphp inphp thisphp region
php php php php php php*php aphp regionphp namephp shouldphp bephp php2php charachtersphp onlyphp php(fphp.ephp.php EGphp,php DEphp,php USphp)
php php php php php php*php Ifphp nophp regionphp isphp givenphp,php thephp actualphp regionphp isphp used
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$regionphp OPTIONALphp Regionphp tophp returnphp thephp currenciesphp for
php php php php php php*php php@returnphp arrayphp Listphp ofphp currencies
php php php php php php*php/
php php php php publicphp functionphp getCurrencyListphp(php$regionphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(emptyphp(php$regionphp)php php=php=php=php truephp)php php{
php php php php php php php php php php php php ifphp php(strlenphp(php$thisphp-php>php_optionsphp[php'localephp'php]php)php php>php php4php)php php{
php php php php php php php php php php php php php php php php php$regionphp php=php substrphp(php$thisphp-php>php_optionsphp[php'localephp'php]php,php php(strposphp(php$thisphp-php>php_optionsphp[php'localephp'php]php,php php'php_php'php)php php+php php1php)php)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php php$dataphp php=php Zendphp_Localephp_Dataphp:php:getContentphp(php$thisphp-php>php_optionsphp[php'localephp'php]php,php php'currencytoregionphp'php,php php$regionphp)php;

php php php php php php php php php$resultphp php=php explodephp(php'php php'php,php php$dataphp)php;
php php php php php php php php returnphp php$resultphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp actualphp currencyphp name
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp toStringphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>toCurrencyphp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp currencyphp name
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp php_php_toStringphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>toStringphp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp setphp cache
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Cachephp_Corephp Thephp setphp cache
php php php php php php*php/
php php php php publicphp staticphp functionphp getCachephp(php)
php php php php php{
php php php php php php php php returnphp Zendphp_Localephp_Dataphp:php:getCachephp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setsphp aphp cachephp forphp Zendphp_Currency
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Cachephp_Corephp php$cachephp Cachephp tophp set
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp staticphp functionphp setCachephp(Zendphp_Cachephp_Corephp php$cachephp)
php php php php php{
php php php php php php php php Zendphp_Localephp_Dataphp:php:setCachephp(php$cachephp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp truephp whenphp aphp cachephp isphp set
php php php php php php*
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp staticphp functionphp hasCachephp(php)
php php php php php{
php php php php php php php php returnphp Zendphp_Localephp_Dataphp:php:hasCachephp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Removesphp anyphp setphp cache
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp staticphp functionphp removeCachephp(php)
php php php php php{
php php php php php php php php Zendphp_Localephp_Dataphp:php:removeCachephp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Clearsphp allphp setphp cachephp data
php php php php php php*
php php php php php php*php php@paramphp stringphp php$tagphp Tagphp tophp clearphp whenphp thephp defaultphp tagphp namephp isphp notphp used
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp staticphp functionphp clearCachephp(php$tagphp php=php nullphp)
php php php php php{
php php php php php php php php Zendphp_Localephp_Dataphp:php:clearCachephp(php$tagphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setsphp aphp newphp localephp forphp dataphp retreivement
php php php php php php*php Examplephp:php php'dephp_XXphp'php willphp bephp setphp tophp php'dephp'php becausephp php'dephp_XXphp'php doesphp notphp exist
php php php php php php*php php'xxphp_YYphp'php willphp bephp setphp tophp php'rootphp'php becausephp php'xxphp'php doesphp notphp exist
php php php php php php*
php php php php php php*php php@paramphp php stringphp|Zendphp_Localephp php$localephp php(Optionalphp)php Localephp forphp parsingphp input
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Whenphp thephp givenphp localephp doesphp notphp exist
php php php php php php*php php@returnphp Zendphp_Currencyphp Providesphp fluentphp interface
php php php php php php*php/
php php php php publicphp functionphp setLocalephp(php$localephp php=php nullphp)
php php php php php{
php php php php php php php php requirephp_oncephp php'Zendphp/Localephp.phpphp'php;
php php php php php php php php tryphp php{
php php php php php php php php php php php php php$localephp php=php Zendphp_Localephp:php:findLocalephp(php$localephp)php;
php php php php php php php php php php php php ifphp php(strlenphp(php$localephp)php php>php php4php)php php{
php php php php php php php php php php php php php php php php php$thisphp-php>php_optionsphp[php'localephp'php]php php=php php$localephp;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php"Nophp regionphp foundphp withinphp thephp localephp php'php"php php.php php(stringphp)php php$localephp php.php php"php'php"php)php;
php php php php php php php php php php php php php}
php php php php php php php php php}php catchphp php(Zendphp_Localephp_Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php$ephp-php>getMessagephp(php)php)php;
php php php php php php php php php}

php php php php php php php php php/php/php Getphp currencyphp details
php php php php php php php php php$thisphp-php>php_optionsphp[php'currencyphp'php]php php=php php$thisphp-php>getShortNamephp(nullphp,php php$thisphp-php>php_optionsphp[php'localephp'php]php)php;
php php php php php php php php php$thisphp-php>php_optionsphp[php'namephp'php]php php php php php php=php php$thisphp-php>getNamephp(nullphp,php php$thisphp-php>php_optionsphp[php'localephp'php]php)php;
php php php php php php php php php$thisphp-php>php_optionsphp[php'symbolphp'php]php php php php=php php$thisphp-php>getSymbolphp(nullphp,php php$thisphp-php>php_optionsphp[php'localephp'php]php)php;

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp actualphp setphp locale
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getLocalephp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_optionsphp[php'localephp'php]php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp value
php php php php php php*
php php php php php php*php php@returnphp float
php php php php php php*php/
php php php php publicphp functionphp getValuephp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_optionsphp[php'valuephp'php]php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addsphp aphp currency
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Addphp thisphp valuephp tophp currency
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp add
php php php php php php*php php@returnphp Zendphp_Currency
php php php php php php*php/
php php php php publicphp functionphp setValuephp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_optionsphp[php'valuephp'php]php php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addsphp aphp currency
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Addphp thisphp valuephp tophp currency
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp add
php php php php php php*php php@returnphp Zendphp_Currency
php php php php php php*php/
php php php php publicphp functionphp addphp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$valuephp php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php php$thisphp-php>php_optionsphp[php'valuephp'php]php php+php=php php(floatphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Substractsphp aphp currency
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Substractsphp thisphp valuephp fromphp currency
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp substract
php php php php php php*php php@returnphp Zendphp_Currency
php php php php php php*php/
php php php php publicphp functionphp subphp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$valuephp php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php php$thisphp-php>php_optionsphp[php'valuephp'php]php php-php=php php(floatphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Dividesphp aphp currency
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Dividesphp thisphp valuephp fromphp currency
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp divide
php php php php php php*php php@returnphp Zendphp_Currency
php php php php php php*php/
php php php php publicphp functionphp divphp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$valuephp php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php php$thisphp-php>php_optionsphp[php'valuephp'php]php php/php=php php(floatphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Multipliesphp aphp currency
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Multipliesphp thisphp valuephp fromphp currency
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp multiply
php php php php php php*php php@returnphp Zendphp_Currency
php php php php php php*php/
php php php php publicphp functionphp mulphp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$valuephp php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php php$thisphp-php>php_optionsphp[php'valuephp'php]php php*php=php php(floatphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Calculatesphp thephp modulophp fromphp aphp currency
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Calculatephp modulophp fromphp thisphp value
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp calculatephp thephp modulo
php php php php php php*php php@returnphp Zendphp_Currency
php php php php php php*php/
php php php php publicphp functionphp modphp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$valuephp php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php php$thisphp-php>php_optionsphp[php'valuephp'php]php php%php=php php(floatphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Comparesphp twophp currencies
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Comparesphp thephp currencyphp withphp thisphp value
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp comparephp thisphp valuephp from
php php php php php php*php php@returnphp Zendphp_Currency
php php php php php php*php/
php php php php publicphp functionphp comparephp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$valuephp php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php php$valuephp php=php php$thisphp-php>php_optionsphp[php'valuephp'php]php php-php php$valuephp;
php php php php php php php php ifphp php(php$valuephp <php php0php)php php{
php php php php php php php php php php php php returnphp php-php1php;
php php php php php php php php php}php elsephp ifphp php(php$valuephp php>php php0php)php php{
php php php php php php php php php php php php returnphp php1php;
php php php php php php php php php}

php php php php php php php php returnphp php0php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp truephp whenphp thephp twophp currenciesphp arephp equal
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Comparesphp thephp currencyphp withphp thisphp value
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp comparephp thisphp valuephp from
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp equalsphp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$valuephp php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php ifphp php(php$thisphp-php>php_optionsphp[php'valuephp'php]php php=php=php php$valuephp)php php{
php php php php php php php php php php php php returnphp truephp;
php php php php php php php php php}

php php php php php php php php returnphp falsephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp truephp whenphp thephp currencyphp isphp morephp thanphp thephp givenphp value
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Comparesphp thephp currencyphp withphp thisphp value
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp comparephp thisphp valuephp from
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp isMorephp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$valuephp php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php ifphp php(php$thisphp-php>php_optionsphp[php'valuephp'php]php php>php php$valuephp)php php{
php php php php php php php php php php php php returnphp truephp;
php php php php php php php php php}

php php php php php php php php returnphp falsephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp truephp whenphp thephp currencyphp isphp lessphp thanphp thephp givenphp value
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Comparesphp thephp currencyphp withphp thisphp value
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp comparephp thisphp valuephp from
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp isLessphp(php$valuephp,php php$currencyphp php=php nullphp)
php php php php php{
php php php php php php php php php$valuephp php=php php$thisphp-php>php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)php;
php php php php php php php php ifphp php(php$thisphp-php>php_optionsphp[php'valuephp'php]php <php php$valuephp)php php{
php php php php php php php php php php php php returnphp truephp;
php php php php php php php php php}

php php php php php php php php returnphp falsephp;

php php php php php}

php php php php php/php*php*
php php php php php php*php Internalphp methodphp whichphp calculatesphp thephp exchangesphp currency
php php php php php php*
php php php php php php*php php@paramphp floatphp|integerphp|Zendphp_Currencyphp php$valuephp php php php Comparesphp thephp currencyphp withphp thisphp value
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp php php php php php php php php$currencyphp Thephp currencyphp tophp comparephp thisphp valuephp from
php php php php php php*php php@returnphp unknown
php php php php php php*php/
php php php php protectedphp functionphp php_exchangeCurrencyphp(php$valuephp,php php$currencyphp)
php php php php php{
php php php php php php php php ifphp php(php$valuephp instanceofphp Zendphp_Currencyphp)php php{
php php php php php php php php php php php php php$currencyphp php=php php$valuephp-php>getShortNamephp(php)php;
php php php php php php php php php php php php php$valuephp php php php php=php php$valuephp-php>getValuephp(php)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php$currencyphp php=php php$thisphp-php>getShortNamephp(php$currencyphp,php php$thisphp-php>getLocalephp(php)php)php;
php php php php php php php php php}

php php php php php php php php php$ratephp php=php php1php;
php php php php php php php php ifphp php(php$currencyphp php!php=php=php php$thisphp-php>getShortNamephp(php)php)php php{
php php php php php php php php php php php php php$servicephp php=php php$thisphp-php>getServicephp(php)php;
php php php php php php php php php php php php ifphp php(php!php(php$servicephp instanceofphp Zendphp_Currencyphp_CurrencyInterfacephp)php)php php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php'Nophp exchangephp servicephp appliedphp'php)php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php php$ratephp php=php php$servicephp-php>getRatephp(php$currencyphp,php php$thisphp-php>getShortNamephp(php)php)php;
php php php php php php php php php}

php php php php php php php php php$valuephp php*php=php php$ratephp;
php php php php php php php php returnphp php$valuephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnsphp thephp setphp servicephp class
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Service
php php php php php php*php/
php php php php publicphp functionphp getServicephp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_optionsphp[php'servicephp'php]php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setsphp aphp newphp exchangephp service
php php php php php php*
php php php php php php*php php@paramphp stringphp|Zendphp_Currencyphp_CurrencyInterfacephp php$servicephp Servicephp class
php php php php php php*php php@returnphp Zendphp_Currency
php php php php php php*php/
php php php php publicphp functionphp setServicephp(php$servicephp)
php php php php php{
php php php php php php php php ifphp php(isphp_stringphp(php$servicephp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Loaderphp.phpphp'php;
php php php php php php php php php php php php ifphp php(php!classphp_existsphp(php$servicephp)php)php php{
php php php php php php php php php php php php php php php php php$filephp php=php strphp_replacephp(php'php_php'php,php DIRECTORYphp_SEPARATORphp,php php$servicephp)php php.php php'php.phpphp'php;
php php php php php php php php php php php php php php php php ifphp php(Zendphp_Loaderphp:php:isReadablephp(php$filephp)php)php php{
php php php php php php php php php php php php php php php php php php php php Zendphp_Loaderphp:php:loadClassphp(php$servicephp)php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}

php php php php php php php php php php php php php$servicephp php=php newphp php$servicephp;
php php php php php php php php php}

php php php php php php php php ifphp php(php!php(php$servicephp instanceofphp Zendphp_Currencyphp_CurrencyInterfacephp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php'Aphp currencyphp servicephp mustphp implementphp Zendphp_Currencyphp_CurrencyInterfacephp'php)php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_optionsphp[php'servicephp'php]php php=php php$servicephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Internalphp methodphp forphp checkingphp thephp optionsphp array
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$optionsphp Optionsphp tophp check
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Onphp unknownphp position
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Onphp unknownphp locale
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Onphp unknownphp display
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Onphp precisionphp notphp betweenphp php-php1php andphp php3php0
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Onphp problemphp withphp scriptphp conversion
php php php php php php*php php@throwsphp Zendphp_Currencyphp_Exceptionphp Onphp unknownphp options
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php protectedphp functionphp php_checkOptionsphp(arrayphp php$optionsphp php=php arrayphp(php)php)
php php php php php{
php php php php php php php php ifphp php(countphp(php$optionsphp)php php=php=php=php php0php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_optionsphp;
php php php php php php php php php}

php php php php php php php php foreachphp php(php$optionsphp asphp php$namephp php=php>php php$valuephp)php php{
php php php php php php php php php php php php php$namephp php=php strtolowerphp(php$namephp)php;
php php php php php php php php php php php php ifphp php(php$namephp php!php=php=php php'formatphp'php)php php{
php php php php php php php php php php php php php php php php ifphp php(gettypephp(php$valuephp)php php=php=php=php php'stringphp'php)php php{
php php php php php php php php php php php php php php php php php php php php php$valuephp php=php strtolowerphp(php$valuephp)php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}

php php php php php php php php php php php php switchphp(php$namephp)php php{
php php php php php php php php php php php php php php php php casephp php'positionphp'php:
php php php php php php php php php php php php php php php php php php php php ifphp php(php(php$valuephp php!php=php=php selfphp:php:STANDARDphp)php andphp php(php$valuephp php!php=php=php selfphp:php:RIGHTphp)php andphp php(php$valuephp php!php=php=php selfphp:php:LEFTphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php"Unknownphp positionphp php'php"php php.php php$valuephp php.php php"php'php"php)php;
php php php php php php php php php php php php php php php php php php php php php}

php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php casephp php'formatphp'php:
php php php php php php php php php php php php php php php php php php php php ifphp php(php(emptyphp(php$valuephp)php php=php=php=php falsephp)php andphp php(Zendphp_Localephp:php:isLocalephp(php$valuephp,php nullphp,php falsephp)php php=php=php=php falsephp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php ifphp php(php!isphp_stringphp(php$valuephp)php php|php|php php(strposphp(php$valuephp,php php'php0php'php)php php=php=php=php falsephp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php"php'php"php php.
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php(php(gettypephp(php$valuephp)php php=php=php=php php'objectphp'php)php php?php getphp_classphp(php$valuephp)php php:php php$valuephp)
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php.php php"php'php isphp nophp formatphp tokenphp"php)php;
php php php php php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php casephp php'displayphp'php:
php php php php php php php php php php php php php php php php php php php php ifphp php(isphp_numericphp(php$valuephp)php andphp php(php$valuephp php!php=php=php selfphp:php:NOphp_SYMBOLphp)php andphp php(php$valuephp php!php=php=php selfphp:php:USEphp_SYMBOLphp)php and
php php php php php php php php php php php php php php php php php php php php php php php php php(php$valuephp php!php=php=php selfphp:php:USEphp_SHORTNAMEphp)php andphp php(php$valuephp php!php=php=php selfphp:php:USEphp_NAMEphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php"Unknownphp displayphp php'php$valuephp'php"php)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php casephp php'precisionphp'php:
php php php php php php php php php php php php php php php php php php php php ifphp php(php$valuephp php=php=php=php nullphp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$valuephp php=php php-php1php;
php php php php php php php php php php php php php php php php php php php php php}

php php php php php php php php php php php php php php php php php php php php ifphp php(php(php$valuephp <php php-php1php)php orphp php(php$valuephp php>php php3php0php)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php"php'php$valuephp'php precisionphp hasphp tophp bephp betweenphp php-php1php andphp php3php0php.php"php)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php casephp php'scriptphp'php:
php php php php php php php php php php php php php php php php php php php php tryphp php{
php php php php php php php php php php php php php php php php php php php php php php php php Zendphp_Localephp_Formatphp:php:convertNumeralsphp(php0php,php php$optionsphp[php'scriptphp'php]php)php;
php php php php php php php php php php php php php php php php php php php php php}php catchphp php(Zendphp_Localephp_Exceptionphp php$ephp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Currencyphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Currencyphp_Exceptionphp(php$ephp-php>getMessagephp(php)php)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php defaultphp:
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$optionsphp;
php php php php php}
php}
