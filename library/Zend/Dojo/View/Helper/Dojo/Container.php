<php?php
php/php*php*
php php*php Zendphp Framework
php php*
php php*php LICENSE
php php*
php php*php Thisphp sourcephp filephp isphp subjectphp tophp thephp newphp BSDphp licensephp thatphp isphp bundled
php php*php withphp thisphp packagephp inphp thephp filephp LICENSEphp.txtphp.
php php*php Itphp isphp alsophp availablephp throughphp thephp worldphp-widephp-webphp atphp thisphp URLphp:
php php*php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsd
php php*php Ifphp youphp didphp notphp receivephp aphp copyphp ofphp thephp licensephp andphp arephp unablephp to
php php*php obtainphp itphp throughphp thephp worldphp-widephp-webphp,php pleasephp sendphp anphp email
php php*php tophp licensephp@zendphp.comphp sophp wephp canphp sendphp youphp aphp copyphp immediatelyphp.
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Dojo
php php*php php@subpackagephp View
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@versionphp php php php php$Idphp:php Containerphp.phpphp php2php3php4php8php4php php2php0php1php0php-php1php2php-php1php0php php0php3php:php5php7php:php5php9Zphp mjhphp_caphp php$
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php/

php/php*php*php Zendphp_Dojophp php*php/
requirephp_oncephp php'Zendphp/Dojophp.phpphp'php;

php/php*php*
php php*php Containerphp forphp php Dojophp Viewphp Helper
php php*
php php*
php php*php php@packagephp php php php Zendphp_Dojo
php php*php php@subpackagephp View
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php/
classphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php{
php php php php php/php*php*
php php php php php php*php php@varphp Zendphp_Viewphp_Interface
php php php php php php*php/
php php php php publicphp php$viewphp;

php php php php php/php*php*
php php php php php php*php addOnLoadphp capturephp lock
php php php php php php*php php@varphp bool
php php php php php php*php/
php php php php protectedphp php$php_captureLockphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php addOnLoadphp objectphp onphp whichphp tophp applyphp lambda
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_captureObjphp;

php php php php php/php*php*
php php php php php php*php Basephp CDNphp urlphp tophp utilize
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_cdnBasephp php=php Zendphp_Dojophp:php:CDNphp_BASEphp_GOOGLEphp;

php php php php php/php*php*
php php php php php php*php Pathphp segmentphp followingphp versionphp stringphp ofphp CDNphp path
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_cdnDojoPathphp php=php Zendphp_Dojophp:php:CDNphp_DOJOphp_PATHphp_GOOGLEphp;

php php php php php/php*php*
php php php php php php*php Dojophp versionphp tophp usephp fromphp CDN
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_cdnVersionphp php=php php'php1php.php5php.php0php'php;

php php php php php/php*php*
php php php php php php*php Hasphp thephp dijitphp loaderphp beenphp registeredphp?
php php php php php php*php php@varphp bool
php php php php php php*php/
php php php php protectedphp php$php_dijitLoaderRegisteredphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Registeredphp programmaticphp dijits
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_dijitsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Dojophp configuration
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_djConfigphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Whetherphp orphp notphp dojophp isphp enabled
php php php php php php*php php@varphp bool
php php php php php php*php/
php php php php protectedphp php$php_enabledphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Arephp wephp renderingphp asphp XHTMLphp?
php php php php php php*php php@varphp bool
php php php php php php*php/
php php php php protectedphp php$php_isXhtmlphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Arbitraryphp javascriptphp tophp includephp inphp dojophp script
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_javascriptStatementsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Dojophp layersphp php(customphp buildsphp)php tophp use
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_layersphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Relativephp pathphp tophp dojo
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_localPathphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Rootphp ofphp dojophp wherephp allphp dojophp filesphp arephp installed
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_localRelativePathphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Modulesphp tophp require
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_modulesphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Registeredphp modulephp paths
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_modulePathsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Actionsphp tophp performphp onphp windowphp load
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_onLoadActionsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Registerphp thephp Dojophp stylesheetphp?
php php php php php php*php php@varphp bool
php php php php php php*php/
php php php php protectedphp php$php_registerDojoStylesheetphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Stylephp sheetphp modulesphp tophp load
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_stylesheetModulesphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Localphp stylesheets
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_stylesheetsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Arrayphp ofphp onLoadphp eventsphp specificphp tophp Zendphp_Dojophp integrationphp operations
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_zendLoadActionsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Setphp viewphp object
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Dojophp_Viewphp_Interfacephp php$view
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp setViewphp(Zendphp_Viewphp_Interfacephp php$viewphp)
php php php php php{
php php php php php php php php php$thisphp-php>viewphp php=php php$viewphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Enablephp dojo
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp enablephp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_enabledphp php=php truephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Disablephp dojo
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp disablephp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_enabledphp php=php falsephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Isphp dojophp enabledphp?
php php php php php php*
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp isEnabledphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_enabledphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp optionsphp forphp thephp Dojophp Containerphp tophp use
php php php php php php*
php php php php php php*php php@paramphp arrayphp|Zendphp_Configphp Arrayphp orphp Zendphp_Configphp objectphp withphp optionsphp tophp use
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp setOptionsphp(php$optionsphp)
php php php php php{
php php php php php php php php ifphp(php$optionsphp instanceofphp Zendphp_Configphp)php php{
php php php php php php php php php php php php php$optionsphp php=php php$optionsphp-php>toArrayphp(php)php;
php php php php php php php php php}

php php php php php php php php foreachphp(php$optionsphp asphp php$keyphp php=php>php php$valuephp)php php{
php php php php php php php php php php php php php$keyphp php=php strtolowerphp(php$keyphp)php;
php php php php php php php php php php php php switchphp(php$keyphp)php php{
php php php php php php php php php php php php php php php php casephp php'requiremodulesphp'php:
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>requireModulephp(php$valuephp)php;
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'modulepathsphp'php:
php php php php php php php php php php php php php php php php php php php php foreachphp(php$valuephp asphp php$modulephp php=php>php php$pathphp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>registerModulePathphp(php$modulephp,php php$pathphp)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'layersphp'php:
php php php php php php php php php php php php php php php php php php php php php$valuephp php=php php(arrayphp)php php$valuephp;
php php php php php php php php php php php php php php php php php php php php foreachphp(php$valuephp asphp php$layerphp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addLayerphp(php$layerphp)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'cdnbasephp'php:
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>setCdnBasephp(php$valuephp)php;
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'cdnversionphp'php:
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>setCdnVersionphp(php$valuephp)php;
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'cdndojopathphp'php:
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>setCdnDojoPathphp(php$valuephp)php;
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'localpathphp'php:
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>setLocalPathphp(php$valuephp)php;
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'djconfigphp'php:
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>setDjConfigphp(php$valuephp)php;
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'stylesheetmodulesphp'php:
php php php php php php php php php php php php php php php php php php php php php$valuephp php=php php(arrayphp)php php$valuephp;
php php php php php php php php php php php php php php php php php php php php foreachphp(php$valuephp asphp php$modulephp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addStylesheetModulephp(php$modulephp)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'stylesheetsphp'php:
php php php php php php php php php php php php php php php php php php php php php$valuephp php=php php(arrayphp)php php$valuephp;
php php php php php php php php php php php php php php php php php php php php foreachphp(php$valuephp asphp php$stylesheetphp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addStylesheetphp(php$stylesheetphp)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'registerdojostylesheetphp'php:
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>registerDojoStylesheetphp(php$valuephp)php;
php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php casephp php'enablephp'php:
php php php php php php php php php php php php php php php php php php php php ifphp(php$valuephp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>enablephp(php)php;
php php php php php php php php php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>disablephp(php)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Specifyphp onephp orphp multiplephp modulesphp tophp require
php php php php php php*
php php php php php php*php php@paramphp php stringphp|arrayphp php$modules
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp requireModulephp(php$modulesphp)
php php php php php{
php php php php php php php php ifphp php(php!isphp_stringphp(php$modulesphp)php php&php&php php!isphp_arrayphp(php$modulesphp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Dojophp/Viewphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Dojophp_Viewphp_Exceptionphp(php'Invalidphp modulephp namephp specifiedphp;php mustphp bephp aphp stringphp orphp anphp arrayphp ofphp stringsphp'php)php;
php php php php php php php php php}

php php php php php php php php php$modulesphp php=php php(arrayphp)php php$modulesphp;

php php php php php php php php foreachphp php(php$modulesphp asphp php$modphp)php php{
php php php php php php php php php php php php ifphp php(php!pregphp_matchphp(php'php/php^php[aphp-zphp]php[aphp-zphp0php-php9php.php_php-php]php+php$php/iphp'php,php php$modphp)php)php php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Dojophp/Viewphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Dojophp_Viewphp_Exceptionphp(sprintfphp(php'Modulephp namephp specifiedphp,php php"php%sphp"php,php containsphp invalidphp charactersphp'php,php php(stringphp)php php$modphp)php)php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php ifphp php(php!inphp_arrayphp(php$modphp,php php$thisphp-php>php_modulesphp)php)php php{
php php php php php php php php php php php php php php php php php$thisphp-php>php_modulesphp[php]php php=php php$modphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp listphp ofphp modulesphp tophp require
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getModulesphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_modulesphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Registerphp aphp modulephp path
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$modulephp Thephp modulephp tophp registerphp aphp pathphp for
php php php php php php*php php@paramphp php stringphp php$pathphp Thephp pathphp tophp registerphp forphp thephp module
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp registerModulePathphp(php$modulephp,php php$pathphp)
php php php php php{
php php php php php php php php php$pathphp php=php php(stringphp)php php$pathphp;
php php php php php php php php ifphp php(php!inphp_arrayphp(php$modulephp,php php$thisphp-php>php_modulePathsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_modulePathsphp[php$modulephp]php php=php php$pathphp;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Listphp registeredphp modulephp paths
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getModulePathsphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_modulePathsphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp layerphp php(customphp buildphp)php path
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$path
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp addLayerphp(php$pathphp)
php php php php php{
php php php php php php php php php$pathphp php=php php(stringphp)php php$pathphp;
php php php php php php php php ifphp php(php!inphp_arrayphp(php$pathphp,php php$thisphp-php>php_layersphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_layersphp[php]php php=php php$pathphp;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp registeredphp layers
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getLayersphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_layersphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Removephp aphp registeredphp layer
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$path
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp removeLayerphp(php$pathphp)
php php php php php{
php php php php php php php php php$pathphp php=php php(stringphp)php php$pathphp;
php php php php php php php php php$layersphp php=php arrayphp_flipphp(php$thisphp-php>php_layersphp)php;
php php php php php php php php ifphp php(arrayphp_keyphp_existsphp(php$pathphp,php php$layersphp)php)php php{
php php php php php php php php php php php php unsetphp(php$layersphp[php$pathphp]php)php;
php php php php php php php php php php php php php$thisphp-php>php_layersphp php=php arrayphp_keysphp(php$layersphp)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Clearphp allphp registeredphp layers
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp clearLayersphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_layersphp php=php arrayphp(php)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp CDNphp basephp path
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$url
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp setCdnBasephp(php$urlphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_cdnBasephp php=php php(stringphp)php php$urlphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp CDNphp basephp URL
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getCdnBasephp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_cdnBasephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Usephp CDNphp,php usingphp versionphp specified
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$version
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp setCdnVersionphp(php$versionphp php=php nullphp)
php php php php php{
php php php php php php php php php$thisphp-php>enablephp(php)php;
php php php php php php php php ifphp php(pregphp_matchphp(php'php/php^php[php1php-php9php]php\php.php[php0php-php9php]php(php\php.php[php0php-php9php]php)php?php$php/php'php,php php$versionphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_cdnVersionphp php=php php$versionphp;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp CDNphp version
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getCdnVersionphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_cdnVersionphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp CDNphp pathphp tophp dojophp php(relativephp tophp CDNphp basephp php+php versionphp)
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$path
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp setCdnDojoPathphp(php$pathphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_cdnDojoPathphp php=php php(stringphp)php php$pathphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp CDNphp pathphp tophp dojophp php(relativephp tophp CDNphp basephp php+php versionphp)
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getCdnDojoPathphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_cdnDojoPathphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Arephp wephp usingphp thephp CDNphp?
php php php php php php*
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp useCdnphp(php)
php php php php php{
php php php php php php php php returnphp php!php$thisphp-php>useLocalPathphp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp pathphp tophp localphp dojo
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$path
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp setLocalPathphp(php$pathphp)
php php php php php{
php php php php php php php php php$thisphp-php>enablephp(php)php;
php php php php php php php php php$thisphp-php>php_localPathphp php=php php(stringphp)php php$pathphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp localphp pathphp tophp dojo
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getLocalPathphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_localPathphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Arephp wephp usingphp aphp localphp pathphp?
php php php php php php*
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp useLocalPathphp(php)
php php php php php{
php php php php php php php php returnphp php(nullphp php=php=php=php php$thisphp-php>php_localPathphp)php php?php falsephp php:php truephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp Dojophp configuration
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$option
php php php php php php*php php@paramphp php mixedphp php$value
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp setDjConfigphp(arrayphp php$configphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_djConfigphp php=php php$configphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp Dojophp configurationphp option
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$option
php php php php php php*php php@paramphp php mixedphp php$value
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp setDjConfigOptionphp(php$optionphp,php php$valuephp)
php php php php php{
php php php php php php php php php$optionphp php=php php(stringphp)php php$optionphp;
php php php php php php php php php$thisphp-php>php_djConfigphp[php$optionphp]php php=php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp dojophp configurationphp values
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getDjConfigphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_djConfigphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp dojophp configurationphp value
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$option
php php php php php php*php php@paramphp php mixedphp php$default
php php php php php php*php php@returnphp mixed
php php php php php php*php/
php php php php publicphp functionphp getDjConfigOptionphp(php$optionphp,php php$defaultphp php=php nullphp)
php php php php php{
php php php php php php php php php$optionphp php=php php(stringphp)php php$optionphp;
php php php php php php php php ifphp php(arrayphp_keyphp_existsphp(php$optionphp,php php$thisphp-php>php_djConfigphp)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_djConfigphp[php$optionphp]php;
php php php php php php php php php}
php php php php php php php php returnphp php$defaultphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp aphp stylesheetphp byphp modulephp name
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$module
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp addStylesheetModulephp(php$modulephp)
php php php php php{
php php php php php php php php ifphp php(php!pregphp_matchphp(php'php/php^php[aphp-zphp0php-php9php]php+php\php.php[aphp-zphp0php-php9php_php-php]php+php(php\php.php[aphp-zphp0php-php9php_php-php]php+php)php*php$php/iphp'php,php php$modulephp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Dojophp/Viewphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Dojophp_Viewphp_Exceptionphp(php'Invalidphp stylesheetphp modulephp specifiedphp'php)php;
php php php php php php php php php}
php php php php php php php php ifphp php(php!inphp_arrayphp(php$modulephp,php php$thisphp-php>php_stylesheetModulesphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_stylesheetModulesphp[php]php php=php php$modulephp;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp allphp stylesheetphp modulesphp currentlyphp registered
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getStylesheetModulesphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_stylesheetModulesphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp aphp stylesheet
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$path
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp addStylesheetphp(php$pathphp)
php php php php php{
php php php php php php php php php$pathphp php=php php(stringphp)php php$pathphp;
php php php php php php php php ifphp php(php!inphp_arrayphp(php$pathphp,php php$thisphp-php>php_stylesheetsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_stylesheetsphp[php]php php=php php(stringphp)php php$pathphp;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Registerphp thephp dojophp.cssphp stylesheetphp?
php php php php php php*
php php php php php php*php Withphp nophp argumentsphp,php returnsphp thephp statusphp ofphp thephp flagphp;php withphp argumentsphp,php sets
php php php php php php*php thephp flagphp andphp returnsphp thephp objectphp.
php php php php php php*
php php php php php php*php php@paramphp php nullphp|boolphp php$flag
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Containerphp|bool
php php php php php php*php/
php php php php publicphp functionphp registerDojoStylesheetphp(php$flagphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(nullphp php=php=php=php php$flagphp)php php{
php php php php php php php php php php php php php returnphp php$thisphp-php>php_registerDojoStylesheetphp;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_registerDojoStylesheetphp php=php php(boolphp)php php$flagphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp registeredphp stylesheets
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getStylesheetsphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_stylesheetsphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp aphp scriptphp tophp executephp onLoad
php php php php php php*
php php php php php php*php dojophp.addOnLoadphp acceptsphp:
php php php php php php*php php-php functionphp name
php php php php php php*php php-php lambda
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$callbackphp Lambda
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp addOnLoadphp(php$callbackphp)
php php php php php{
php php php php php php php php ifphp php(php!inphp_arrayphp(php$callbackphp,php php$thisphp-php>php_onLoadActionsphp,php truephp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_onLoadActionsphp[php]php php=php php$callbackphp;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Prependphp anphp onLoadphp eventphp tophp thephp listphp ofphp onLoadphp actions
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$callbackphp Lambda
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp prependOnLoadphp(php$callbackphp)
php php php php php{
php php php php php php php php ifphp php(php!inphp_arrayphp(php$callbackphp,php php$thisphp-php>php_onLoadActionsphp,php truephp)php)php php{
php php php php php php php php php php php php arrayphp_unshiftphp(php$thisphp-php>php_onLoadActionsphp,php php$callbackphp)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp allphp registeredphp onLoadphp actions
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getOnLoadActionsphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_onLoadActionsphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Startphp capturingphp routinesphp tophp runphp onLoad
php php php php php php*
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp onLoadCaptureStartphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_captureLockphp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Dojophp/Viewphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Dojophp_Viewphp_Exceptionphp(php'Cannotphp nestphp onLoadphp capturesphp'php)php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_captureLockphp php=php truephp;
php php php php php php php php obphp_startphp(php)php;
php php php php php php php php returnphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Stopphp capturingphp routinesphp tophp runphp onLoad
php php php php php php*
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp onLoadCaptureEndphp(php)
php php php php php{
php php php php php php php php php$dataphp php php php php php php php php php php php php php php php=php obphp_getphp_cleanphp(php)php;
php php php php php php php php php$thisphp-php>php_captureLockphp php=php falsephp;

php php php php php php php php php$thisphp-php>addOnLoadphp(php$dataphp)php;
php php php php php php php php returnphp truephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp aphp programmaticphp dijit
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$id
php php php php php php*php php@paramphp php arrayphp php$params
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp addDijitphp(php$idphp,php arrayphp php$paramsphp)
php php php php php{
php php php php php php php php ifphp php(arrayphp_keyphp_existsphp(php$idphp,php php$thisphp-php>php_dijitsphp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Dojophp/Viewphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Dojophp_Viewphp_Exceptionphp(sprintfphp(php'Duplicatephp dijitphp withphp idphp php"php%sphp"php alreadyphp registeredphp'php,php php$idphp)php)php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_dijitsphp[php$idphp]php php=php arrayphp(
php php php php php php php php php php php php php'idphp'php php php php php php=php>php php$idphp,
php php php php php php php php php php php php php'paramsphp'php php=php>php php$paramsphp,
php php php php php php php php php)php;

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp aphp programmaticphp dijitphp php(overwritesphp)
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$id
php php php php php php*php php@paramphp php arrayphp php$params
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp setDijitphp(php$idphp,php arrayphp php$paramsphp)
php php php php php{
php php php php php php php php php$thisphp-php>removeDijitphp(php$idphp)php;
php php php php php php php php returnphp php$thisphp-php>addDijitphp(php$idphp,php php$paramsphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp multiplephp dijitsphp atphp once
php php php php php php*
php php php php php php*php Expectsphp anphp arrayphp ofphp idphp php=php>php arrayphp php$paramsphp pairs
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$dijits
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp addDijitsphp(arrayphp php$dijitsphp)
php php php php php{
php php php php php php php php foreachphp php(php$dijitsphp asphp php$idphp php=php>php php$paramsphp)php php{
php php php php php php php php php php php php php$thisphp-php>addDijitphp(php$idphp,php php$paramsphp)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp multiplephp dijitsphp atphp oncephp php(overwritesphp)
php php php php php php*
php php php php php php*php Expectsphp anphp arrayphp ofphp idphp php=php>php arrayphp php$paramsphp pairs
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$dijits
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp setDijitsphp(arrayphp php$dijitsphp)
php php php php php{
php php php php php php php php php$thisphp-php>clearDijitsphp(php)php;
php php php php php php php php returnphp php$thisphp-php>addDijitsphp(php$dijitsphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Isphp thephp givenphp programmaticphp dijitphp alreadyphp registeredphp?
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$id
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp hasDijitphp(php$idphp)
php php php php php{
php php php php php php php php returnphp arrayphp_keyphp_existsphp(php$idphp,php php$thisphp-php>php_dijitsphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp aphp dijitphp byphp id
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$id
php php php php php php*php php@returnphp arrayphp|null
php php php php php php*php/
php php php php publicphp functionphp getDijitphp(php$idphp)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>hasDijitphp(php$idphp)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_dijitsphp[php$idphp]php[php'paramsphp'php]php;
php php php php php php php php php}
php php php php php php php php returnphp nullphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp allphp dijits
php php php php php php*
php php php php php php*php Returnsphp dijitsphp asphp anphp arrayphp ofphp assocphp arrays
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getDijitsphp(php)
php php php php php{
php php php php php php php php returnphp arrayphp_valuesphp(php$thisphp-php>php_dijitsphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Removephp aphp programmaticphp dijitphp ifphp itphp exists
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$id
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp removeDijitphp(php$idphp)
php php php php php{
php php php php php php php php ifphp php(arrayphp_keyphp_existsphp(php$idphp,php php$thisphp-php>php_dijitsphp)php)php php{
php php php php php php php php php php php php unsetphp(php$thisphp-php>php_dijitsphp[php$idphp]php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Clearphp allphp dijits
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp clearDijitsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_dijitsphp php=php arrayphp(php)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Renderphp dijitsphp asphp JSONphp structure
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp dijitsToJsonphp(php)
php php php php php{
php php php php php php php php requirephp_oncephp php'Zendphp/Jsonphp.phpphp'php;
php php php php php php php php returnphp Zendphp_Jsonphp:php:encodephp(php$thisphp-php>getDijitsphp(php)php,php falsephp,php arrayphp(php'enableJsonExprFinderphp'php php=php>php truephp)php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Createphp dijitphp loaderphp functionality
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp registerDijitLoaderphp(php)
php php php php php{
php php php php php php php php ifphp php(php!php$thisphp-php>php_dijitLoaderRegisteredphp)php php{
php php php php php php php php php php php php php$jsphp php=<php<php<EOJ
functionphp(php)php php{
php php php php dojophp.forEachphp(zendDijitsphp,php functionphp(infophp)php php{
php php php php php php php php varphp nphp php=php dojophp.byIdphp(infophp.idphp)php;
php php php php php php php php ifphp php(nullphp php!php=php nphp)php php{
php php php php php php php php php php php php dojophp.attrphp(nphp,php dojophp.mixinphp(php{php idphp:php infophp.idphp php}php,php infophp.paramsphp)php)php;
php php php php php php php php php}
php php php php php}php)php;
php php php php dojophp.parserphp.parsephp(php)php;
php}
EOJphp;
php php php php php php php php php php php php php$thisphp-php>requireModulephp(php'dojophp.parserphp'php)php;
php php php php php php php php php php php php php$thisphp-php>php_addZendLoadphp(php$jsphp)php;
php php php php php php php php php php php php php$thisphp-php>addJavascriptphp(php'varphp zendDijitsphp php=php php'php php.php php$thisphp-php>dijitsToJsonphp(php)php php.php php'php;php'php)php;
php php php php php php php php php php php php php$thisphp-php>php_dijitLoaderRegisteredphp php=php truephp;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp arbitraryphp javascriptphp tophp executephp inphp dojophp JSphp container
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$js
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp addJavascriptphp(php$jsphp)
php php php php php{
php php php php php php php php php$jsphp php=php pregphp_replacephp(php'php/php^php\sphp*php(php.php*php?php)php\sphp*php$php/sphp'php,php php'php$php1php'php,php php$jsphp)php;
php php php php php php php php ifphp php(php!inphp_arrayphp(substrphp(php$jsphp,php php-php1php)php,php arrayphp(php'php;php'php,php php'php}php'php)php)php)php php{
php php php php php php php php php php php php php$jsphp php.php=php php'php;php'php;
php php php php php php php php php}

php php php php php php php php ifphp php(inphp_arrayphp(php$jsphp,php php$thisphp-php>php_javascriptStatementsphp)php)php php{
php php php php php php php php php php php php returnphp php$thisphp;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_javascriptStatementsphp[php]php php=php php$jsphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp allphp registeredphp javascriptphp statements
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getJavascriptphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_javascriptStatementsphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Clearphp arbitraryphp javascriptphp stack
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp clearJavascriptphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_javascriptStatementsphp php=php arrayphp(php)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Capturephp arbitraryphp javascriptphp tophp includephp inphp dojophp script
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp javascriptCaptureStartphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_captureLockphp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Dojophp/Viewphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Dojophp_Viewphp_Exceptionphp(php'Cannotphp nestphp capturesphp'php)php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_captureLockphp php=php truephp;
php php php php php php php php obphp_startphp(php)php;
php php php php php php php php returnphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Finishphp capturingphp arbitraryphp javascriptphp tophp includephp inphp dojophp script
php php php php php php*
php php php php php php*php php@returnphp true
php php php php php php*php/
php php php php publicphp functionphp javascriptCaptureEndphp(php)
php php php php php{
php php php php php php php php php$dataphp php php php php php php php php php php php php php php php=php obphp_getphp_cleanphp(php)php;
php php php php php php php php php$thisphp-php>php_captureLockphp php=php falsephp;

php php php php php php php php php$thisphp-php>addJavascriptphp(php$dataphp)php;
php php php php php php php php returnphp truephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Stringphp representationphp ofphp dojophp environment
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp php_php_toStringphp(php)
php php php php php{
php php php php php php php php ifphp php(php!php$thisphp-php>isEnabledphp(php)php)php php{
php php php php php php php php php php php php returnphp php'php'php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_isXhtmlphp php=php php$thisphp-php>viewphp-php>doctypephp(php)php-php>isXhtmlphp(php)php;

php php php php php php php php ifphp php(Zendphp_Dojophp_Viewphp_Helperphp_Dojophp:php:useDeclarativephp(php)php)php php{
php php php php php php php php php php php php ifphp php(nullphp php=php=php=php php$thisphp-php>getDjConfigOptionphp(php'parseOnLoadphp'php)php)php php{
php php php php php php php php php php php php php php php php php$thisphp-php>setDjConfigOptionphp(php'parseOnLoadphp'php,php truephp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php ifphp php(php!emptyphp(php$thisphp-php>php_dijitsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>registerDijitLoaderphp(php)php;
php php php php php php php php php}

php php php php php php php php php$htmlphp php php=php php$thisphp-php>php_renderStylesheetsphp(php)php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php.php php$thisphp-php>php_renderDjConfigphp(php)php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php.php php$thisphp-php>php_renderDojoScriptTagphp(php)php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php.php php$thisphp-php>php_renderLayersphp(php)php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php.php php$thisphp-php>php_renderExtrasphp(php)php;
php php php php php php php php returnphp php$htmlphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp localphp pathphp tophp dojophp resourcesphp forphp buildingphp relativephp paths
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php protectedphp functionphp php_getLocalRelativePathphp(php)
php php php php php{
php php php php php php php php ifphp php(nullphp php=php=php=php php$thisphp-php>php_localRelativePathphp)php php{
php php php php php php php php php php php php php$localPathphp php=php php$thisphp-php>getLocalPathphp(php)php;
php php php php php php php php php php php php php$localPathphp php=php pregphp_replacephp(php'php|php[php/php\php\php\php\php]dojophp[php/php\php\php\php\php]dojophp.jsphp[php^php/php\php\php\php\php]php*php$php|iphp'php,php php'php'php,php php$localPathphp)php;
php php php php php php php php php php php php php$thisphp-php>php_localRelativePathphp php=php php$localPathphp;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp-php>php_localRelativePathphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Renderphp dojophp stylesheets
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php protectedphp functionphp php_renderStylesheetsphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>useCdnphp(php)php)php php{
php php php php php php php php php php php php php$basephp php=php php$thisphp-php>getCdnBasephp(php)
php php php php php php php php php php php php php php php php php php php.php php$thisphp-php>getCdnVersionphp(php)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php$basephp php=php php$thisphp-php>php_getLocalRelativePathphp(php)php;
php php php php php php php php php}

php php php php php php php php php$registeredStylesheetsphp php=php php$thisphp-php>getStylesheetModulesphp(php)php;
php php php php php php php php foreachphp php(php$registeredStylesheetsphp asphp php$stylesheetphp)php php{
php php php php php php php php php php php php php$themeNamephp php php php php php=php substrphp(php$stylesheetphp,php strrposphp(php$stylesheetphp,php php'php.php'php)php php+php php1php)php;
php php php php php php php php php php php php php$stylesheetphp php php php php=php strphp_replacephp(php'php.php'php,php php'php/php'php,php php$stylesheetphp)php;
php php php php php php php php php php php php php$stylesheetsphp[php]php php=php php$basephp php.php php'php/php'php php.php php$stylesheetphp php.php php'php/php'php php.php php$themeNamephp php.php php'php.cssphp'php;
php php php php php php php php php}

php php php php php php php php foreachphp php(php$thisphp-php>getStylesheetsphp(php)php asphp php$stylesheetphp)php php{
php php php php php php php php php php php php php$stylesheetsphp[php]php php=php php$stylesheetphp;
php php php php php php php php php}

php php php php php php php php ifphp php(php$thisphp-php>php_registerDojoStylesheetphp)php php{
php php php php php php php php php php php php php$stylesheetsphp[php]php php=php php$basephp php.php php'php/dojophp/resourcesphp/dojophp.cssphp'php;
php php php php php php php php php}

php php php php php php php php ifphp php(emptyphp(php$stylesheetsphp)php)php php{
php php php php php php php php php php php php returnphp php'php'php;
php php php php php php php php php}

php php php php php php php php arrayphp_reversephp(php$stylesheetsphp)php;
php php php php php php php php php$stylephp php=php php'php<stylephp typephp=php"textphp/cssphp"php>php'php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php.php php(php(php$thisphp-php>php_isXhtmlphp)php php?php php'<php!php-php-php'php php:php php'<php!php-php-php'php)php php.php PHPphp_EOLphp;
php php php php php php php php foreachphp php(php$stylesheetsphp asphp php$stylesheetphp)php php{
php php php php php php php php php php php php php$stylephp php.php=php php'php php php php php@importphp php"php'php php.php php$stylesheetphp php.php php'php"php;php'php php.php PHPphp_EOLphp;
php php php php php php php php php}
php php php php php php php php php$stylephp php.php=php php(php(php$thisphp-php>php_isXhtmlphp)php php?php php'php-php-php>php'php php:php php'php-php-php>php'php)php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php php.php php'<php/stylephp>php'php;

php php php php php php php php returnphp php$stylephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Renderphp DjConfigphp values
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php protectedphp functionphp php_renderDjConfigphp(php)
php php php php php{
php php php php php php php php php$djConfigValuesphp php=php php$thisphp-php>getDjConfigphp(php)php;
php php php php php php php php ifphp php(emptyphp(php$djConfigValuesphp)php)php php{
php php php php php php php php php php php php returnphp php'php'php;
php php php php php php php php php}

php php php php php php php php requirephp_oncephp php'Zendphp/Jsonphp.phpphp'php;
php php php php php php php php php$scriptTagphp php=php php'php<scriptphp typephp=php"textphp/javascriptphp"php>php'php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php php php php php.php php(php(php$thisphp-php>php_isXhtmlphp)php php?php php'php/php/<php!php[CDATAphp[php'php php:php php'php/php/<php!php-php-php'php)php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php php php php php.php php'php php php php varphp djConfigphp php=php php'php php.php Zendphp_Jsonphp:php:encodephp(php$djConfigValuesphp)php php.php php'php;php'php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php php php php php.php php(php(php$thisphp-php>php_isXhtmlphp)php php?php php'php/php/php]php]php>php'php php:php php'php/php/php-php-php>php'php)php php.php PHPphp_EOL
php php php php php php php php php php php php php php php php php php php php.php php'<php/scriptphp>php'php;

php php php php php php php php returnphp php$scriptTagphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Renderphp dojophp scriptphp tag
php php php php php php*
php php php php php php*php Rendersphp Dojophp scriptphp tagphp byphp utilizingphp eitherphp localphp pathphp providedphp orphp the
php php php php php php*php CDNphp.php Ifphp anyphp djConfigphp valuesphp werephp setphp,php theyphp willphp bephp serializedphp andphp passed
php php php php php php*php withphp thatphp attributephp.
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php protectedphp functionphp php_renderDojoScriptTagphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>useCdnphp(php)php)php php{
php php php php php php php php php php php php php$sourcephp php=php php$thisphp-php>getCdnBasephp(php)
php php php php php php php php php php php php php php php php php php php php php.php php$thisphp-php>getCdnVersionphp(php)
php php php php php php php php php php php php php php php php php php php php php.php php$thisphp-php>getCdnDojoPathphp(php)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php$sourcephp php=php php$thisphp-php>getLocalPathphp(php)php;
php php php php php php php php php}

php php php php php php php php php$scriptTagphp php=php php'php<scriptphp typephp=php"textphp/javascriptphp"php srcphp=php"php'php php.php php$sourcephp php.php php'php"php><php/scriptphp>php'php;
php php php php php php php php returnphp php$scriptTagphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Renderphp layersphp php(customphp buildsphp)php asphp scriptphp tags
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php protectedphp functionphp php_renderLayersphp(php)
php php php php php{
php php php php php php php php php$layersphp php=php php$thisphp-php>getLayersphp(php)php;
php php php php php php php php ifphp php(emptyphp(php$layersphp)php)php php{
php php php php php php php php php php php php returnphp php'php'php;
php php php php php php php php php}

php php php php php php php php php$encphp php=php php'UTFphp-php8php'php;
php php php php php php php php ifphp php(php$thisphp-php>viewphp instanceofphp Zendphp_Viewphp_Interface
php php php php php php php php php php php php php&php&php methodphp_existsphp(php$thisphp-php>viewphp,php php'getEncodingphp'php)
php php php php php php php php php)php php{
php php php php php php php php php php php php php$encphp php=php php$thisphp-php>viewphp-php>getEncodingphp(php)php;
php php php php php php php php php}

php php php php php php php php php$htmlphp php=php arrayphp(php)php;
php php php php php php php php foreachphp php(php$layersphp asphp php$pathphp)php php{
php php php php php php php php php php php php php$htmlphp[php]php php=php sprintfphp(
php php php php php php php php php php php php php php php php php'php<scriptphp typephp=php"textphp/javascriptphp"php srcphp=php"php%sphp"php><php/scriptphp>php'php,
php php php php php php php php php php php php php php php php htmlspecialcharsphp(php$pathphp,php ENTphp_QUOTESphp,php php$encphp)
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp implodephp(php"php\nphp"php,php php$htmlphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Renderphp dojophp modulephp pathsphp andphp requires
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php protectedphp functionphp php_renderExtrasphp(php)
php php php php php{
php php php php php php php php php$jsphp php=php arrayphp(php)php;
php php php php php php php php php$modulePathsphp php=php php$thisphp-php>getModulePathsphp(php)php;
php php php php php php php php ifphp php(php!emptyphp(php$modulePathsphp)php)php php{
php php php php php php php php php php php php foreachphp php(php$modulePathsphp asphp php$modulephp php=php>php php$pathphp)php php{
php php php php php php php php php php php php php php php php php$jsphp[php]php php=php php php'dojophp.registerModulePathphp(php"php'php php.php php$thisphp-php>viewphp-php>escapephp(php$modulephp)php php.php php'php"php,php php"php'php php.php php$thisphp-php>viewphp-php>escapephp(php$pathphp)php php.php php'php"php)php;php'php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php php$modulesphp php=php php$thisphp-php>getModulesphp(php)php;
php php php php php php php php ifphp php(php!emptyphp(php$modulesphp)php)php php{
php php php php php php php php php php php php foreachphp php(php$modulesphp asphp php$modulephp)php php{
php php php php php php php php php php php php php php php php php$jsphp[php]php php=php php'dojophp.requirephp(php"php'php php.php php$thisphp-php>viewphp-php>escapephp(php$modulephp)php php.php php'php"php)php;php'php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php php$onLoadActionsphp php=php arrayphp(php)php;
php php php php php php php php php/php/php Getphp Zendphp specificphp onLoadphp actionsphp;php thesephp willphp alwaysphp bephp firstphp to
php php php php php php php php php/php/php ensurephp thatphp dijitsphp arephp createdphp inphp thephp correctphp order
php php php php php php php php foreachphp php(php$thisphp-php>php_getZendLoadActionsphp(php)php asphp php$callbackphp)php php{
php php php php php php php php php php php php php$onLoadActionsphp[php]php php=php php'dojophp.addOnLoadphp(php'php php.php php$callbackphp php.php php'php)php;php'php;
php php php php php php php php php}

php php php php php php php php php/php/php Getphp allphp otherphp onLoadphp actions
php php php php php php php php foreachphp php(php$thisphp-php>getOnLoadActionsphp(php)php asphp php$callbackphp)php php{
php php php php php php php php php php php php php$onLoadActionsphp[php]php php=php php'dojophp.addOnLoadphp(php'php php.php php$callbackphp php.php php'php)php;php'php;
php php php php php php php php php}

php php php php php php php php php$javascriptphp php=php implodephp(php"php\nphp php php php php"php,php php$thisphp-php>getJavascriptphp(php)php)php;

php php php php php php php php php$contentphp php=php php'php'php;
php php php php php php php php ifphp php(php!emptyphp(php$jsphp)php)php php{
php php php php php php php php php php php php php$contentphp php.php=php implodephp(php"php\nphp php php php php"php,php php$jsphp)php php.php php"php\nphp"php;
php php php php php php php php php}

php php php php php php php php ifphp php(php!emptyphp(php$onLoadActionsphp)php)php php{
php php php php php php php php php php php php php$contentphp php.php=php implodephp(php"php\nphp php php php php"php,php php$onLoadActionsphp)php php.php php"php\nphp"php;
php php php php php php php php php}

php php php php php php php php ifphp php(php!emptyphp(php$javascriptphp)php)php php{
php php php php php php php php php php php php php$contentphp php.php=php php$javascriptphp php.php php"php\nphp"php;
php php php php php php php php php}

php php php php php php php php ifphp php(pregphp_matchphp(php'php/php^php\sphp*php$php/sphp'php,php php$contentphp)php)php php{
php php php php php php php php php php php php returnphp php'php'php;
php php php php php php php php php}

php php php php php php php php php$htmlphp php=php php'php<scriptphp typephp=php"textphp/javascriptphp"php>php'php php.php PHPphp_EOL
php php php php php php php php php php php php php php php.php php(php(php$thisphp-php>php_isXhtmlphp)php php?php php'php/php/<php!php[CDATAphp[php'php php:php php'php/php/<php!php-php-php'php)php php.php PHPphp_EOL
php php php php php php php php php php php php php php php.php php$content
php php php php php php php php php php php php php php php.php php(php(php$thisphp-php>php_isXhtmlphp)php php?php php'php/php/php]php]php>php'php php:php php'php/php/php-php-php>php'php)php php.php PHPphp_EOL
php php php php php php php php php php php php php php php.php PHPphp_EOLphp php.php php'<php/scriptphp>php'php;
php php php php php php php php returnphp php$htmlphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp anphp onLoadphp actionphp relatedphp tophp ZFphp dijitphp creation
php php php php php php*
php php php php php php*php Thisphp methodphp isphp publicphp,php butphp prefixedphp withphp anphp underscorephp tophp indicatephp that
php php php php php php*php itphp shouldphp notphp normallyphp bephp calledphp byphp userlandphp codephp.php Itphp isphp pertinentphp to
php php php php php php*php ensuringphp thatphp thephp correctphp orderphp ofphp operationsphp occursphp duringphp dijit
php php php php php php*php creationphp.
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$callback
php php php php php php*php php@returnphp Zendphp_Dojophp_Viewphp_Helperphp_Dojophp_Container
php php php php php php*php/
php php php php publicphp functionphp php_addZendLoadphp(php$callbackphp)
php php php php php{
php php php php php php php php ifphp php(php!inphp_arrayphp(php$callbackphp,php php$thisphp-php>php_zendLoadActionsphp,php truephp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_zendLoadActionsphp[php]php php=php php$callbackphp;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp allphp ZFphp dijitphp callbacks
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp php_getZendLoadActionsphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_zendLoadActionsphp;
php php php php php}
php}
