<php?php
php/php*php*
php php*php Zendphp Framework
php php*
php php*php LICENSE
php php*
php php*php Thisphp sourcephp filephp isphp subjectphp tophp thephp newphp BSDphp licensephp thatphp isphp bundled
php php*php withphp thisphp packagephp inphp thephp filephp LICENSEphp.txtphp.
php php*php Itphp isphp alsophp availablephp throughphp thephp worldphp-widephp-webphp atphp thisphp URLphp:
php php*php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsd
php php*php Ifphp youphp didphp notphp receivephp aphp copyphp ofphp thephp licensephp andphp arephp unablephp to
php php*php obtainphp itphp throughphp thephp worldphp-widephp-webphp,php pleasephp sendphp anphp email
php php*php tophp licensephp@zendphp.comphp sophp wephp canphp sendphp youphp aphp copyphp immediatelyphp.
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Barcode
php php*php php@subpackagephp Object
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@versionphp php php php php$Idphp:php ObjectAbstractphp.phpphp php2php3php4php0php0php php2php0php1php0php-php1php1php-php1php9php php1php7php:php1php8php:php3php1Zphp mikaelkaelphp php$
php php*php/

php/php*php*
php php*php Classphp forphp generatephp Barcode
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Barcode
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php/
abstractphp classphp Zendphp_Barcodephp_Objectphp_ObjectAbstract
php{
php php php php php/php*php*
php php php php php php*php Namespacephp ofphp thephp barcodephp forphp autoloading
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_barcodeNamespacephp php=php php'Zendphp_Barcodephp_Objectphp'php;

php php php php php/php*php*
php php php php php php*php Setphp ofphp drawingphp instructions
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_instructionsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Barcodephp type
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_typephp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Heightphp ofphp thephp object
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_heightphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Widthphp ofphp thephp object
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_widthphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Heightphp ofphp thephp bar
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_barHeightphp php=php php5php0php;

php php php php php/php*php*
php php php php php php*php Widthphp ofphp aphp thinphp bar
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_barThinWidthphp php=php php1php;

php php php php php/php*php*
php php php php php php*php Widthphp ofphp aphp thickphp bar
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_barThickWidthphp php=php php3php;

php php php php php/php*php*
php php php php php php*php Factorphp tophp multiplyphp barphp andphp fontphp measure
php php php php php php*php php(barHeightphp,php barThinWidthphp,php barThickWidthphp php&php fontSizephp)
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_factorphp php=php php1php;

php php php php php/php*php*
php php php php php php*php Fontphp andphp barsphp colorphp ofphp thephp object
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_foreColorphp php=php php0xphp0php0php0php0php0php0php;

php php php php php/php*php*
php php php php php php*php Backgroundphp colorphp ofphp thephp object
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_backgroundColorphp php=php php0xFFFFFFphp;

php php php php php/php*php*
php php php php php php*php Activatephp/deactivatephp borderphp ofphp thephp object
php php php php php php*php php@varphp boolean
php php php php php php*php/
php php php php protectedphp php$php_withBorderphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Activatephp/deactivatephp drawingphp ofphp quietphp zones
php php php php php php*php php@varphp boolean
php php php php php php*php/
php php php php protectedphp php$php_withQuietZonesphp php=php truephp;

php php php php php/php*php*
php php php php php php*php Forcephp quietphp zonesphp evenphp if
php php php php php php*php php@varphp boolean
php php php php php php*php/
php php php php protectedphp php$php_mandatoryQuietZonesphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Orientationphp ofphp thephp barcodephp inphp degrees
php php php php php php*php php@varphp float
php php php php php php*php/
php php php php protectedphp php$php_orientationphp php=php php0php;

php php php php php/php*php*
php php php php php php*php Offsetphp fromphp thephp topphp thephp object
php php php php php php*php php(calculatedphp fromphp thephp orientationphp)
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_offsetTopphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Offsetphp fromphp thephp leftphp thephp object
php php php php php php*php php(calculatedphp fromphp thephp orientationphp)
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php protectedphp php$php_offsetLeftphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Textphp tophp display
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_textphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Displayphp php(orphp notphp)php humanphp readablephp text
php php php php php php*php php@varphp boolean
php php php php php php*php/
php php php php protectedphp php$php_drawTextphp php=php truephp;

php php php php php/php*php*
php php php php php php*php Adjustphp php(orphp notphp)php positionphp ofphp humanphp readablephp charactersphp withphp barcode
php php php php php php*php php@varphp boolean
php php php php php php*php/
php php php php protectedphp php$php_stretchTextphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Fontphp resource
php php php php php php*php php php-php integerphp php(php1php tophp php5php)php:php correspondsphp tophp GDphp includedphp fonts
php php php php php php*php php php-php stringphp:php correspondsphp tophp pathphp ofphp aphp TTFphp font
php php php php php php*php php@varphp integerphp|string
php php php php php php*php/
php php php php protectedphp php$php_fontphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Fontphp size
php php php php php php*php php@varphp float
php php php php php php*php/
php php php php protectedphp php$php_fontSizephp php=php php1php0php;

php php php php php/php*php*
php php php php php php*php Drawingphp ofphp checksum
php php php php php php*php php@varphp boolean
php php php php php php*php/
php php php php protectedphp php$php_withChecksumphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Drawingphp ofphp checksumphp insidephp text
php php php php php php*php php@varphp boolean
php php php php php php*php/
php php php php protectedphp php$php_withChecksumInTextphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Fixphp barcodephp lengthphp php(numericphp orphp stringphp likephp php'evenphp'php)
php php php php php php*php php@varphp php$php_barcodeLengthphp integerphp php|php string
php php php php php php*php/
php php php php protectedphp php$php_barcodeLengthphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Activatephp automaticphp additionphp ofphp leadingphp zeros
php php php php php php*php ifphp barcodephp lengthphp isphp fixed
php php php php php php*php php@varphp php$php_addLeadingZerosphp boolean
php php php php php php*php/
php php php php protectedphp php$php_addLeadingZerosphp php=php truephp;

php php php php php/php*php*
php php php php php php*php Activationphp ofphp mandatoryphp checksum
php php php php php php*php tophp deactivatephp unauthorizedphp modification
php php php php php php*php php@varphp php$php_mandatoryChecksumphp boolean
php php php php php php*php/
php php php php protectedphp php$php_mandatoryChecksumphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Characterphp usedphp tophp substitutephp checksumphp characterphp forphp validation
php php php php php php*php php@varphp php$php_substituteChecksumCharacterphp mixed
php php php php php php*php/
php php php php protectedphp php$php_substituteChecksumCharacterphp php=php php0php;

php php php php php/php*php*
php php php php php php*php TTFphp fontphp namephp:php canphp bephp setphp beforephp instanciationphp ofphp thephp object
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp staticphp php$php_staticFontphp php=php nullphp;

php php php php php/php*php*
php php php php php php*php Constructor
php php php php php php*php php@paramphp arrayphp|Zendphp_Configphp php$options
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp php_php_constructphp(php$optionsphp php=php nullphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_getDefaultOptionsphp(php)php;
php php php php php php php php ifphp php(selfphp:php:php$php_staticFontphp php!php=php=php nullphp)php php{
php php php php php php php php php php php php php$thisphp-php>php_fontphp php=php selfphp:php:php$php_staticFontphp;
php php php php php php php php php}
php php php php php php php php ifphp php(php$optionsphp instanceofphp Zendphp_Configphp)php php{
php php php php php php php php php php php php php$optionsphp php=php php$optionsphp-php>toArrayphp(php)php;
php php php php php php php php php}
php php php php php php php php ifphp php(isphp_arrayphp(php$optionsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>setOptionsphp(php$optionsphp)php;
php php php php php php php php php}
php php php php php php php php php$thisphp-php>php_typephp php=php strtolowerphp(substrphp(getphp_classphp(php$thisphp)php,php strlenphp(php$thisphp-php>php_barcodeNamespacephp)php php+php php1php)php)php;
php php php php php php php php ifphp php(php$thisphp-php>php_mandatoryChecksumphp)php php{
php php php php php php php php php php php php php$thisphp-php>php_withChecksumphp php=php truephp;
php php php php php php php php php php php php php$thisphp-php>php_withChecksumInTextphp php=php truephp;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp defaultphp optionsphp forphp particularphp object
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php protectedphp functionphp php_getDefaultOptionsphp(php)
php php php php php{
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp barcodephp statephp fromphp optionsphp array
php php php php php php*php php@paramphp php arrayphp php$options
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php/
php php php php publicphp functionphp setOptionsphp(php$optionsphp)
php php php php php{
php php php php php php php php foreachphp php(php$optionsphp asphp php$keyphp php=php>php php$valuephp)php php{
php php php php php php php php php php php php php$methodphp php=php php'setphp'php php.php php$keyphp;
php php php php php php php php php php php php ifphp php(methodphp_existsphp(php$thisphp,php php$methodphp)php)php php{
php php php php php php php php php php php php php php php php php$thisphp-php>php$methodphp(php$valuephp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp barcodephp statephp fromphp configphp object
php php php php php php*php php@paramphp Zendphp_Configphp php$config
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php/
php php php php publicphp functionphp setConfigphp(Zendphp_Configphp php$configphp)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>setOptionsphp(php$configphp-php>toArrayphp(php)php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp barcodephp namespacephp forphp autoloading
php php php php php php*
php php php php php php*php php@paramphp stringphp php$namespace
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php/
php php php php publicphp functionphp setBarcodeNamespacephp(php$namespacephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_barcodeNamespacephp php=php php$namespacephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp barcodephp namespace
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getBarcodeNamespacephp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_barcodeNamespacephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp typephp ofphp barcode
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getTypephp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_typephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp heightphp ofphp thephp barcodephp bar
php php php php php php*php php@paramphp integerphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setBarHeightphp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(intvalphp(php$valuephp)php <php=php php0php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Barphp heightphp mustphp bephp greaterphp thanphp php0php'
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php php php php php$thisphp-php>php_barHeightphp php=php intvalphp(php$valuephp)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp heightphp ofphp thephp barcodephp bar
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php publicphp functionphp getBarHeightphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_barHeightphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp thicknessphp ofphp thinphp bar
php php php php php php*php php@paramphp integerphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setBarThinWidthphp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(intvalphp(php$valuephp)php <php=php php0php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Barphp widthphp mustphp bephp greaterphp thanphp php0php'
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php php php php php$thisphp-php>php_barThinWidthphp php=php intvalphp(php$valuephp)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp thicknessphp ofphp thinphp bar
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php publicphp functionphp getBarThinWidthphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_barThinWidthphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp thicknessphp ofphp thickphp bar
php php php php php php*php php@paramphp integerphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setBarThickWidthphp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(intvalphp(php$valuephp)php <php=php php0php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Barphp widthphp mustphp bephp greaterphp thanphp php0php'
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php php php php php$thisphp-php>php_barThickWidthphp php=php intvalphp(php$valuephp)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp thicknessphp ofphp thickphp bar
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php publicphp functionphp getBarThickWidthphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_barThickWidthphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp factorphp applyingphp to
php php php php php php*php thinBarWidthphp php-php thickBarWidthphp php-php barHeightphp php-php fontSize
php php php php php php*php php@paramphp floatphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setFactorphp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(floatvalphp(php$valuephp)php <php=php php0php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Factorphp mustphp bephp greaterphp thanphp php0php'
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php php php php php$thisphp-php>php_factorphp php=php floatvalphp(php$valuephp)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp factorphp applyingphp to
php php php php php php*php thinBarWidthphp php-php thickBarWidthphp php-php barHeightphp php-php fontSize
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php publicphp functionphp getFactorphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_factorphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp colorphp ofphp thephp barcodephp andphp text
php php php php php php*php php@paramphp stringphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setForeColorphp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(pregphp_matchphp(php'php`php\php#php[php0php-php9Aphp-Fphp]php{php6php}php`php'php,php php$valuephp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_foreColorphp php=php hexdecphp(php$valuephp)php;
php php php php php php php php php}php elseifphp php(isphp_numericphp(php$valuephp)php php&php&php php$valuephp php>php=php php0php php&php&php php$valuephp <php=php php1php6php7php7php7php1php2php5php)php php{
php php php php php php php php php php php php php$thisphp-php>php_foreColorphp php=php intvalphp(php$valuephp)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Textphp colorphp mustphp bephp setphp asphp php#php[php0php-php9Aphp-Fphp]php{php6php}php'
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp colorphp ofphp thephp barcodephp andphp text
php php php php php php*php php@returnphp unknown
php php php php php php*php/
php php php php publicphp functionphp getForeColorphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_foreColorphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp thephp colorphp ofphp thephp background
php php php php php php*php php@paramphp integerphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setBackgroundColorphp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(pregphp_matchphp(php'php`php\php#php[php0php-php9Aphp-Fphp]php{php6php}php`php'php,php php$valuephp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_backgroundColorphp php=php hexdecphp(php$valuephp)php;
php php php php php php php php php}php elseifphp php(isphp_numericphp(php$valuephp)php php&php&php php$valuephp php>php=php php0php php&php&php php$valuephp <php=php php1php6php7php7php7php1php2php5php)php php{
php php php php php php php php php php php php php$thisphp-php>php_backgroundColorphp php=php intvalphp(php$valuephp)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Backgroundphp colorphp mustphp bephp setphp asphp php#php[php0php-php9Aphp-Fphp]php{php6php}php'
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp backgroundphp colorphp ofphp thephp image
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php publicphp functionphp getBackgroundColorphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_backgroundColorphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Activatephp/deactivatephp drawingphp ofphp thephp bar
php php php php php php*php php@paramphp booleanphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php/
php php php php publicphp functionphp setWithBorderphp(php$valuephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_withBorderphp php=php php(boolphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp ifphp borderphp arephp drawphp orphp not
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp getWithBorderphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_withBorderphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Activatephp/deactivatephp drawingphp ofphp thephp quietphp zones
php php php php php php*php php@paramphp booleanphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php/
php php php php publicphp functionphp setWithQuietZonesphp(php$valuephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_withQuietZonesphp php=php php(boolphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp ifphp quietphp zonesphp arephp drawphp orphp not
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp getWithQuietZonesphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_withQuietZonesphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Allowphp fastphp inversionphp ofphp fontphp/barsphp colorphp andphp backgroundphp color
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php/
php php php php publicphp functionphp setReverseColorphp(php)
php php php php php{
php php php php php php php php php$tmpphp php php php php php php php php php php php php php php php php php php php php=php php$thisphp-php>php_foreColorphp;
php php php php php php php php php$thisphp-php>php_foreColorphp php php php php php php php=php php$thisphp-php>php_backgroundColorphp;
php php php php php php php php php$thisphp-php>php_backgroundColorphp php=php php$tmpphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp orientationphp ofphp barcodephp andphp text
php php php php php php*php php@paramphp floatphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setOrientationphp(php$valuephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_orientationphp php=php floatvalphp(php$valuephp)php php-php floorphp(floatvalphp(php$valuephp)php php/php php3php6php0php)php php*php php3php6php0php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp orientationphp ofphp barcodephp andphp text
php php php php php php*php php@returnphp float
php php php php php php*php/
php php php php publicphp functionphp getOrientationphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_orientationphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp textphp tophp encode
php php php php php php*php php@paramphp stringphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php/
php php php php publicphp functionphp setTextphp(php$valuephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_textphp php=php trimphp(php$valuephp)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp textphp tophp encode
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getTextphp(php)
php php php php php{
php php php php php php php php php$textphp php=php php$thisphp-php>php_textphp;
php php php php php php php php ifphp php(php$thisphp-php>php_withChecksumphp)php php{
php php php php php php php php php php php php php$textphp php.php=php php$thisphp-php>getChecksumphp(php$thisphp-php>php_textphp)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp-php>php_addLeadingZerosphp(php$textphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Automaticallyphp addphp leadingphp zerosphp ifphp barcodephp lengthphp isphp fixed
php php php php php php*php php@paramphp stringphp php$text
php php php php php php*php php@paramphp booleanphp php$withoutChecksum
php php php php php php*php/
php php php php protectedphp functionphp php_addLeadingZerosphp(php$textphp,php php$withoutChecksumphp php=php falsephp)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_barcodeLengthphp php&php&php php$thisphp-php>php_addLeadingZerosphp)php php{
php php php php php php php php php php php php php$omitChecksumphp php=php php(intphp)php php(php$thisphp-php>php_withChecksumphp php&php&php php$withoutChecksumphp)php;
php php php php php php php php php php php php ifphp php(isphp_intphp(php$thisphp-php>php_barcodeLengthphp)php)php php{
php php php php php php php php php php php php php php php php php$lengthphp php=php php$thisphp-php>php_barcodeLengthphp php-php php$omitChecksumphp;
php php php php php php php php php php php php php php php php ifphp php(strlenphp(php$textphp)php <php php$lengthphp)php php{
php php php php php php php php php php php php php php php php php php php php php$textphp php=php strphp_repeatphp(php'php0php'php,php php$lengthphp php-php strlenphp(php$textphp)php)php php.php php$textphp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php ifphp php(php$thisphp-php>php_barcodeLengthphp php=php=php php'evenphp'php)php php{
php php php php php php php php php php php php php php php php php php php php php$textphp php=php php(php(strlenphp(php$textphp)php php-php php$omitChecksumphp)php php%php php2php php?php php'php0php'php php.php php$textphp php:php php$textphp)php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php}
php php php php php php php php returnphp php$textphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp textphp tophp encode
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getRawTextphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_textphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp textphp tophp display
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getTextToDisplayphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_withChecksumInTextphp)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>getTextphp(php)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_addLeadingZerosphp(php$thisphp-php>php_textphp,php truephp)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Activatephp/deactivatephp drawingphp ofphp textphp tophp encode
php php php php php php*php php@paramphp booleanphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php/
php php php php publicphp functionphp setDrawTextphp(php$valuephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_drawTextphp php=php php(boolphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp ifphp drawingphp ofphp textphp tophp encodephp isphp enabled
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp getDrawTextphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_drawTextphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Activatephp/deactivatephp thephp adjustmentphp ofphp thephp position
php php php php php php*php ofphp thephp charactersphp tophp thephp positionphp ofphp thephp bars
php php php php php php*php php@paramphp booleanphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setStretchTextphp(php$valuephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_stretchTextphp php=php php(boolphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp ifphp thephp adjustmentphp ofphp thephp positionphp ofphp thephp characters
php php php php php php*php tophp thephp positionphp ofphp thephp barsphp isphp enabled
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp getStretchTextphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_stretchTextphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Activatephp/deactivatephp thephp automaticphp generation
php php php php php php*php ofphp thephp checksumphp character
php php php php php php*php addedphp tophp thephp barcodephp text
php php php php php php*php php@paramphp booleanphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php/
php php php php publicphp functionphp setWithChecksumphp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(php!php$thisphp-php>php_mandatoryChecksumphp)php php{
php php php php php php php php php php php php php$thisphp-php>php_withChecksumphp php=php php(boolphp)php php$valuephp;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp ifphp thephp checksumphp characterphp isphp automatically
php php php php php php*php addedphp tophp thephp barcodephp text
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp getWithChecksumphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_withChecksumphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Activatephp/deactivatephp thephp automaticphp generation
php php php php php php*php ofphp thephp checksumphp character
php php php php php php*php addedphp tophp thephp barcodephp text
php php php php php php*php php@paramphp booleanphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setWithChecksumInTextphp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(php!php$thisphp-php>php_mandatoryChecksumphp)php php{
php php php php php php php php php php php php php$thisphp-php>php_withChecksumInTextphp php=php php(boolphp)php php$valuephp;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp ifphp thephp checksumphp characterphp isphp automatically
php php php php php php*php addedphp tophp thephp barcodephp text
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp getWithChecksumInTextphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_withChecksumInTextphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp thephp fontphp forphp allphp instancesphp ofphp barcode
php php php php php php*php php@paramphp stringphp php$font
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp staticphp functionphp setBarcodeFontphp(php$fontphp)
php php php php php{
php php php php php php php php ifphp php(isphp_stringphp(php$fontphp)php php|php|php php(isphp_intphp(php$fontphp)php php&php&php php$fontphp php>php=php php1php php&php&php php$fontphp <php=php php5php)php)php php{
php php php php php php php php php php php php selfphp:php:php$php_staticFontphp php=php php$fontphp;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp thephp fontphp:
php php php php php php*php php php-php ifphp integerphp betweenphp php1php andphp php5php,php usephp gdphp builtphp-inphp fonts
php php php php php php*php php php-php ifphp stringphp,php php$valuephp isphp assumedphp tophp bephp thephp pathphp tophp aphp TTFphp font
php php php php php php*php php@paramphp integerphp|stringphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setFontphp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(isphp_intphp(php$valuephp)php php&php&php php$valuephp php>php=php php1php php&php&php php$valuephp <php=php php5php)php php{
php php php php php php php php php php php php ifphp php(php!extensionphp_loadedphp(php'gdphp'php)php)php php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php php php php php'GDphp extensionphp isphp requiredphp tophp usephp numericphp fontphp'
php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php php/php/php Casephp ofphp numericphp fontphp withphp GD
php php php php php php php php php php php php php$thisphp-php>php_fontphp php=php php$valuephp;

php php php php php php php php php php php php php/php/php Inphp thisphp casephp fontphp sizephp isphp givenphp byphp:
php php php php php php php php php php php php php$thisphp-php>php_fontSizephp php=php imagefontheightphp(php$valuephp)php;
php php php php php php php php php}php elseifphp php(isphp_stringphp(php$valuephp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_fontphp php=php php$valuephp;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(sprintfphp(
php php php php php php php php php php php php php php php php php'Invalidphp fontphp php"php%sphp"php providedphp tophp setFontphp(php)php'php,
php php php php php php php php php php php php php php php php php$value
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp thephp font
php php php php php php*php php@returnphp integerphp|string
php php php php php php*php/
php php php php publicphp functionphp getFontphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_fontphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp thephp sizephp ofphp thephp fontphp inphp casephp ofphp TTF
php php php php php php*php php@paramphp floatphp php$value
php php php php php php*php php@returnphp Zendphp_Barcodephp_Object
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php publicphp functionphp setFontSizephp(php$valuephp)
php php php php php{
php php php php php php php php ifphp php(isphp_numericphp(php$thisphp-php>php_fontphp)php)php php{
php php php php php php php php php php php php php/php/php Casephp ofphp numericphp fontphp withphp GD
php php php php php php php php php php php php returnphp php$thisphp;
php php php php php php php php php}

php php php php php php php php ifphp php(php!isphp_numericphp(php$valuephp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Fontphp sizephp mustphp bephp aphp numericphp valuephp'
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_fontSizephp php=php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp thephp sizephp ofphp thephp fontphp inphp casephp ofphp TTF
php php php php php php*php php@returnphp float
php php php php php php*php/
php php php php publicphp functionphp getFontSizephp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_fontSizephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Quietphp zonephp beforephp firstphp bar
php php php php php php*php andphp afterphp thephp lastphp bar
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php publicphp functionphp getQuietZonephp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_withQuietZonesphp php|php|php php$thisphp-php>php_mandatoryQuietZonesphp)php php{
php php php php php php php php php php php php returnphp php1php0php php*php php$thisphp-php>php_barThinWidthphp php*php php$thisphp-php>php_factorphp;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php returnphp php0php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp anphp instructionphp inphp thephp arrayphp ofphp instructions
php php php php php php*php php@paramphp arrayphp php$instruction
php php php php php php*php/
php php php php protectedphp functionphp php_addInstructionphp(arrayphp php$instructionphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_instructionsphp[php]php php=php php$instructionphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp thephp setphp ofphp drawingphp instructions
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getInstructionsphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_instructionsphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp aphp polygonphp drawingphp instructionphp inphp thephp setphp ofphp instructions
php php php php php php*php php@paramphp arrayphp php$points
php php php php php php*php php@paramphp integerphp php$color
php php php php php php*php php@paramphp booleanphp php$filled
php php php php php php*php/
php php php php protectedphp functionphp php_addPolygonphp(arrayphp php$pointsphp,php php$colorphp php=php nullphp,php php$filledphp php=php truephp)
php php php php php{
php php php php php php php php ifphp php(php$colorphp php=php=php=php nullphp)php php{
php php php php php php php php php php php php php$colorphp php=php php$thisphp-php>php_foreColorphp;
php php php php php php php php php}
php php php php php php php php php$thisphp-php>php_addInstructionphp(arrayphp(
php php php php php php php php php php php php php'typephp'php php php php=php>php php'polygonphp'php,
php php php php php php php php php php php php php'pointsphp'php php=php>php php$pointsphp,
php php php php php php php php php php php php php'colorphp'php php php=php>php php$colorphp,
php php php php php php php php php php php php php'filledphp'php php=php>php php$filledphp,
php php php php php php php php php)php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp aphp textphp drawingphp instructionphp inphp thephp setphp ofphp instructions
php php php php php php*php php@paramphp stringphp php$text
php php php php php php*php php@paramphp floatphp php$size
php php php php php php*php php@paramphp arrayphp php$position
php php php php php php*php php@paramphp stringphp php$font
php php php php php php*php php@paramphp integerphp php$color
php php php php php php*php php@paramphp stringphp php$alignment
php php php php php php*php php@paramphp floatphp php$orientation
php php php php php php*php/
php php php php protectedphp functionphp php_addTextphp(
php php php php php php php php php$textphp,
php php php php php php php php php$sizephp,
php php php php php php php php php$positionphp,
php php php php php php php php php$fontphp,
php php php php php php php php php$colorphp,
php php php php php php php php php$alignmentphp php=php php'centerphp'php,
php php php php php php php php php$orientationphp php=php php0
php php php php php)php php{
php php php php php php php php ifphp php(php$colorphp php=php=php=php nullphp)php php{
php php php php php php php php php php php php php$colorphp php=php php$thisphp-php>php_foreColorphp;
php php php php php php php php php}
php php php php php php php php php$thisphp-php>php_addInstructionphp(arrayphp(
php php php php php php php php php php php php php'typephp'php php php php php php php php php=php>php php'textphp'php,
php php php php php php php php php php php php php'textphp'php php php php php php php php php=php>php php$textphp,
php php php php php php php php php php php php php'sizephp'php php php php php php php php php=php>php php$sizephp,
php php php php php php php php php php php php php'positionphp'php php php php php=php>php php$positionphp,
php php php php php php php php php php php php php'fontphp'php php php php php php php php php=php>php php$fontphp,
php php php php php php php php php php php php php'colorphp'php php php php php php php php=php>php php$colorphp,
php php php php php php php php php php php php php'alignmentphp'php php php php=php>php php$alignmentphp,
php php php php php php php php php php php php php'orientationphp'php php=php>php php$orientationphp,
php php php php php php php php php)php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Checkingphp ofphp parametersphp afterphp allphp settings
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp checkParamsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_checkTextphp(php)php;
php php php php php php php php php$thisphp-php>php_checkFontAndOrientationphp(php)php;
php php php php php php php php php$thisphp-php>php_checkParamsphp(php)php;
php php php php php php php php returnphp truephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Checkphp ifphp aphp textphp isphp reallyphp providedphp tophp barcode
php php php php php php*php php@returnphp void
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php protectedphp functionphp php_checkTextphp(php$valuephp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(php$valuephp php=php=php=php nullphp)php php{
php php php php php php php php php php php php php$valuephp php=php php$thisphp-php>php_textphp;
php php php php php php php php php}
php php php php php php php php ifphp php(php!strlenphp(php$valuephp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Aphp textphp mustphp bephp providephp tophp Barcodephp beforephp drawingphp'
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php php php php php$thisphp-php>validateTextphp(php$valuephp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Checkphp thephp ratiophp betweenphp thephp thickphp andphp thephp thinphp bar
php php php php php php*php php@paramphp integerphp php$min
php php php php php php*php php@paramphp integerphp php$max
php php php php php php*php php@returnphp void
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php protectedphp functionphp php_checkRatiophp(php$minphp php=php php2php,php php$maxphp php=php php3php)
php php php php php{
php php php php php php php php php$ratiophp php=php php$thisphp-php>php_barThickWidthphp php/php php$thisphp-php>php_barThinWidthphp;
php php php php php php php php ifphp php(php!php(php$ratiophp php>php=php php$minphp php&php&php php$ratiophp <php=php php$maxphp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(sprintfphp(
php php php php php php php php php php php php php php php php php'Ratiophp thickphp/thinphp barphp mustphp bephp betweenphp php%php0php.php1fphp andphp php%php0php.php1fphp php(actualphp php%php0php.php3fphp)php'php,
php php php php php php php php php php php php php php php php php$minphp,
php php php php php php php php php php php php php php php php php$maxphp,
php php php php php php php php php php php php php php php php php$ratio
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Drawingphp withphp anphp anglephp isphp justphp allowphp TTFphp font
php php php php php php*php php@returnphp void
php php php php php php*php php@throwphp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php*php/
php php php php protectedphp functionphp php_checkFontAndOrientationphp(php)
php php php php php{
php php php php php php php php ifphp php(isphp_numericphp(php$thisphp-php>php_fontphp)php php&php&php php$thisphp-php>php_orientationphp php!php=php php0php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Onlyphp drawingphp withphp TTFphp fontphp allowphp orientationphp ofphp thephp barcodephp.php'
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Widthphp ofphp thephp resultphp image
php php php php php php*php php(beforephp anyphp rotationphp)
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php protectedphp functionphp php_calculateWidthphp(php)
php php php php php{
php php php php php php php php returnphp php(intphp)php php$thisphp-php>php_withBorder
php php php php php php php php php php php php php+php php$thisphp-php>php_calculateBarcodeWidthphp(php)
php php php php php php php php php php php php php+php php(intphp)php php$thisphp-php>php_withBorderphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Calculatephp thephp widthphp ofphp thephp barcode
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php abstractphp protectedphp functionphp php_calculateBarcodeWidthphp(php)php;

php php php php php/php*php*
php php php php php php*php Heightphp ofphp thephp resultphp object
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php protectedphp functionphp php_calculateHeightphp(php)
php php php php php{
php php php php php php php php returnphp php(intphp)php php$thisphp-php>php_withBorderphp php*php php2
php php php php php php php php php php php php php+php php$thisphp-php>php_calculateBarcodeHeightphp(php)
php php php php php php php php php php php php php+php php(intphp)php php$thisphp-php>php_withBorderphp php*php php2php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Heightphp ofphp thephp barcode
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php protectedphp functionphp php_calculateBarcodeHeightphp(php)
php php php php php{
php php php php php php php php php$textHeightphp php=php php0php;
php php php php php php php php php$extraHeightphp php=php php0php;
php php php php php php php php ifphp php(php$thisphp-php>php_drawTextphp)php php{
php php php php php php php php php php php php php$textHeightphp php+php=php php$thisphp-php>php_fontSizephp;
php php php php php php php php php php php php php$extraHeightphp php=php php2php;
php php php php php php php php php}
php php php php php php php php returnphp php(php$thisphp-php>php_barHeightphp php+php php$textHeightphp)php php*php php$thisphp-php>php_factorphp php+php php$extraHeightphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp heightphp ofphp thephp resultphp object
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php publicphp functionphp getHeightphp(php$recalculatephp php=php falsephp)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_heightphp php=php=php=php nullphp php|php|php php$recalculatephp)php php{
php php php php php php php php php php php php php$thisphp-php>php_heightphp php=
php php php php php php php php php php php php php php php php absphp(php$thisphp-php>php_calculateHeightphp(php)php php*php cosphp(php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php)
php php php php php php php php php php php php php php php php php+php absphp(php$thisphp-php>php_calculateWidthphp(php)php php*php sinphp(php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp-php>php_heightphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp widthphp ofphp thephp resultphp object
php php php php php php*php php@returnphp integer
php php php php php php*php/
php php php php publicphp functionphp getWidthphp(php$recalculatephp php=php falsephp)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_widthphp php=php=php=php nullphp php|php|php php$recalculatephp)php php{
php php php php php php php php php php php php php$thisphp-php>php_widthphp php=
php php php php php php php php php php php php php php php php absphp(php$thisphp-php>php_calculateWidthphp(php)php php*php cosphp(php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php)
php php php php php php php php php php php php php php php php php+php absphp(php$thisphp-php>php_calculateHeightphp(php)php php*php sinphp(php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp-php>php_widthphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Calculatephp thephp offsetphp fromphp thephp leftphp ofphp thephp object
php php php php php php*php ifphp anphp orientationphp isphp activated
php php php php php php*php php@paramphp booleanphp php$recalculate
php php php php php php*php php@returnphp float
php php php php php php*php/
php php php php publicphp functionphp getOffsetLeftphp(php$recalculatephp php=php falsephp)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_offsetLeftphp php=php=php=php nullphp php|php|php php$recalculatephp)php php{
php php php php php php php php php php php php php$thisphp-php>php_offsetLeftphp php=php php-php minphp(arrayphp(
php php php php php php php php php php php php php php php php php0php php*php cosphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php php-php php0php php*php sinphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php,
php php php php php php php php php php php php php php php php php0php php*php cosphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php php-php php$thisphp-php>php_calculateBarcodeHeightphp(php)php php*php sinphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php,
php php php php php php php php php php php php php php php php php$thisphp-php>php_calculateBarcodeWidthphp(php)php php*php cosphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php php-php php$thisphp-php>php_calculateBarcodeHeightphp(php)php php*php sinphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php,
php php php php php php php php php php php php php php php php php$thisphp-php>php_calculateBarcodeWidthphp(php)php php*php cosphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php php-php php0php php*php sinphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp-php>php_offsetLeftphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Calculatephp thephp offsetphp fromphp thephp topphp ofphp thephp object
php php php php php php*php ifphp anphp orientationphp isphp activated
php php php php php php*php php@paramphp booleanphp php$recalculate
php php php php php php*php php@returnphp float
php php php php php php*php/
php php php php publicphp functionphp getOffsetTopphp(php$recalculatephp php=php falsephp)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_offsetTopphp php=php=php=php nullphp php|php|php php$recalculatephp)php php{
php php php php php php php php php php php php php$thisphp-php>php_offsetTopphp php=php php-php minphp(arrayphp(
php php php php php php php php php php php php php php php php php0php php*php cosphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php php+php php0php php*php sinphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php,
php php php php php php php php php php php php php php php php php$thisphp-php>php_calculateBarcodeHeightphp(php)php php*php cosphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php php+php php0php php*php sinphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php,
php php php php php php php php php php php php php php php php php$thisphp-php>php_calculateBarcodeHeightphp(php)php php*php cosphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php php+php php$thisphp-php>php_calculateBarcodeWidthphp(php)php php*php sinphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php,
php php php php php php php php php php php php php php php php php0php php*php cosphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php php+php php$thisphp-php>php_calculateBarcodeWidthphp(php)php php*php sinphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)php,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp-php>php_offsetTopphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Applyphp rotationphp onphp aphp pointphp inphp Xphp/Yphp dimensions
php php php php php php*php php@paramphp floatphp php$xphp1php php php php php xphp-positionphp beforephp rotation
php php php php php php*php php@paramphp floatphp php$yphp1php php php php php yphp-positionphp beforephp rotation
php php php php php php*php php@returnphp arrayphp php php php php php php php Arrayphp ofphp twophp elementsphp correspondingphp tophp thephp newphp XYphp point
php php php php php php*php/
php php php php protectedphp functionphp php_rotatephp(php$xphp1php,php php$yphp1php)
php php php php php{
php php php php php php php php php$xphp2php php=php php$xphp1php php*php cosphp(php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)
php php php php php php php php php php php php php-php php$yphp1php php*php sinphp(php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)
php php php php php php php php php php php php php+php php$thisphp-php>getOffsetLeftphp(php)php;
php php php php php php php php php$yphp2php php=php php$yphp1php php*php cosphp(php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)
php php php php php php php php php php php php php+php php$xphp1php php*php sinphp(php$thisphp-php>php_orientationphp php/php php1php8php0php php*php piphp(php)php)
php php php php php php php php php php php php php+php php$thisphp-php>getOffsetTopphp(php)php;
php php php php php php php php returnphp arrayphp(intvalphp(php$xphp2php)php php,php intvalphp(php$yphp2php)php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Completephp drawingphp ofphp thephp barcode
php php php php php php*php php@returnphp arrayphp Tablephp ofphp instructions
php php php php php php*php/
php php php php publicphp functionphp drawphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>checkParamsphp(php)php;
php php php php php php php php php$thisphp-php>php_drawBarcodephp(php)php;
php php php php php php php php php$thisphp-php>php_drawBorderphp(php)php;
php php php php php php php php php$thisphp-php>php_drawTextphp(php)php;
php php php php php php php php returnphp php$thisphp-php>getInstructionsphp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Drawphp thephp barcode
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php protectedphp functionphp php_drawBarcodephp(php)
php php php php php{
php php php php php php php php php$barcodeTablephp php=php php$thisphp-php>php_prepareBarcodephp(php)php;

php php php php php php php php php$thisphp-php>php_preDrawBarcodephp(php)php;

php php php php php php php php php$xposphp php=php php(intphp)php php$thisphp-php>php_withBorderphp;
php php php php php php php php php$yposphp php=php php(intphp)php php$thisphp-php>php_withBorderphp;

php php php php php php php php php$pointphp1php php=php php$thisphp-php>php_rotatephp(php0php,php php0php)php;
php php php php php php php php php$pointphp2php php=php php$thisphp-php>php_rotatephp(php0php,php php$thisphp-php>php_calculateHeightphp(php)php php-php php1php)php;
php php php php php php php php php$pointphp3php php=php php$thisphp-php>php_rotatephp(
php php php php php php php php php php php php php$thisphp-php>php_calculateWidthphp(php)php php-php php1php,
php php php php php php php php php php php php php$thisphp-php>php_calculateHeightphp(php)php php-php php1
php php php php php php php php php)php;
php php php php php php php php php$pointphp4php php=php php$thisphp-php>php_rotatephp(php$thisphp-php>php_calculateWidthphp(php)php php-php php1php,php php0php)php;

php php php php php php php php php$thisphp-php>php_addPolygonphp(arrayphp(
php php php php php php php php php php php php php$pointphp1php,
php php php php php php php php php php php php php$pointphp2php,
php php php php php php php php php php php php php$pointphp3php,
php php php php php php php php php php php php php$pointphp4
php php php php php php php php php)php,php php$thisphp-php>php_backgroundColorphp)php;

php php php php php php php php php$xposphp php php php php php+php=php php$thisphp-php>getQuietZonephp(php)php;
php php php php php php php php php$barLengthphp php=php php$thisphp-php>php_barHeightphp php*php php$thisphp-php>php_factorphp;

php php php php php php php php foreachphp php(php$barcodeTablephp asphp php$barphp)php php{
php php php php php php php php php php php php php$widthphp php=php php$barphp[php1php]php php*php php$thisphp-php>php_factorphp;
php php php php php php php php php php php php ifphp php(php$barphp[php0php]php)php php{
php php php php php php php php php php php php php php php php php$pointphp1php php=php php$thisphp-php>php_rotatephp(php$xposphp,php php$yposphp php+php php$barphp[php2php]php php*php php$barLengthphp)php;
php php php php php php php php php php php php php php php php php$pointphp2php php=php php$thisphp-php>php_rotatephp(php$xposphp,php php$yposphp php+php php$barphp[php3php]php php*php php$barLengthphp)php;
php php php php php php php php php php php php php php php php php$pointphp3php php=php php$thisphp-php>php_rotatephp(
php php php php php php php php php php php php php php php php php php php php php$xposphp php+php php$widthphp php-php php1php,
php php php php php php php php php php php php php php php php php php php php php$yposphp php+php php$barphp[php3php]php php*php php$barLength
php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php php php php php$pointphp4php php=php php$thisphp-php>php_rotatephp(
php php php php php php php php php php php php php php php php php php php php php$xposphp php+php php$widthphp php-php php1php,
php php php php php php php php php php php php php php php php php php php php php$yposphp php+php php$barphp[php2php]php php*php php$barLength
php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php php php php php$thisphp-php>php_addPolygonphp(arrayphp(
php php php php php php php php php php php php php php php php php php php php php$pointphp1php,
php php php php php php php php php php php php php php php php php php php php php$pointphp2php,
php php php php php php php php php php php php php php php php php php php php php$pointphp3php,
php php php php php php php php php php php php php php php php php php php php php$pointphp4php,
php php php php php php php php php php php php php php php php php)php)php;
php php php php php php php php php php php php php}
php php php php php php php php php php php php php$xposphp php+php=php php$widthphp;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_postDrawBarcodephp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Partialphp functionphp tophp drawphp border
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php protectedphp functionphp php_drawBorderphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_withBorderphp)php php{
php php php php php php php php php php php php php$pointphp1php php=php php$thisphp-php>php_rotatephp(php0php,php php0php)php;
php php php php php php php php php php php php php$pointphp2php php=php php$thisphp-php>php_rotatephp(php$thisphp-php>php_calculateWidthphp(php)php php-php php1php,php php0php)php;
php php php php php php php php php php php php php$pointphp3php php=php php$thisphp-php>php_rotatephp(
php php php php php php php php php php php php php php php php php$thisphp-php>php_calculateWidthphp(php)php php-php php1php,
php php php php php php php php php php php php php php php php php$thisphp-php>php_calculateHeightphp(php)php php-php php1
php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php$pointphp4php php=php php$thisphp-php>php_rotatephp(php0php,php php$thisphp-php>php_calculateHeightphp(php)php php-php php1php)php;
php php php php php php php php php php php php php$thisphp-php>php_addPolygonphp(arrayphp(
php php php php php php php php php php php php php php php php php$pointphp1php,
php php php php php php php php php php php php php php php php php$pointphp2php,
php php php php php php php php php php php php php php php php php$pointphp3php,
php php php php php php php php php php php php php php php php php$pointphp4php,
php php php php php php php php php php php php php php php php php$pointphp1php,
php php php php php php php php php php php php php)php,php php$thisphp-php>php_foreColorphp,php falsephp)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Partialphp functionphp tophp drawphp text
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php protectedphp functionphp php_drawTextphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_drawTextphp)php php{
php php php php php php php php php php php php php$textphp php=php php$thisphp-php>getTextToDisplayphp(php)php;
php php php php php php php php php php php php ifphp php(php$thisphp-php>php_stretchTextphp)php php{
php php php php php php php php php php php php php php php php php$textLengthphp php=php strlenphp(php$textphp)php;
php php php php php php php php php php php php php php php php php$spacephp php php php php php php=php php(php$thisphp-php>php_calculateWidthphp(php)php php-php php2php php*php php$thisphp-php>getQuietZonephp(php)php)php php/php php$textLengthphp;
php php php php php php php php php php php php php php php php forphp php(php$iphp php=php php0php;php php$iphp <php php$textLengthphp;php php$iphp php+php+php)php php{
php php php php php php php php php php php php php php php php php php php php php$leftPositionphp php=php php$thisphp-php>getQuietZonephp(php)php php+php php$spacephp php*php php(php$iphp php+php php0php.php5php)php;
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_addTextphp(
php php php php php php php php php php php php php php php php php php php php php php php php php$textphp{php$iphp}php,
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_fontSizephp php*php php$thisphp-php>php_factorphp,
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_rotatephp(
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php$leftPositionphp,
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php(intphp)php php$thisphp-php>php_withBorderphp php*php php2
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php php+php php$thisphp-php>php_factorphp php*php php(php$thisphp-php>php_barHeightphp php+php php$thisphp-php>php_fontSizephp)php php+php php1
php php php php php php php php php php php php php php php php php php php php php php php php php)php,
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_fontphp,
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_foreColorphp,
php php php php php php php php php php php php php php php php php php php php php php php php php'centerphp'php,
php php php php php php php php php php php php php php php php php php php php php php php php php-php php$thisphp-php>php_orientation
php php php php php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$thisphp-php>php_addTextphp(
php php php php php php php php php php php php php php php php php php php php php$textphp,
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_fontSizephp php*php php$thisphp-php>php_factorphp,
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_rotatephp(
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_calculateWidthphp(php)php php/php php2php,
php php php php php php php php php php php php php php php php php php php php php php php php php(intphp)php php$thisphp-php>php_withBorderphp php*php php2
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php+php php$thisphp-php>php_factorphp php*php php(php$thisphp-php>php_barHeightphp php+php php$thisphp-php>php_fontSizephp)php php+php php1
php php php php php php php php php php php php php php php php php php php php php)php,
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_fontphp,
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>php_foreColorphp,
php php php php php php php php php php php php php php php php php php php php php'centerphp'php,
php php php php php php php php php php php php php php php php php php php php php-php php$thisphp-php>php_orientation
php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php}
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Checkphp forphp invalidphp characters
php php php php php php*php php@paramphp php php stringphp php$valuephp php php php Textphp tophp bephp ckecked
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp validateTextphp(php$valuephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_validateTextphp(php$valuephp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Standardphp validationphp forphp mostphp ofphp barcodephp objects
php php php php php php*php php@paramphp stringphp php$value
php php php php php php*php php@paramphp arrayphp php php$options
php php php php php php*php/
php php php php protectedphp functionphp php_validateTextphp(php$valuephp,php php$optionsphp php=php arrayphp(php)php)
php php php php php{
php php php php php php php php php$validatorNamephp php=php php(issetphp(php$optionsphp[php'validatorphp'php]php)php)php php?php php$optionsphp[php'validatorphp'php]php php:php php$thisphp-php>getTypephp(php)php;

php php php php php php php php php$validatorphp php=php newphp Zendphp_Validatephp_Barcodephp(arrayphp(
php php php php php php php php php php php php php'adapterphp'php php php=php>php php$validatorNamephp,
php php php php php php php php php php php php php'checksumphp'php php=php>php falsephp,
php php php php php php php php php)php)php;

php php php php php php php php php$checksumCharacterphp php=php php'php'php;
php php php php php php php php php$withChecksumphp php=php falsephp;
php php php php php php php php ifphp php(php$thisphp-php>php_mandatoryChecksumphp)php php{
php php php php php php php php php php php php php$checksumCharacterphp php=php php$thisphp-php>php_substituteChecksumCharacterphp;
php php php php php php php php php php php php php$withChecksumphp php=php truephp;
php php php php php php php php php}

php php php php php php php php php$valuephp php=php php$thisphp-php>php_addLeadingZerosphp(php$valuephp,php php$withChecksumphp)php php.php php$checksumCharacterphp;

php php php php php php php php ifphp php(php!php$validatorphp-php>isValidphp(php$valuephp)php)php php{
php php php php php php php php php php php php php$messagephp php=php implodephp(php"php\nphp"php,php php$validatorphp-php>getMessagesphp(php)php)php;

php php php php php php php php php php php php php/php*php*
php php php php php php php php php php php php php php*php php@seephp Zendphp_Barcodephp_Objectphp_Exception
php php php php php php php php php php php php php php*php/
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Barcodephp/Objectphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Barcodephp_Objectphp_Exceptionphp(php$messagephp)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Eachphp childphp mustphp preparephp thephp barcodephp andphp return
php php php php php php*php aphp tablephp likephp arrayphp(
php php php php php php*php php php php php php0php php=php>php arrayphp(
php php php php php php*php php php php php php php php php php0php php=php>php intphp php(visiblephp(blackphp)php orphp notphp(whitephp)php)
php php php php php php*php php php php php php php php php php1php php=php>php intphp php(widthphp ofphp thephp barphp)
php php php php php php*php php php php php php php php php php2php php=php>php floatphp php(php0php-php>php1php positionphp fromphp thephp topphp ofphp thephp beginningphp ofphp thephp barphp inphp php%php)
php php php php php php*php php php php php php php php php php3php php=php>php floatphp php(php0php-php>php1php positionphp fromphp thephp topphp ofphp thephp endphp ofphp thephp barphp inphp php%php)
php php php php php php*php php php php php php)php,
php php php php php php*php php php php php php1php php=php>php php.php.php.
php php php php php php*php php)
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php abstractphp protectedphp functionphp php_prepareBarcodephp(php)php;

php php php php php/php*php*
php php php php php php*php Checkingphp ofphp parametersphp afterphp allphp settings
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php abstractphp protectedphp functionphp php_checkParamsphp(php)php;

php php php php php/php*php*
php php php php php php*php Allowphp eachphp childphp tophp drawphp somethingphp else
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php protectedphp functionphp php_preDrawBarcodephp(php)
php php php php php{
php php php php php}

php php php php php/php*php*
php php php php php php*php Allowphp eachphp childphp tophp drawphp somethingphp else
php php php php php php*php php(exphp:php bearerphp barsphp inphp interleavedphp php2php ofphp php5php codephp)
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php protectedphp functionphp php_postDrawBarcodephp(php)
php php php php php{
php php php php php}
php}
