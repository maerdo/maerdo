<php?php
php/php*php*
php php*php Zendphp Framework
php php*
php php*php LICENSE
php php*
php php*php Thisphp sourcephp filephp isphp subjectphp tophp thephp newphp BSDphp licensephp thatphp isphp bundled
php php*php withphp thisphp packagephp inphp thephp filephp LICENSEphp.txtphp.
php php*php Itphp isphp alsophp availablephp throughphp thephp worldphp-widephp-webphp atphp thisphp URLphp:
php php*php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsd
php php*php Ifphp youphp didphp notphp receivephp aphp copyphp ofphp thephp licensephp andphp arephp unablephp to
php php*php obtainphp itphp throughphp thephp worldphp-widephp-webphp,php pleasephp sendphp anphp email
php php*php tophp licensephp@zendphp.comphp sophp wephp canphp sendphp youphp aphp copyphp immediatelyphp.
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Searchphp_Lucene
php php*php php@subpackagephp Search
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@versionphp php php php php$Idphp:php QueryTokenphp.phpphp php2php0php0php9php6php php2php0php1php0php-php0php1php-php0php6php php0php2php:php0php5php:php0php9Zphp bkarwinphp php$
php php*php/

php/php*php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Searchphp_Lucene
php php*php php@subpackagephp Search
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php/
classphp Zendphp_Searchphp_Lucenephp_Searchphp_QueryToken
php{
php php php php php/php*php*
php php php php php php*php Tokenphp typesphp.
php php php php php php*php/
php php php php constphp TTphp_WORDphp php php php php php php php php php php php php php php php php php=php php0php;php php php/php/php Word
php php php php constphp TTphp_PHRASEphp php php php php php php php php php php php php php php php=php php1php;php php php/php/php Phrasephp php(onephp orphp severalphp quotedphp wordsphp)
php php php php constphp TTphp_FIELDphp php php php php php php php php php php php php php php php php=php php2php;php php php/php/php Fieldphp namephp inphp php'fieldphp:wordphp'php,php fieldphp:php<phrasephp>php orphp fieldphp:php(php<subqueryphp>php)php pairs
php php php php constphp TTphp_FIELDphp_INDICATORphp php php php php php php=php php3php;php php php/php/php php'php:php'
php php php php constphp TTphp_REQUIREDphp php php php php php php php php php php php php php=php php4php;php php php/php/php php'php+php'
php php php php constphp TTphp_PROHIBITEDphp php php php php php php php php php php php=php php5php;php php php/php/php php'php-php'
php php php php constphp TTphp_FUZZYphp_PROXphp_MARKphp php php php php php php=php php6php;php php php/php/php php'php~php'
php php php php constphp TTphp_BOOSTINGphp_MARKphp php php php php php php php php=php php7php;php php php/php/php php'php^php'
php php php php constphp TTphp_RANGEphp_INCLphp_STARTphp php php php php php=php php8php;php php php/php/php php'php[php'
php php php php constphp TTphp_RANGEphp_INCLphp_ENDphp php php php php php php php=php php9php;php php php/php/php php'php]php'
php php php php constphp TTphp_RANGEphp_EXCLphp_STARTphp php php php php php=php php1php0php;php php/php/php php'php{php'
php php php php constphp TTphp_RANGEphp_EXCLphp_ENDphp php php php php php php php=php php1php1php;php php/php/php php'php}php'
php php php php constphp TTphp_SUBQUERYphp_STARTphp php php php php php php php=php php1php2php;php php/php/php php'php(php'
php php php php constphp TTphp_SUBQUERYphp_ENDphp php php php php php php php php php=php php1php3php;php php/php/php php'php)php'
php php php php constphp TTphp_ANDphp_LEXEMEphp php php php php php php php php php php php=php php1php4php;php php/php/php php'ANDphp'php orphp php'andphp'
php php php php constphp TTphp_ORphp_LEXEMEphp php php php php php php php php php php php php=php php1php5php;php php/php/php php'ORphp'php php orphp php'orphp'
php php php php constphp TTphp_NOTphp_LEXEMEphp php php php php php php php php php php php=php php1php6php;php php/php/php php'NOTphp'php orphp php'notphp'
php php php php constphp TTphp_TOphp_LEXEMEphp php php php php php php php php php php php php=php php1php7php;php php/php/php php'TOphp'php php orphp php'tophp'
php php php php constphp TTphp_NUMBERphp php php php php php php php php php php php php php php php=php php1php8php;php php/php/php Numberphp,php likephp:php php1php0php,php php0php.php8php,php php.php6php4php,php php.php.php.php.


php php php php php/php*php*
php php php php php php*php Returnsphp allphp possiblephp lexemephp typesphp.
php php php php php php*php Itphp'sphp usedphp forphp syntaxphp analyzerphp statephp machinephp initialization
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp staticphp functionphp getTypesphp(php)
php php php php php{
php php php php php php php php returnphp arrayphp(php php php selfphp:php:TTphp_WORDphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_PHRASEphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_FIELDphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_FIELDphp_INDICATORphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_REQUIREDphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_PROHIBITEDphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_FUZZYphp_PROXphp_MARKphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_BOOSTINGphp_MARKphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_RANGEphp_INCLphp_STARTphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_RANGEphp_INCLphp_ENDphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_RANGEphp_EXCLphp_STARTphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_RANGEphp_EXCLphp_ENDphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_SUBQUERYphp_STARTphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_SUBQUERYphp_ENDphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_ANDphp_LEXEMEphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_ORphp_LEXEMEphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_NOTphp_LEXEMEphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_TOphp_LEXEMEphp,
php php php php php php php php php php php php php php php php php php php php php php php php selfphp:php:TTphp_NUMBER
php php php php php php php php php php php php php php php php php php php php php php)php;
php php php php php}


php php php php php/php*php*
php php php php php php*php TokenCategories
php php php php php php*php/
php php php php constphp TCphp_WORDphp php php php php php php php php php php php=php php0php;php php php php/php/php Word
php php php php constphp TCphp_PHRASEphp php php php php php php php php php=php php1php;php php php php/php/php Phrasephp php(onephp orphp severalphp quotedphp wordsphp)
php php php php constphp TCphp_NUMBERphp php php php php php php php php php=php php2php;php php php php/php/php Nubersphp,php whichphp arephp usedphp withphp syntaxphp elementsphp.php Exphp.php roamphp~php0php.php8
php php php php constphp TCphp_SYNTAXphp_ELEMENTphp php=php php3php;php php php php/php/php php+php php php-php php php(php php)php php php[php php]php php php{php php}php php php!php php php|php|php php php&php&php php~php php^


php php php php php/php*php*
php php php php php php*php Tokenphp typephp.
php php php php php php*
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php publicphp php$typephp;

php php php php php/php*php*
php php php php php php*php Tokenphp textphp.
php php php php php php*
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php publicphp php$textphp;

php php php php php/php*php*
php php php php php php*php Tokenphp positionphp withinphp queryphp.
php php php php php php*
php php php php php php*php php@varphp integer
php php php php php php*php/
php php php php publicphp php$positionphp;


php php php php php/php*php*
php php php php php php*php IndexReaderphp constructorphp needsphp tokenphp typephp andphp tokenphp textphp asphp aphp parametersphp.
php php php php php php*
php php php php php php*php php@paramphp integerphp php$tokenCategory
php php php php php php*php php@paramphp stringphp php php$tokText
php php php php php php*php php@paramphp integerphp php$position
php php php php php php*php/
php php php php publicphp functionphp php_php_constructphp(php$tokenCategoryphp,php php$tokenTextphp,php php$positionphp)
php php php php php{
php php php php php php php php php$thisphp-php>textphp php php php php php=php php$tokenTextphp;
php php php php php php php php php$thisphp-php>positionphp php=php php$positionphp php+php php1php;php php/php/php Startphp fromphp php1

php php php php php php php php switchphp php(php$tokenCategoryphp)php php{
php php php php php php php php php php php php casephp selfphp:php:TCphp_WORDphp:
php php php php php php php php php php php php php php php php ifphp php(php php strtolowerphp(php$tokenTextphp)php php=php=php php'andphp'php)php php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_ANDphp_LEXEMEphp;
php php php php php php php php php php php php php php php php php}php elsephp ifphp php(strtolowerphp(php$tokenTextphp)php php=php=php php'orphp'php)php php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_ORphp_LEXEMEphp;
php php php php php php php php php php php php php php php php php}php elsephp ifphp php(strtolowerphp(php$tokenTextphp)php php=php=php php'notphp'php)php php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_NOTphp_LEXEMEphp;
php php php php php php php php php php php php php php php php php}php elsephp ifphp php(strtolowerphp(php$tokenTextphp)php php=php=php php'tophp'php)php php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_TOphp_LEXEMEphp;
php php php php php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_WORDphp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php casephp selfphp:php:TCphp_PHRASEphp:
php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_PHRASEphp;
php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php casephp selfphp:php:TCphp_NUMBERphp:
php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_NUMBERphp;
php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php casephp selfphp:php:TCphp_SYNTAXphp_ELEMENTphp:
php php php php php php php php php php php php php php php php switchphp php(php$tokenTextphp)php php{
php php php php php php php php php php php php php php php php php php php php casephp php'php:php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_FIELDphp_INDICATORphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php+php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_REQUIREDphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php-php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_PROHIBITEDphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php~php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_FUZZYphp_PROXphp_MARKphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php^php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_BOOSTINGphp_MARKphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php[php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_RANGEphp_INCLphp_STARTphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php]php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_RANGEphp_INCLphp_ENDphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php{php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_RANGEphp_EXCLphp_STARTphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php}php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_RANGEphp_EXCLphp_ENDphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php(php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_SUBQUERYphp_STARTphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php)php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_SUBQUERYphp_ENDphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php!php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_NOTphp_LEXEMEphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php&php&php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_ANDphp_LEXEMEphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php casephp php'php|php|php'php:
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_ORphp_LEXEMEphp;
php php php php php php php php php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php php php php php php php php php defaultphp:
php php php php php php php php php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Searchphp/Lucenephp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Searchphp_Lucenephp_Exceptionphp(php'Unrecognizedphp queryphp syntaxphp lexemephp:php php\php'php'php php.php php$tokenTextphp php.php php'php\php'php'php)php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php breakphp;

php php php php php php php php php php php php casephp selfphp:php:TCphp_NUMBERphp:
php php php php php php php php php php php php php php php php php$thisphp-php>typephp php=php selfphp:php:TTphp_NUMBERphp;

php php php php php php php php php php php php defaultphp:
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Searchphp/Lucenephp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Searchphp_Lucenephp_Exceptionphp(php'Unrecognizedphp lexemephp typephp:php php\php'php'php php.php php$tokenCategoryphp php.php php'php\php'php'php)php;
php php php php php php php php php}
php php php php php}
php}
