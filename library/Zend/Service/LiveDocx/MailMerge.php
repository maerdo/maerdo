<php?php
php/php*php*
php php*php Zendphp Framework
php php*
php php*php LICENSE
php php*
php php*php Thisphp sourcephp filephp isphp subjectphp tophp thephp newphp BSDphp licensephp thatphp isphp bundled
php php*php withphp thisphp packagephp inphp thephp filephp LICENSEphp.txtphp.
php php*php Itphp isphp alsophp availablephp throughphp thephp worldphp-widephp-webphp atphp thisphp URLphp:
php php*php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsd
php php*php Ifphp youphp didphp notphp receivephp aphp copyphp ofphp thephp licensephp andphp arephp unablephp to
php php*php obtainphp itphp throughphp thephp worldphp-widephp-webphp,php pleasephp sendphp anphp email
php php*php tophp licensephp@zendphp.comphp sophp wephp canphp sendphp youphp aphp copyphp immediatelyphp.
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Service
php php*php php@subpackagephp LiveDocx
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@versionphp php php php php$Idphp:php MailMergephp.phpphp php2php3php4php8php4php php2php0php1php0php-php1php2php-php1php0php php0php3php:php5php7php:php5php9Zphp mjhphp_caphp php$
php php*php/

php/php*php*php Zendphp_Datephp php*php*php/
requirephp_oncephp php'Zendphp/Datephp.phpphp'php;

php/php*php*php Zendphp_Servicephp_LiveDocxphp php*php*php/
requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp.phpphp'php;

php/php*php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Service
php php*php php@subpackagephp LiveDocx
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@sincephp php php php php php LiveDocxphp php1php.php0
php php*php/
classphp Zendphp_Servicephp_LiveDocxphp_MailMergephp extendsphp Zendphp_Servicephp_LiveDocx
php{
php php php php php/php*php*
php php php php php php*php URIphp ofphp LiveDocxphp.MailMergephp WSDL
php php php php php php*php php@sincephp LiveDocxphp php1php.php0
php php php php php php*php/
php php php php php/php/constphp WSDLphp php=php php'httpsphp:php/php/apiphp.livedocxphp.comphp/php1php.php2php/mailmergephp.asmxphp?WSDLphp'php;
php php php php constphp WSDLphp php=php php'httpsphp:php/php/apiphp.livedocxphp.comphp/php2php.php0php/mailmergephp.asmxphp?WSDLphp'php;

php php php php php/php*php*
php php php php php php*php Fieldphp values
php php php php php php*
php php php php php php*php php@varphp php php array
php php php php php php*php php@sincephp LiveDocxphp php1php.php0
php php php php php php*php/
php php php php protectedphp php$php_fieldValuesphp;

php php php php php/php*php*
php php php php php php*php Blockphp fieldphp values
php php php php php php*
php php php php php php*php php@varphp php php array
php php php php php php*php php@sincephp LiveDocxphp php1php.php0
php php php php php php*php/
php php php php protectedphp php$php_blockFieldValuesphp;

php php php php php/php*php*
php php php php php php*php Constructorphp php(LiveDocxphp.MailMergephp SOAPphp Servicephp)
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php php@returnphp throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp php_php_constructphp(php$optionsphp php=php nullphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_wsdlphp php php php php php php php php php php php php php=php selfphp:php:WSDLphp;
php php php php php php php php php$thisphp-php>php_fieldValuesphp php php php php php php=php arrayphp(php)php;
php php php php php php php php php$thisphp-php>php_blockFieldValuesphp php=php arrayphp(php)php;

php php php php php php php php parentphp:php:php_php_constructphp(php$optionsphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp thephp filenamephp ofphp aphp LOCALphp template
php php php php php php*php php(iphp.ephp.php aphp templatephp storedphp locallyphp onphp YOURphp serverphp)
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocxphp_MailMerge
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp setLocalTemplatephp(php$filenamephp)
php php php php php{
php php php php php php php php ifphp php(php!isphp_readablephp(php$filenamephp)php)php php{
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp readphp localphp templatephp fromphp diskphp.php'
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>SetLocalTemplatephp(arrayphp(
php php php php php php php php php php php php php php php php php'templatephp'php php=php>php basephp6php4php_encodephp(filephp_getphp_contentsphp(php$filenamephp)php)php,
php php php php php php php php php php php php php php php php php'formatphp'php php php php=php>php selfphp:php:getFormatphp(php$filenamephp)php,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp setphp localphp templatephp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp thephp filenamephp ofphp aphp REMOTEphp template
php php php php php php*php php(iphp.ephp.php aphp templatephp storedphp remotelyphp onphp thephp LIVEDOCXphp serverphp)
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocxphp_MailMerge
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp setRemoteTemplatephp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>SetRemoteTemplatephp(arrayphp(
php php php php php php php php php php php php php php php php php'filenamephp'php php=php>php php$filenamephp,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp setphp remotephp templatephp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp anphp associativephp orphp multiphp-associativephp arrayphp ofphp keysphp andphp valuesphp pairs
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$values
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocxphp_MailMerge
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp setFieldValuesphp(php$valuesphp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php foreachphp php(php$valuesphp asphp php$valuephp)php php{
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$valuephp)php)php php{
php php php php php php php php php php php php php php php php php$methodphp php=php php'multiAssocArrayToArrayOfArrayOfStringphp'php;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$methodphp php=php php'assocArrayToArrayOfArrayOfStringphp'php;
php php php php php php php php php php php php php}
php php php php php php php php php php php php breakphp;
php php php php php php php php php}

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>SetFieldValuesphp(arrayphp(
php php php php php php php php php php php php php php php php php'fieldValuesphp'php php=php>php selfphp:php:php$methodphp(php$valuesphp)php,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp setphp fieldphp valuesphp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp anphp arrayphp ofphp keyphp andphp valuephp orphp arrayphp ofphp values
php php php php php php*
php php php php php php*php php@paramphp stringphp php$field
php php php php php php*php php@paramphp arrayphp|stringphp php$value
php php php php php php*
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocxphp_MailMerge
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp setFieldValuephp(php$fieldphp,php php$valuephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_fieldValuesphp[php$fieldphp]php php=php php$valuephp;

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp blockphp fieldphp values
php php php php php php*
php php php php php php*php php@paramphp stringphp php$blockName
php php php php php php*php php@paramphp arrayphp php$blockFieldValues
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocxphp_MailMerge
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp setBlockFieldValuesphp(php$blockNamephp,php php$blockFieldValuesphp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>SetBlockFieldValuesphp(arrayphp(
php php php php php php php php php php php php php php php php php'blockNamephp'php php php php php php php php php=php>php php$blockNamephp,
php php php php php php php php php php php php php php php php php'blockFieldValuesphp'php php=php>php selfphp:php:multiAssocArrayToArrayOfArrayOfStringphp(php$blockFieldValuesphp)
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp setphp blockphp fieldphp valuesphp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Assignphp valuesphp tophp templatephp fields
php php php php php php*
php php php php php php*php php@paramphp arrayphp|stringphp php$field
php php php php php php*php php@paramphp arrayphp|stringphp php$value
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocxphp_MailMerge
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp assignphp(php$fieldphp,php php$valuephp php=php nullphp)
php php php php php{
php php php php php php php php tryphp php{
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$fieldphp)php php&php&php php(nullphp php=php=php=php php$valuephp)php)php php{
php php php php php php php php php php php php php php php php foreachphp php(php$fieldphp asphp php$fieldNamephp php=php>php php$fieldValuephp)php php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>setFieldValuephp(php$fieldNamephp,php php$fieldValuephp)php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elseifphp php(isphp_arrayphp(php$valuephp)php)php php{
php php php php php php php php php php php php php php php php php$thisphp-php>setBlockFieldValuesphp(php$fieldphp,php php$valuephp)php;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$thisphp-php>setFieldValuephp(php$fieldphp,php php$valuephp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp assignphp dataphp tophp templatephp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp aphp passwordphp tophp openphp tophp document
php php php php php php*
php php php php php php*php Thisphp methodphp canphp onlyphp bephp usedphp forphp PDFphp documents
php php php php php php*
php php php php php php*php php@paramphp php stringphp php php$password
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocxphp_MailMerge
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2php Premium
php php php php php php*php/
php php php php publicphp functionphp setDocumentPasswordphp(php$passwordphp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>SetDocumentPasswordphp(arrayphp(
php php php php php php php php php php php php php php php php php'passwordphp'php php=php>php php$password
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp setphp documentphp passwordphp.php Thisphp methodphp canphp bephp usedphp onphp PDFphp filesphp onlyphp.php'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp aphp masterphp passwordphp forphp documentphp andphp determinephp whichphp securityphp features
php php php php php php*php arephp accessiblephp withoutphp usingphp thephp masterphp passwordphp.
php php php php php php*
php php php php php php*php Asphp defaultphp,php nothingphp isphp allowedphp.php Tophp allowphp aphp securityphp settingphp,
php php php php php php*php explicativelyphp setphp itphp usingphp onephp ofphp hephp DOCUMENTphp_ACCESSphp_PERMISSIONphp_php*php class
php php php php php php*php constantsphp.
php php php php php php*
php php php php php php*php php{codephp}
php php php php php php*php php$phpLiveDocxphp-php>setDocumentAccessPermissionsphp(
php php php php php php*php php php php php arrayphp php(
php php php php php php*php php php php php php php php php Zendphp_Servicephp_LiveDocxphp_MailMergephp:php:DOCUMENTphp_ACCESSphp_PERMISSIONphp_ALLOWphp_PRINTINGphp_HIGHphp_LEVELphp,
php php php php php php*php php php php php php php php php Zendphp_Servicephp_LiveDocxphp_MailMergephp:php:DOCUMENTphp_ACCESSphp_PERMISSIONphp_ALLOWphp_EXTRACTphp_CONTENTS
php php php php php php*php php php php php php)php,
php php php php php php*php php php php php php'myDocumentAccessPasswordphp'
php php php php php php*php php)php;
php php php php php php*php php{codephp}
php php php php php php*
php php php php php php*php Thisphp methodphp canphp onlyphp bephp usedphp forphp PDFphp documents
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php php$permissions
php php php php php php*php php@paramphp php stringphp php$password
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocxphp_MailMerge
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2php Premium
php php php php php php*php/
php php php php publicphp functionphp setDocumentAccessPermissionsphp(php$permissionsphp,php php$passwordphp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>SetDocumentAccessPermissionsphp(arrayphp(
php php php php php php php php php php php php php php php php php'permissionsphp'php php=php>php php$permissionsphp,
php php php php php php php php php php php php php php php php php'passwordphp'php php php php php=php>php php$password
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp setphp documentphp accessphp permissionsphp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Mergephp assignedphp dataphp withphp templatephp tophp generatephp document
php php php php php php*
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Excpetion
php php php php php php*php php@returnphp void
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp createDocumentphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php ifphp php(countphp(php$thisphp-php>php_fieldValuesphp)php php>php php0php)php php{
php php php php php php php php php php php php php$thisphp-php>setFieldValuesphp(php$thisphp-php>php_fieldValuesphp)php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_fieldValuesphp php php php php php php=php arrayphp(php)php;
php php php php php php php php php$thisphp-php>php_blockFieldValuesphp php=php arrayphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>CreateDocumentphp(php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp createphp documentphp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp documentphp inphp specifiedphp format
php php php php php php*
php php php php php php*php php@paramphp stringphp php$format
php php php php php php*
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@returnphp binary
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp retrieveDocumentphp(php$formatphp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$formatphp php=php strtolowerphp(php$formatphp)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>RetrieveDocumentphp(arrayphp(
php php php php php php php php php php php php php php php php php'formatphp'php php=php>php php$formatphp,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp retrievephp documentphp php-php callphp setLocalTemplatephp(php)php orphp setRemoteTemplatephp(php)php firstphp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp basephp6php4php_decodephp(php$resultphp-php>RetrieveDocumentResultphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp WMFphp php(akaphp Windowsphp metafilephp)php dataphp forphp specifiedphp pagephp rangephp ofphp createdphp document
php php php php php php*php Returnphp arrayphp containsphp WMFphp dataphp php(binaryphp)php php-php arrayphp keyphp isphp pagephp number
php php php php php php*
php php php php php php*php php@paramphp php integerphp php$fromPage
php php php php php php*php php@paramphp php integerphp php$toPage
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp getMetafilesphp(php$fromPagephp,php php$toPagephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetMetafilesphp(arrayphp(
php php php php php php php php php php php php php'fromPagephp'php php=php>php php(integerphp)php php$fromPagephp,
php php php php php php php php php php php php php'toPagephp'php php php php=php>php php(integerphp)php php$toPagephp,
php php php php php php php php php)php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetMetafilesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$pageCounterphp php=php php(integerphp)php php$fromPagephp;
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$resultphp-php>GetMetafilesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php php php php foreachphp php(php$resultphp-php>GetMetafilesResultphp-php>stringphp asphp php$stringphp)php php{
php php php php php php php php php php php php php php php php php php php php php$retphp[php$pageCounterphp]php php=php basephp6php4php_decodephp(php$stringphp)php;
php php php php php php php php php php php php php php php php php php php php php$pageCounterphp+php+php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php$retphp[php$pageCounterphp]php php=php basephp6php4php_decodephp(php$resultphp-php>GetMetafilesResultphp-php>stringphp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp WMFphp php(akaphp Windowsphp metafilephp)php dataphp forphp pagesphp ofphp createdphp document
php php php php php php*php Returnphp arrayphp containsphp WMFphp dataphp php(binaryphp)php php-php arrayphp keyphp isphp pagephp number
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp getAllMetafilesphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetAllMetafilesphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetAllMetafilesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$pageCounterphp php=php php1php;
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$resultphp-php>GetAllMetafilesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php php php php foreachphp php(php$resultphp-php>GetAllMetafilesResultphp-php>stringphp asphp php$stringphp)php php{
php php php php php php php php php php php php php php php php php php php php php$retphp[php$pageCounterphp]php php=php basephp6php4php_decodephp(php$stringphp)php;
php php php php php php php php php php php php php php php php php php php php php$pageCounterphp+php+php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php$retphp[php$pageCounterphp]php php=php basephp6php4php_decodephp(php$resultphp-php>GetAllMetafilesResultphp-php>stringphp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp graphicalphp bitmapphp dataphp forphp specifiedphp pagephp rangephp ofphp createdphp document
php php php php php php*php Returnphp arrayphp containsphp bitmapphp dataphp php(binaryphp)php php-php arrayphp keyphp isphp pagephp number
php php php php php php*
php php php php php php*php php@paramphp php integerphp php$fromPage
php php php php php php*php php@paramphp php integerphp php$toPage
php php php php php php*php php@paramphp php integerphp php$zoomFactor
php php php php php php*php php@paramphp php stringphp php php$format
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp getBitmapsphp(php$fromPagephp,php php$toPagephp,php php$zoomFactorphp,php php$formatphp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php=php arrayphp(php)php;

php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetBitmapsphp(arrayphp(
php php php php php php php php php php php php php'fromPagephp'php php php php=php>php php(integerphp)php php$fromPagephp,
php php php php php php php php php php php php php'toPagephp'php php php php php php=php>php php(integerphp)php php$toPagephp,
php php php php php php php php php php php php php'zoomFactorphp'php php=php>php php(integerphp)php php$zoomFactorphp,
php php php php php php php php php php php php php'formatphp'php php php php php php=php>php php(stringphp)php php php$formatphp,
php php php php php php php php php)php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetBitmapsResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$pageCounterphp php=php php(integerphp)php php$fromPagephp;
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$resultphp-php>GetBitmapsResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php php php php foreachphp php(php$resultphp-php>GetBitmapsResultphp-php>stringphp asphp php$stringphp)php php{
php php php php php php php php php php php php php php php php php php php php php$retphp[php$pageCounterphp]php php=php basephp6php4php_decodephp(php$stringphp)php;
php php php php php php php php php php php php php php php php php php php php php$pageCounterphp+php+php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php$retphp[php$pageCounterphp]php php=php basephp6php4php_decodephp(php$resultphp-php>GetBitmapsResultphp-php>stringphp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp graphicalphp bitmapphp dataphp forphp allphp pagesphp ofphp createdphp document
php php php php php php*php Returnphp arrayphp containsphp bitmapphp dataphp php(binaryphp)php php-php arrayphp keyphp isphp pagephp number
php php php php php php*
php php php php php php*php php@paramphp php integerphp php$zoomFactor
php php php php php php*php php@paramphp php stringphp php php$format
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp getAllBitmapsphp(php$zoomFactorphp,php php$formatphp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetAllBitmapsphp(arrayphp(
php php php php php php php php php php php php php'zoomFactorphp'php php=php>php php(integerphp)php php$zoomFactorphp,
php php php php php php php php php php php php php'formatphp'php php php php php php=php>php php(stringphp)php php php$formatphp,
php php php php php php php php php)php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetAllBitmapsResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$pageCounterphp php=php php1php;
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$resultphp-php>GetAllBitmapsResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php php php php foreachphp php(php$resultphp-php>GetAllBitmapsResultphp-php>stringphp asphp php$stringphp)php php{
php php php php php php php php php php php php php php php php php php php php php$retphp[php$pageCounterphp]php php=php basephp6php4php_decodephp(php$stringphp)php;
php php php php php php php php php php php php php php php php php php php php php$pageCounterphp+php+php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php$retphp[php$pageCounterphp]php php=php basephp6php4php_decodephp(php$resultphp-php>GetAllBitmapsResultphp-php>stringphp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp allphp thephp fieldsphp inphp thephp template
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp getFieldNamesphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetFieldNamesphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetFieldNamesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$resultphp-php>GetFieldNamesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php php php php php$retphp php=php php$resultphp-php>GetFieldNamesResultphp-php>stringphp;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$retphp[php]php php=php php$resultphp-php>GetFieldNamesResultphp-php>stringphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp allphp thephp blockphp fieldsphp inphp thephp template
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$blockName
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp getBlockFieldNamesphp(php$blockNamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetBlockFieldNamesphp(arrayphp(
php php php php php php php php php php php php php'blockNamephp'php php=php>php php$blockName
php php php php php php php php php)php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetBlockFieldNamesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$resultphp-php>GetBlockFieldNamesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php php php php php$retphp php=php php$resultphp-php>GetBlockFieldNamesResultphp-php>stringphp;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$retphp[php]php php=php php$resultphp-php>GetBlockFieldNamesResultphp-php>stringphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp allphp thephp blockphp fieldsphp inphp thephp template
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp getBlockNamesphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetBlockNamesphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetBlockNamesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$resultphp-php>GetBlockNamesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php php php php php$retphp php=php php$resultphp-php>GetBlockNamesResultphp-php>stringphp;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$retphp[php]php php=php php$resultphp-php>GetBlockNamesResultphp-php>stringphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Uploadphp aphp templatephp filephp tophp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp void
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp uploadTemplatephp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>UploadTemplatephp(arrayphp(
php php php php php php php php php php php php php php php php php'templatephp'php php=php>php basephp6php4php_encodephp(filephp_getphp_contentsphp(php$filenamephp)php)php,
php php php php php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp uploadphp templatephp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Downloadphp templatephp filephp fromphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp binary
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp downloadTemplatephp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>DownloadTemplatephp(arrayphp(
php php php php php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp downloadphp templatephp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp basephp6php4php_decodephp(php$resultphp-php>DownloadTemplateResultphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Deletephp aphp templatephp filephp fromphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp void
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp deleteTemplatephp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>DeleteTemplatephp(arrayphp(
php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php)php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Listphp allphp templatesphp storedphp onphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp listTemplatesphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>ListTemplatesphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>ListTemplatesResultphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php$thisphp-php>php_backendListArrayToMultiAssocArrayphp(php$resultphp-php>ListTemplatesResultphp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Checkphp whetherphp aphp templatephp filephp isphp availablephp onphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp boolean
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp templateExistsphp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>TemplateExistsphp(arrayphp(
php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php)php)php;

php php php php php php php php returnphp php(booleanphp)php php$resultphp-php>TemplateExistsResultphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Sharephp aphp documentphp php-php iphp.ephp.php thephp documentphp isphp availablephp tophp allphp overphp thephp Internet
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp shareDocumentphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php nullphp;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>ShareDocumentphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>ShareDocumentResultphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php(stringphp)php php$resultphp-php>ShareDocumentResultphp;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Listphp allphp sharedphp documentsphp storedphp onphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp listSharedDocumentsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>ListSharedDocumentsphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>ListSharedDocumentsResultphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php$thisphp-php>php_backendListArrayToMultiAssocArrayphp(
php php php php php php php php php php php php php php php php php$resultphp-php>ListSharedDocumentsResult
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Deletephp aphp sharedphp documentphp fromphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp void
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp deleteSharedDocumentphp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>DeleteSharedDocumentphp(arrayphp(
php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php)php)php;
php php php php php}

php php php php php/php*
php php php php php php*php Downloadphp aphp sharedphp documentphp fromphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp binary
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp downloadSharedDocumentphp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>DownloadSharedDocumentphp(arrayphp(
php php php php php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp downloadphp sharedphp documentphp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp basephp6php4php_decodephp(php$resultphp-php>DownloadSharedDocumentResultphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Checkphp whetherphp aphp sharedphp documentphp isphp availablephp onphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp boolean
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp sharedDocumentExistsphp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php php php php php php php php php php=php falsephp;
php php php php php php php php php$sharedDocumentsphp php=php php$thisphp-php>listSharedDocumentsphp(php)php;
php php php php php php php php foreachphp php(php$sharedDocumentsphp asphp php$shareDocumentphp)php php{
php php php php php php php php php php php php ifphp php(issetphp(php$shareDocumentphp[php'filenamephp'php]php)
php php php php php php php php php php php php php php php php php&php&php php(basenamephp(php$filenamephp)php php=php=php=php php$shareDocumentphp[php'filenamephp'php]php)
php php php php php php php php php php php php php)php php{
php php php php php php php php php php php php php php php php php$retphp php=php truephp;
php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp supportedphp templatephp formatsphp php(lowercasephp)
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp getTemplateFormatsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetTemplateFormatsphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetTemplateFormatsResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php$resultphp-php>GetTemplateFormatsResultphp-php>stringphp;
php php php php php php php php php php php php php$retphp php=php arrayphp_mapphp(php'strtolowerphp'php,php php$retphp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp supportedphp documentphp formatsphp php(lowercasephp)
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php1
php php php php php php*php/
php php php php publicphp functionphp getDocumentFormatsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetDocumentFormatsphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetDocumentFormatsResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php$resultphp-php>GetDocumentFormatsResultphp-php>stringphp;
php php php php php php php php php php php php php$retphp php=php arrayphp_mapphp(php'strtolowerphp'php,php php$retphp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp thephp namesphp ofphp allphp fontsphp thatphp arephp installedphp onphp backendphp server
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp getFontNamesphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetFontNamesphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetFontNamesResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php$resultphp-php>GetFontNamesResultphp-php>stringphp;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp supportedphp documentphp accessphp options
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2php Premium
php php php php php php*php/
php php php php publicphp functionphp getDocumentAccessOptionsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetDocumentAccessOptionsphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetDocumentAccessOptionsResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php$resultphp-php>GetDocumentAccessOptionsResultphp-php>stringphp;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp supportedphp imagephp formatsphp fromphp whichphp canphp bephp importedphp php(lowercasephp)
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php2php.php0
php php php php php php*php/
php php php php publicphp functionphp getImageImportFormatsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetImageImportFormatsphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetImageImportFormatsResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php$resultphp-php>GetImageImportFormatsResultphp-php>stringphp;
php php php php php php php php php php php php php$retphp php=php arrayphp_mapphp(php'strtolowerphp'php,php php$retphp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp supportedphp imagephp formatsphp tophp whichphp canphp bephp exportedphp php(lowercasephp)
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php2php.php0
php php php php php php*php/
php php php php publicphp functionphp getImageExportFormatsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>GetImageExportFormatsphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>GetImageExportFormatsResultphp-php>stringphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php$resultphp-php>GetImageExportFormatsResultphp-php>stringphp;
php php php php php php php php php php php php php$retphp php=php arrayphp_mapphp(php'strtolowerphp'php,php php$retphp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*
php php php php php php*php Returnphp supportedphp imagephp formatsphp php(lowercasephp)
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php php@deprecatedphp sincephp LiveDocxphp php2php.php0
php php php php php php*php/
php php php php publicphp functionphp getImageFormatsphp(php)
php php php php php{
php php php php php php php php php$replacementphp php=php php'getImageExportFormatsphp'php;

php php php php php php php php php/php*
php php php php php php php php php$errorMessagephp php=php sprintfphp(
php php php php php php php php php php php php php php php php php php php php php php php php php"php%sphp:php:php%sphp isphp deprecatedphp asphp ofphp LiveDocxphp php2php.php0php.php php"
php php php php php php php php php php php php php php php php php php php php php php php.php php"Itphp hasphp beenphp replacedphp byphp php%sphp:php:php%sphp(php)php php(dropphp inphp replacementphp)php"php,
php php php php php php php php php php php php php php php php php php php php php php php php php_php_CLASSphp_php_php,php php_php_FUNCTIONphp_php_php,php php_php_CLASSphp_php_php,php php$replacementphp)php;

php php php php php php php php triggerphp_errorphp(php$errorMessagephp,php Ephp_USERphp_NOTICEphp)php;
php php php php php php php php php*php/

php php php php php php php php returnphp php$thisphp-php>php$replacementphp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Uploadphp anphp imagephp filephp tophp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp void
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php2php.php0
php php php php php php*php/
php php php php publicphp functionphp uploadImagephp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>UploadImagephp(arrayphp(
php php php php php php php php php php php php php php php php php'imagephp'php php php php php=php>php basephp6php4php_encodephp(filephp_getphp_contentsphp(php$filenamephp)php)php,
php php php php php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp uploadphp imagephp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Downloadphp anphp imagephp filephp fromphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp void
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php2php.php0
php php php php php php*php/
php php php php publicphp functionphp downloadImagephp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php tryphp php{
php php php php php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>DownloadImagephp(arrayphp(
php php php php php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php php php php php)php)php;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php'Cannotphp downloadphp imagephp'php,php php0php,php php$e
php php php php php php php php php php php php php)php;
php php php php php php php php php}

php php php php php php php php returnphp basephp6php4php_decodephp(php$resultphp-php>DownloadImageResultphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Listphp allphp imagesphp storedphp onphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php2php.php0
php php php php php php*php/
php php php php publicphp functionphp listImagesphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php php php php=php arrayphp(php)php;
php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>ListImagesphp(php)php;

php php php php php php php php ifphp php(issetphp(php$resultphp-php>ListImagesResultphp)php)php php{
php php php php php php php php php php php php php$retphp php=php php$thisphp-php>php_backendListArrayToMultiAssocArrayphp(php$resultphp-php>ListImagesResultphp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Deletephp anphp imagephp filephp fromphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp void
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php2php.php0
php php php php php php*php/
php php php php publicphp functionphp deleteImagephp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>DeleteImagephp(arrayphp(
php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php)php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Checkphp whetherphp anphp imagephp filephp isphp availablephp onphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp boolean
php php php php php php*php php@sincephp php LiveDocxphp php2php.php0
php php php php php php*php/
php php php php publicphp functionphp imageExistsphp(php$filenamephp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$resultphp php=php php$thisphp-php>getSoapClientphp(php)php-php>ImageExistsphp(arrayphp(
php php php php php php php php php php php php php'filenamephp'php php=php>php basenamephp(php$filenamephp)php,
php php php php php php php php php)php)php;

php php php php php php php php returnphp php(booleanphp)php php$resultphp-php>ImageExistsResultphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Convertphp LiveDocxphp servicephp returnphp valuephp fromphp listphp methodsphp tophp consistentphp PHPphp array
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$list
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php protectedphp functionphp php_backendListArrayToMultiAssocArrayphp(php$listphp)
php php php php php{
php php php php php php php php php$thisphp-php>logInphp(php)php;

php php php php php php php php php$retphp php=php arrayphp(php)php;
php php php php php php php php ifphp php(issetphp(php$listphp-php>ArrayOfStringphp)php)php php{
php php php php php php php php php php php foreachphp php(php$listphp-php>ArrayOfStringphp asphp php$aphp)php php{
php php php php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$aphp)php)php php{php php php php php php php/php/php php1php templatephp only
php php php php php php php php php php php php php php php php php php php php$ophp php=php newphp stdClassphp(php)php;
php php php php php php php php php php php php php php php php php php php php$ophp-php>stringphp php=php php$aphp;
php php php php php php php php php php php php php php php php}php elsephp php{php php php php php php php php php php php php php php php php php php/php/php php2php orphp morephp templates
php php php php php php php php php php php php php php php php php php php php$ophp php=php php$aphp;
php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php unsetphp(php$aphp)php;

php php php php php php php php php php php php php php php ifphp php(issetphp(php$ophp-php>stringphp)php)php php{
php php php php php php php php php php php php php php php php php php php php$datephp1php php=php newphp Zendphp_Datephp(php$ophp-php>stringphp[php3php]php,php Zendphp_Datephp:php:RFCphp_php1php1php2php3php)php;
php php php php php php php php php php php php php php php php php php php php$datephp2php php=php newphp Zendphp_Datephp(php$ophp-php>stringphp[php1php]php,php Zendphp_Datephp:php:RFCphp_php1php1php2php3php)php;

php php php php php php php php php php php php php php php php php php php php$retphp[php]php php=php arrayphp php(
php php php php php php php php php php php php php php php php php php php php php php php php php'filenamephp'php php php php=php>php php$ophp-php>stringphp[php0php]php,
php php php php php php php php php php php php php php php php php php php php php php php php php'fileSizephp'php php php php=php>php php(integerphp)php php$ophp-php>stringphp[php2php]php,
php php php php php php php php php php php php php php php php php php php php php php php php php'createTimephp'php php=php>php php(integerphp)php php$datephp1php-php>getphp(Zendphp_Datephp:php:TIMESTAMPphp)php,
php php php php php php php php php php php php php php php php php php php php php php php php php'modifyTimephp'php php=php>php php(integerphp)php php$datephp2php-php>getphp(Zendphp_Datephp:php:TIMESTAMPphp)php,
php php php php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$retphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Convertphp assocphp arrayphp tophp requiredphp SOAPphp type
php php php php php php*
php php php php php php*php php@paramphp arrayphp php$assoc
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp staticphp functionphp assocArrayToArrayOfArrayOfStringphp(php$assocphp)
php php php php php{
php php php php php php php php php$arrayKeysphp php php php=php arrayphp_keysphp(php$assocphp)php;
php php php php php php php php php$arrayValuesphp php=php arrayphp_valuesphp(php$assocphp)php;

php php php php php php php php returnphp arrayphp(php$arrayKeysphp,php php$arrayValuesphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Convertphp multiphp assocphp arrayphp tophp requiredphp SOAPphp type
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$multi
php php php php php php*php php@returnphp array
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp staticphp functionphp multiAssocArrayToArrayOfArrayOfStringphp(php$multiphp)
php php php php php{
php php php php php php php php php$arrayKeysphp php php php=php arrayphp_keysphp(php$multiphp[php0php]php)php;
php php php php php php php php php$arrayValuesphp php=php arrayphp(php)php;

php php php php php php php php foreachphp php(php$multiphp asphp php$vphp)php php{
php php php php php php php php php php php php php$arrayValuesphp[php]php php=php arrayphp_valuesphp(php$vphp)php;
php php php php php php php php php}

php php php php php php php php php$arrayKeysphp php=php arrayphp(php$arrayKeysphp)php;

php php php php php php php php returnphp arrayphp_mergephp(php$arrayKeysphp,php php$arrayValuesphp)php;
php php php php php}

php php php php php/php/php php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-php-

php}