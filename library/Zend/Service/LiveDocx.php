<php?php
php/php*php*
php php*php Zendphp Framework
php php*
php php*php LICENSE
php php*
php php*php Thisphp sourcephp filephp isphp subjectphp tophp thephp newphp BSDphp licensephp thatphp isphp bundled
php php*php withphp thisphp packagephp inphp thephp filephp LICENSEphp.txtphp.
php php*php Itphp isphp alsophp availablephp throughphp thephp worldphp-widephp-webphp atphp thisphp URLphp:
php php*php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsd
php php*php Ifphp youphp didphp notphp receivephp aphp copyphp ofphp thephp licensephp andphp arephp unablephp to
php php*php obtainphp itphp throughphp thephp worldphp-widephp-webphp,php pleasephp sendphp anphp email
php php*php tophp licensephp@zendphp.comphp sophp wephp canphp sendphp youphp aphp copyphp immediatelyphp.
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Service
php php*php php@subpackagephp LiveDocx
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@versionphp php php php php$Idphp:php LiveDocxphp.phpphp php2php3php4php8php4php php2php0php1php0php-php1php2php-php1php0php php0php3php:php5php7php:php5php9Zphp mjhphp_caphp php$
php php*php/

php/php*php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Service
php php*php php@subpackagephp LiveDocx
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@sincephp php php php php php LiveDocxphp php1php.php0
php php*php/
classphp Zendphp_Servicephp_LiveDocx
php{
php php php php php/php*php*
php php php php php php*php LiveDocxphp servicephp version
php php php php php php*php php@sincephp LiveDocxphp php1php.php0
php php php php php php*php/
php php php php constphp VERSIONphp php=php php'php2php.php0php'php;

php php php php php/php*php*
php php php php php php*php SOAPphp clientphp usedphp tophp connectphp tophp LiveDocxphp service
php php php php php php*php php@varphp php php Zendphp_Soapphp_Client
php php php php php php*php php@sincephp LiveDocxphp php1php.php0
php php php php php php*php/
php php php php protectedphp php$php_soapClientphp;

php php php php php/php*php*
php php php php php php*php WSDLphp ofphp LiveDocxphp webphp service
php php php php php php*php php@varphp php php string
php php php php php php*php php@sincephp LiveDocxphp php1php.php0
php php php php php php*php/
php php php php protectedphp php$php_wsdlphp;

php php php php php/php*php*
php php php php php php*php Arrayphp ofphp credentialsphp php(usernamephp andphp passwordphp)php tophp logphp intophp backendphp server
php php php php php php*php php@varphp php php array
php php php php php php*php php@sincephp LiveDocxphp php1php.php2
php php php php php php*php/
php php php php protectedphp php$php_credentialsphp;

php php php php php/php*php*
php php php php php php*php Setphp tophp truephp,php whenphp sessionphp isphp loggedphp intophp backendphp server
php php php php php php*php php@varphp php php boolean
php php php php php php*php php@sincephp LiveDocxphp php1php.php2
php php php php php php*php/
php php php php protectedphp php$php_loggedInphp;

php php php php php/php*php*
php php php php php php*php Constructor
php php php php php php*
php php php php php php*php Optionallyphp,php passphp anphp arrayphp ofphp optionsphp php(orphp Zendphp_Configphp objectphp)php.
php php php php php php*
php php php php php php*php Ifphp anphp optionphp withphp thephp keyphp php'soapClientphp'php isphp providedphp,php thatphp valuephp willphp be
php php php php php php*php usedphp tophp setphp thephp internalphp SOAPphp clientphp usedphp tophp connectphp tophp thephp LiveDocx
php php php php php php*php servicephp.
php php php php php php*
php php php php php php*php Usephp php'soapClientphp'php inphp thephp casephp thatphp youphp havephp aphp dedicatedphp orphp php(locally
php php php php php php*php installedphp)php licensedphp LiveDocxphp serverphp.php Forphp examplephp:
php php php php php php*
php php php php php php*php php{codephp}
php php php php php php*php php$phpLiveDocxphp php=php newphp Zendphp_Servicephp_LiveDocxphp_MailMergephp(
php php php php php php*php php php php php arrayphp php(
php php php php php php*php php php php php php php php php php'usernamephp'php php php php=php>php php'myUsernamephp'php,
php php php php php php*php php php php php php php php php php'passwordphp'php php php php=php>php php'myPasswordphp'php,
php php php php php php*php php php php php php php php php php'soapClientphp'php php=php>php newphp Zendphp_Soapphp_Clientphp(php'httpsphp:php/php/apiphp.examplephp.comphp/pathphp/mailmergephp.asmxphp?WSDLphp'php)
php php php php php php*php php php php php php)
php php php php php php*php php)php;
php php php php php php*php php{codephp}
php php php php php php*
php php php php php php*php Replacephp thephp URIphp ofphp thephp WSDLphp inphp thephp constructorphp ofphp Zendphp_Soapphp_Clientphp with
php php php php php php*php thatphp ofphp yourphp dedicatedphp orphp licensedphp LiveDocxphp serverphp.
php php php php php php*
php php php php php php*php Ifphp youphp arephp usingphp thephp publicphp LiveDocxphp serverphp,php simplyphp passphp php'usernamephp'php and
php php php php php php*php php'passwordphp'php.php Forphp examplephp:
php php php php php php*
php php php php php php*php php{codephp}
php php php php php php*php php$phpLiveDocxphp php=php newphp Zendphp_Servicephp_LiveDocxphp_MailMergephp(
php php php php php php*php php php php php arrayphp php(
php php php php php php*php php php php php php php php php php'usernamephp'php php=php>php php'myUsernamephp'php,
php php php php php php*php php php php php php php php php php'passwordphp'php php=php>php php'myPasswordphp'
php php php php php php*php php php php php php)
php php php php php php*php php)php;
php php php php php php*php php{codephp}
php php php php php php*
php php php php php php*php Ifphp youphp preferphp tophp notphp passphp thephp usernamephp andphp passwordphp throughphp the
php php php php php php*php constructorphp,php youphp canphp alsophp callphp thephp followingphp methodsphp:
php php php php php php*
php php php php php php*php php{codephp}
php php php php php php*php php$phpLiveDocxphp php=php newphp Zendphp_Servicephp_LiveDocxphp_MailMergephp(php)php;
php php php php php php*
php php php php php php*php php$phpLiveDocxphp-php>setUsernamephp(php'myUsernamephp'php)
php php php php php php*php php php php php php php php php php php php php php-php>setPasswordphp(php'myPasswordphp'php)php;
php php php php php php*php php{php/codephp}
php php php php php php*
php php php php php php*php Orphp,php ifphp youphp wantphp tophp specifyphp yourphp ownphp SoapClientphp:
php php php php php php*
php php php php php php*php php{codephp}
php php php php php php*php php$phpLiveDocxphp php=php newphp Zendphp_Servicephp_LiveDocxphp_MailMergephp(php)php;
php php php php php php*
php php php php php php*php php$phpLiveDocxphp-php>setUsernamephp(php'myUsernamephp'php)
php php php php php php*php php php php php php php php php php php php php php-php>setPasswordphp(php'myPasswordphp'php)php;
php php php php php php*
php php php php php php*php php$phpLiveDocxphp-php>setSoapClientphp(
php php php php php php*php php php php php newphp Zendphp_Soapphp_Clientphp(php'httpsphp:php/php/apiphp.examplephp.comphp/pathphp/mailmergephp.asmxphp?WSDLphp'php)
php php php php php php*php php)php;
php php php php php php*php php{php/codephp}
php php php php php php*
php php php php php php*php php@paramphp php arrayphp|Zendphp_Configphp php$options
php php php php php php*php php@returnphp void
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp php_php_constructphp(php$optionsphp php=php nullphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_credentialsphp php=php arrayphp(php)php;
php php php php php php php php php$thisphp-php>php_loggedInphp php=php falsephp;

php php php php php php php php ifphp php(php$optionsphp instanceofphp Zendphp_Configphp)php php{
php php php php php php php php php php php php php$optionsphp php=php php$optionsphp-php>toArrayphp(php)php;
php php php php php php php php php}

php php php php php php php php ifphp php(isphp_arrayphp(php$optionsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>setOptionsphp(php$optionsphp)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp options
php php php php php php*php Onephp orphp morephp ofphp usernamephp,php passwordphp,php soapClient
php php php php php php*
php php php php php php*php php@paramphp php php$options
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocx
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp setOptionsphp(arrayphp php$optionsphp)
php php php php php{
php php php php php php php php foreachphp php(php$optionsphp asphp php$keyphp php=php>php php$valuephp)php php{
php php php php php php php php php php php php php$methodphp php=php php'setphp'php php.php php$keyphp;
php php php php php php php php php php php php ifphp php(methodphp_existsphp(php$thisphp,php php$methodphp)php)php php{
php php php php php php php php php php php php php php php php php$thisphp-php>php$methodphp(php$valuephp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Cleanphp upphp andphp logphp outphp ofphp LiveDocxphp service
php php php php php php*
php php php php php php*php php@returnphp boolean
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp php_php_destructphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>logOutphp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Initphp Soapphp clientphp php-php connectphp tophp SOAPphp service
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$endpoint
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@returnphp void
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php protectedphp functionphp php_initSoapClientphp(php$endpointphp)
php php php php php{
php php php php php php php php tryphp php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Soapphp/Clientphp.phpphp'php;
php php php php php php php php php php php php php$thisphp-php>php_soapClientphp php=php newphp Zendphp_Soapphp_Clientphp(php)php;
php php php php php php php php php php php php php$thisphp-php>php_soapClientphp-php>setWsdlphp(php$endpointphp)php;
php php php php php php php php php}php catchphp php(Zendphp_Soapphp_Clientphp_Exceptionphp php$ephp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(php'Cannotphp connectphp tophp LiveDocxphp servicephp atphp php'php php.php php$endpointphp,php php0php,php php$ephp)php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp SOAPphp client
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Soapphp_Client
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp getSoapClientphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_soapClientphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp SOAPphp client
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Soapphp_Clientphp php$soapClient
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocx
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp setSoapClientphp(Zendphp_Soapphp_Clientphp php$soapClientphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_soapClientphp php=php php$soapClientphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Logphp inphp tophp LiveDocxphp service
php php php php php php*
php php php php php php*php php@paramphp stringphp php$username
php php php php php php*php php@paramphp stringphp php$password
php php php php php php*
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@returnphp boolean
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp logInphp(php)
php php php php php{
php php php php php php php php ifphp php(php!php$thisphp-php>isLoggedInphp(php)php)php php{
php php php php php php php php php php php php ifphp php(nullphp php=php=php=php php$thisphp-php>getUsernamephp(php)php)php php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php php php php php'Usernamephp hasphp notphp beenphp setphp.php Tophp setphp usernamephp specifyphp thephp optionsphp arrayphp inphp thephp constructorphp orphp callphp setUsernamephp(php$usernamephp)php afterphp instantiationphp'
php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php ifphp php(nullphp php=php=php=php php$thisphp-php>getPasswordphp(php)php)php php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php php php php php'Passwordphp hasphp notphp beenphp setphp.php Tophp setphp passwordphp specifyphp thephp optionsphp arrayphp inphp thephp constructorphp orphp callphp setPasswordphp(php$passwordphp)php afterphp instantiationphp'
php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php ifphp php(nullphp php=php=php=php php$thisphp-php>getSoapClientphp(php)php)php php{
php php php php php php php php php php php php php php php php php$thisphp-php>php_initSoapClientphp(php$thisphp-php>php_wsdlphp)php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php tryphp php{
php php php php php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>LogInphp(arrayphp(
php php php php php php php php php php php php php php php php php php php php php'usernamephp'php php=php>php php$thisphp-php>getUsernamephp(php)php,
php php php php php php php php php php php php php php php php php php php php php'passwordphp'php php=php>php php$thisphp-php>getPasswordphp(php)php,
php php php php php php php php php php php php php php php php php)php)php;
php php php php php php php php php php php php php php php php php$thisphp-php>php_loggedInphp php=php truephp;
php php php php php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php php php php php'Cannotphp loginphp intophp LiveDocxphp servicephp php-php usernamephp andphp/orphp passwordphp arephp invalidphp'php,php php0php,php php$e
php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp-php>php_loggedInphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Logphp outphp ofphp thephp LiveDocxphp service
php php php php php php*
php php php php php php*php php@throwsphp Zendphp_Servicephp_LiveDocxphp_Exception
php php php php php php*php php@returnphp boolean
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp logOutphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>isLoggedInphp(php)php)php php{
php php php php php php php php php php php php tryphp php{
php php php php php php php php php php php php php php php php php$thisphp-php>getSoapClientphp(php)php-php>LogOutphp(php)php;
php php php php php php php php php php php php php php php php php$thisphp-php>php_loggedInphp php=php falsephp;
php php php php php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Servicephp/LiveDocxphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Servicephp_LiveDocxphp_Exceptionphp(
php php php php php php php php php php php php php php php php php php php php php'Cannotphp logphp outphp ofphp LiveDocxphp servicephp'php,php php0php,php php$e
php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp-php>php_loggedInphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp truephp,php ifphp sessionphp isphp currentlyphp loggedphp intophp thephp backendphp server
php php php php php php*
php php php php php php*php php@returnphp boolean
php php php php php php*php php@sincephp php LiveDocxphp php1php.php2
php php php php php php*php/
php php php php publicphp functionphp isLoggedInphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_loggedInphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp username
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocx
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp setUsernamephp(php$usernamephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_credentialsphp[php'usernamephp'php]php php=php php$usernamephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp password
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocx
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp setPasswordphp(php$passwordphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_credentialsphp[php'passwordphp'php]php php=php php$passwordphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp WSDLphp ofphp LiveDocxphp webphp service
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocx
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp setWsdlphp(php$wsdlphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_wsdlphp php=php php$wsdlphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp currentphp username
php php php php php php*
php php php php php php*php php@returnphp stringphp|null
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp getUsernamephp(php)
php php php php php{
php php php php php php php php ifphp php(issetphp(php$thisphp-php>php_credentialsphp[php'usernamephp'php]php)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_credentialsphp[php'usernamephp'php]php;
php php php php php php php php php}

php php php php php php php php returnphp nullphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp currentphp password
php php php php php php*
php php php php php php*php php@returnphp stringphp|null
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp getPasswordphp(php)
php php php php php{
php php php php php php php php ifphp php(issetphp(php$thisphp-php>php_credentialsphp[php'passwordphp'php]php)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_credentialsphp[php'passwordphp'php]php;
php php php php php php php php php}

php php php php php php php php returnphp nullphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp WSDLphp ofphp LiveDocxphp webphp service
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Servicephp_LiveDocx
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp getWsdlphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_wsdlphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp thephp documentphp formatphp php(extensionphp)php ofphp aphp filename
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$filename
php php php php php php*php php@returnphp string
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp getFormatphp(php$filenamephp)
php php php php php{
php php php php php php php php returnphp strtolowerphp(substrphp(strrchrphp(php$filenamephp,php php'php.php'php)php,php php1php)php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Returnphp thephp currentphp APIphp version
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp getVersionphp(php)
php php php php php{
php php php php php php php php returnphp selfphp:php:VERSIONphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Comparephp thephp currentphp APIphp versionphp withphp anotherphp version
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$versionphp php(STRINGphp NOTphp FLOATphp)
php php php php php php*php php@returnphp intphp php-php1php php(versionphp isphp lessphp thanphp APIphp versionphp)php,php php0php php(versionsphp arephp equalphp)php,php orphp php1php php(versionphp isphp greaterphp thanphp APIphp versionphp)
php php php php php php*php php@sincephp php LiveDocxphp php1php.php0
php php php php php php*php/
php php php php publicphp functionphp compareVersionphp(php$versionphp)
php php php php php{
php php php php php php php php returnphp versionphp_comparephp(php$versionphp,php php$thisphp-php>getVersionphp(php)php)php;
php php php php php}
php}