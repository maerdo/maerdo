<php?php
php/php*php*
php php*php Zendphp Framework
php php*
php php*php LICENSE
php php*
php php*php Thisphp sourcephp filephp isphp subjectphp tophp thephp newphp BSDphp licensephp thatphp isphp bundled
php php*php withphp thisphp packagephp inphp thephp filephp LICENSEphp.txtphp.
php php*php Itphp isphp alsophp availablephp throughphp thephp worldphp-widephp-webphp atphp thisphp URLphp:
php php*php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsd
php php*php Ifphp youphp didphp notphp receivephp aphp copyphp ofphp thephp licensephp andphp arephp unablephp to
php php*php obtainphp itphp throughphp thephp worldphp-widephp-webphp,php pleasephp sendphp anphp email
php php*php tophp licensephp@zendphp.comphp sophp wephp canphp sendphp youphp aphp copyphp immediatelyphp.
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Form
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php/

php/php*php*
php php*php Zendphp_Formphp_DisplayGroup
php php*
php php*php php@categoryphp php php Zend
php php*php php@packagephp php php php Zendphp_Form
php php*php php@copyrightphp php Copyrightphp php(cphp)php php2php0php0php5php-php2php0php1php0php Zendphp Technologiesphp USAphp Incphp.php php(httpphp:php/php/wwwphp.zendphp.comphp)
php php*php php@licensephp php php php httpphp:php/php/frameworkphp.zendphp.comphp/licensephp/newphp-bsdphp php php php php Newphp BSDphp License
php php*php php@versionphp php php php php$Idphp:php DisplayGroupphp.phpphp php2php3php4php8php4php php2php0php1php0php-php1php2php-php1php0php php0php3php:php5php7php:php5php9Zphp mjhphp_caphp php$
php php*php/
classphp Zendphp_Formphp_DisplayGroupphp implementsphp Iteratorphp,Countable
php{
php php php php php/php*php*
php php php php php php*php Groupphp attributes
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_attribsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Displayphp groupphp decorators
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_decoratorsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Description
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_descriptionphp;

php php php php php/php*php*
php php php php php php*php Shouldphp wephp disablephp loadingphp thephp defaultphp decoratorsphp?
php php php php php php*php php@varphp bool
php php php php php php*php/
php php php php protectedphp php$php_disableLoadDefaultDecoratorsphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Elementphp order
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_elementOrderphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Elements
php php php php php php*php php@varphp array
php php php php php php*php/
php php php php protectedphp php$php_elementsphp php=php arrayphp(php)php;

php php php php php/php*php*
php php php php php php*php Formphp objectphp tophp whichphp thephp displayphp groupphp isphp currentlyphp registered
php php php php php php*
php php php php php php*php php@varphp Zendphp_Form
php php php php php php*php/
php php php php protectedphp php$php_formphp;

php php php php php/php*php*
php php php php php php*php Whetherphp orphp notphp aphp newphp elementphp hasphp beenphp addedphp tophp thephp group
php php php php php php*php php@varphp bool
php php php php php php*php/
php php php php protectedphp php$php_groupUpdatedphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php Pluginphp loaderphp forphp decorators
php php php php php php*php php@varphp Zendphp_Loaderphp_PluginLoader
php php php php php php*php/
php php php php protectedphp php$php_loaderphp;

php php php php php/php*php*
php php php php php php*php Groupphp name
php php php php php php*php php@varphp string
php php php php php php*php/
php php php php protectedphp php$php_namephp;

php php php php php/php*php*
php php php php php php*php Groupphp order
php php php php php php*php php@varphp int
php php php php php php*php/
php php php php protectedphp php$php_orderphp;

php php php php php/php*php*
php php php php php php*php php@varphp Zendphp_Translate
php php php php php php*php/
php php php php protectedphp php$php_translatorphp;

php php php php php/php*php*
php php php php php php*php Isphp translationphp disabledphp?
php php php php php php*php php@varphp bool
php php php php php php*php/
php php php php protectedphp php$php_translatorDisabledphp php=php falsephp;

php php php php php/php*php*
php php php php php php*php php@varphp Zendphp_Viewphp_Interface
php php php php php php*php/
php php php php protectedphp php$php_viewphp;

php php php php php/php*php*
php php php php php php*php Constructor
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$name
php php php php php php*php php@paramphp php Zendphp_Loaderphp_PluginLoaderphp php$loader
php php php php php php*php php@paramphp php arrayphp|Zendphp_Configphp php$options
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp php_php_constructphp(php$namephp,php Zendphp_Loaderphp_PluginLoaderphp php$loaderphp,php php$optionsphp php=php nullphp)
php php php php php{
php php php php php php php php php$thisphp-php>setNamephp(php$namephp)php;

php php php php php php php php php$thisphp-php>setPluginLoaderphp(php$loaderphp)php;

php php php php php php php php ifphp php(isphp_arrayphp(php$optionsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>setOptionsphp(php$optionsphp)php;
php php php php php php php php php}php elseifphp php(php$optionsphp instanceofphp Zendphp_Configphp)php php{
php php php php php php php php php php php php php$thisphp-php>setConfigphp(php$optionsphp)php;
php php php php php php php php php}

php php php php php php php php php/php/php Extensionsphp.php.php.
php php php php php php php php php$thisphp-php>initphp(php)php;

php php php php php php php php php$thisphp-php>loadDefaultDecoratorsphp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Initializephp objectphp;php usedphp byphp extendingphp classes
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp initphp(php)
php php php php php{
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp options
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$options
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setOptionsphp(arrayphp php$optionsphp)
php php php php php{
php php php php php php php php php$forbiddenphp php=php arrayphp(
php php php php php php php php php php php php php'Optionsphp'php,php php'Configphp'php,php php'PluginLoaderphp'php,php php'Viewphp'php,
php php php php php php php php php php php php php'Translatorphp'php,php php'Attribphp'
php php php php php php php php php)php;
php php php php php php php php foreachphp php(php$optionsphp asphp php$keyphp php=php>php php$valuephp)php php{
php php php php php php php php php php php php php$normalizedphp php=php ucfirstphp(php$keyphp)php;

php php php php php php php php php php php php ifphp php(inphp_arrayphp(php$normalizedphp,php php$forbiddenphp)php)php php{
php php php php php php php php php php php php php php php php continuephp;
php php php php php php php php php php php php php}

php php php php php php php php php php php php php$methodphp php=php php'setphp'php php.php php$normalizedphp;
php php php php php php php php php php php php ifphp php(methodphp_existsphp(php$thisphp,php php$methodphp)php)php php{
php php php php php php php php php php php php php php php php php$thisphp-php>php$methodphp(php$valuephp)php;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$thisphp-php>setAttribphp(php$keyphp,php php$valuephp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp optionsphp fromphp configphp object
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Configphp php$config
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setConfigphp(Zendphp_Configphp php$configphp)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>setOptionsphp(php$configphp-php>toArrayphp(php)php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp groupphp attribute
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$key
php php php php php php*php php@paramphp php mixedphp php$value
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setAttribphp(php$keyphp,php php$valuephp)
php php php php php{
php php php php php php php php php$keyphp php=php php(stringphp)php php$keyphp;
php php php php php php php php php$thisphp-php>php_attribsphp[php$keyphp]php php=php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp multiplephp formphp attributesphp atphp once
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$attribs
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp addAttribsphp(arrayphp php$attribsphp)
php php php php php{
php php php php php php php php foreachphp php(php$attribsphp asphp php$keyphp php=php>php php$valuephp)php php{
php php php php php php php php php php php php php$thisphp-php>setAttribphp(php$keyphp,php php$valuephp)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp multiplephp formphp attributesphp atphp once
php php php php php php*
php php php php php php*php Overwritesphp anyphp previouslyphp setphp attributesphp.
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$attribs
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setAttribsphp(arrayphp php$attribsphp)
php php php php php{
php php php php php php php php php$thisphp-php>clearAttribsphp(php)php;
php php php php php php php php returnphp php$thisphp-php>addAttribsphp(php$attribsphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp aphp singlephp formphp attribute
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$key
php php php php php php*php php@returnphp mixed
php php php php php php*php/
php php php php publicphp functionphp getAttribphp(php$keyphp)
php php php php php{
php php php php php php php php php$keyphp php=php php(stringphp)php php$keyphp;
php php php php php php php php ifphp php(php!issetphp(php$thisphp-php>php_attribsphp[php$keyphp]php)php)php php{
php php php php php php php php php php php php returnphp nullphp;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp-php>php_attribsphp[php$keyphp]php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp allphp formphp attributesphp/metadata
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getAttribsphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_attribsphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Removephp attribute
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$key
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp removeAttribphp(php$keyphp)
php php php php php{
php php php php php php php php ifphp php(arrayphp_keyphp_existsphp(php$keyphp,php php$thisphp-php>php_attribsphp)php)php php{
php php php php php php php php php php php php unsetphp(php$thisphp-php>php_attribsphp[php$keyphp]php)php;
php php php php php php php php php php php php returnphp truephp;
php php php php php php php php php}

php php php php php php php php returnphp falsephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Clearphp allphp formphp attributes
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Form
php php php php php php*php/
php php php php publicphp functionphp clearAttribsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_attribsphp php=php arrayphp(php)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp formphp objectphp tophp whichphp thephp displayphp groupphp isphp attached
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Formphp php$form
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setFormphp(Zendphp_Formphp php$formphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_formphp php=php php$formphp;

php php php php php php php php php/php/php Ensurephp anyphp elementsphp attachedphp priorphp tophp settingphp thephp formphp arephp now
php php php php php php php php php/php/php removedphp fromphp iterationphp byphp thephp form
php php php php php php php php foreachphp php(php$thisphp-php>getElementsphp(php)php asphp php$elementphp)php php{
php php php php php php php php php php php php php$formphp-php>removeFromIterationphp(php$elementphp-php>getNamephp(php)php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp formphp objectphp tophp whichphp thephp groupphp isphp attached
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Formphp|null
php php php php php php*php/
php php php php publicphp functionphp getFormphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_formphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Filterphp aphp namephp tophp onlyphp allowphp validphp variablephp characters
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$value
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp filterNamephp(php$valuephp)
php php php php php{
php php php php php php php php returnphp pregphp_replacephp(php'php/php[php^aphp-zAphp-Zphp0php-php9php_php\xphp7fphp-php\xffphp]php/php'php,php php'php'php,php php(stringphp)php php$valuephp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp groupphp name
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$name
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setNamephp(php$namephp)
php php php php php{
php php php php php php php php php$namephp php=php php$thisphp-php>filternamephp(php$namephp)php;
php php php php php php php php ifphp php(php(php'php0php'php php!php=php=php php$namephp)php php&php&php emptyphp(php$namephp)php)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Formphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Formphp_Exceptionphp(php'Invalidphp namephp providedphp;php mustphp containphp onlyphp validphp variablephp charactersphp andphp bephp nonphp-emptyphp'php)php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_namephp php=php php$namephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp groupphp name
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getNamephp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_namephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp fullyphp qualifiedphp name
php php php php php php*
php php php php php php*php Placesphp namephp asphp subitemphp ofphp arrayphp andphp/orphp appendsphp bracketsphp.
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getFullyQualifiedNamephp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>getNamephp(php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp elementphp id
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getIdphp(php)
php php php php php{
php php php php php php php php ifphp php(issetphp(php$thisphp-php>idphp)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>idphp;
php php php php php php php php php}

php php php php php php php php php$idphp php=php php$thisphp-php>getFullyQualifiedNamephp(php)php;

php php php php php php php php php/php/php Bailphp earlyphp ifphp nophp arrayphp notationphp detected
php php php php php php php php ifphp php(php!strstrphp(php$idphp,php php'php[php'php)php)php php{
php php php php php php php php php php php php returnphp php$idphp;
php php php php php php php php php}

php php php php php php php php php/php/php Stripphp arrayphp notation
php php php php php php php php ifphp php(php'php[php]php'php php=php=php substrphp(php$idphp,php php-php2php)php)php php{
php php php php php php php php php php php php php$idphp php=php substrphp(php$idphp,php php0php,php strlenphp(php$idphp)php php-php php2php)php;
php php php php php php php php php}
php php php php php php php php php$idphp php=php strphp_replacephp(php'php]php[php'php,php php'php-php'php,php php$idphp)php;
php php php php php php php php php$idphp php=php strphp_replacephp(arrayphp(php'php]php'php,php php'php[php'php)php,php php'php-php'php,php php$idphp)php;
php php php php php php php php php$idphp php=php trimphp(php$idphp,php php'php-php'php)php;

php php php php php php php php returnphp php$idphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp groupphp legend
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$legend
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setLegendphp(php$legendphp)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>setAttribphp(php'legendphp'php,php php(stringphp)php php$legendphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp groupphp legend
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getLegendphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>getAttribphp(php'legendphp'php)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp description
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$value
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setDescriptionphp(php$valuephp)
php php php php php{
php php php php php php php php php$thisphp-php>php_descriptionphp php=php php(stringphp)php php$valuephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Getphp description
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp getDescriptionphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_descriptionphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp groupphp order
php php php php php php*
php php php php php php*php php@paramphp php intphp php$order
php php php php php php*php php@returnphp Zendphp_Formphp_Element
php php php php php php*php/
php php php php publicphp functionphp setOrderphp(php$orderphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_orderphp php=php php(intphp)php php$orderphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp groupphp order
php php php php php php*
php php php php php php*php php@returnphp int
php php php php php php*php/
php php php php publicphp functionphp getOrderphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_orderphp;
php php php php php}

php php php php php/php/php Elements

php php php php php/php*php*
php php php php php php*php Addphp elementphp tophp stack
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Formphp_Elementphp php$element
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp addElementphp(Zendphp_Formphp_Elementphp php$elementphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_elementsphp[php$elementphp-php>getNamephp(php)php]php php=php php$elementphp;
php php php php php php php php php$thisphp-php>php_groupUpdatedphp php=php truephp;

php php php php php php php php php/php/php Displayphp groupphp willphp nowphp handlephp displayphp ofphp element
php php php php php php php php ifphp php(nullphp php!php=php=php php(php$formphp php=php php$thisphp-php>getFormphp(php)php)php)php php{
php php php php php php php php php php php php php$formphp-php>removeFromIterationphp(php$elementphp-php>getNamephp(php)php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp multiplephp elementsphp atphp once
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$elements
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php php@throwsphp Zendphp_Formphp_Exceptionphp ifphp anyphp elementphp isphp notphp aphp Zendphp_Formphp_Element
php php php php php php*php/
php php php php publicphp functionphp addElementsphp(arrayphp php$elementsphp)
php php php php php{
php php php php php php php php foreachphp php(php$elementsphp asphp php$elementphp)php php{
php php php php php php php php php php php php ifphp php(php!php$elementphp instanceofphp Zendphp_Formphp_Elementphp)php php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Formphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Formphp_Exceptionphp(php'elementsphp passedphp viaphp arrayphp tophp addElementsphp(php)php mustphp bephp Zendphp_Formphp_Elementsphp onlyphp'php)php;
php php php php php php php php php php php php php}
php php php php php php php php php php php php php$thisphp-php>addElementphp(php$elementphp)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp multiplephp elementsphp atphp oncephp php(overwritesphp)
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$elements
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setElementsphp(arrayphp php$elementsphp)
php php php php php{
php php php php php php php php php$thisphp-php>clearElementsphp(php)php;
php php php php php php php php returnphp php$thisphp-php>addElementsphp(php$elementsphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp element
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$name
php php php php php php*php php@returnphp Zendphp_Formphp_Elementphp|null
php php php php php php*php/
php php php php publicphp functionphp getElementphp(php$namephp)
php php php php php{
php php php php php php php php php$namephp php=php php(stringphp)php php$namephp;
php php php php php php php php ifphp php(issetphp(php$thisphp-php>php_elementsphp[php$namephp]php)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_elementsphp[php$namephp]php;
php php php php php php php php php}

php php php php php php php php returnphp nullphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp elements
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getElementsphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_elementsphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Removephp aphp singlephp element
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$name
php php php php php php*php php@returnphp boolean
php php php php php php*php/
php php php php publicphp functionphp removeElementphp(php$namephp)
php php php php php{
php php php php php php php php php$namephp php=php php(stringphp)php php$namephp;
php php php php php php php php ifphp php(arrayphp_keyphp_existsphp(php$namephp,php php$thisphp-php>php_elementsphp)php)php php{
php php php php php php php php php php php php unsetphp(php$thisphp-php>php_elementsphp[php$namephp]php)php;
php php php php php php php php php php php php php$thisphp-php>php_groupUpdatedphp php=php truephp;
php php php php php php php php php php php php returnphp truephp;
php php php php php php php php php}

php php php php php php php php returnphp falsephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Removephp allphp elements
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp clearElementsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_elementsphp php=php arrayphp(php)php;
php php php php php php php php php$thisphp-php>php_groupUpdatedphp php=php truephp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php/php Pluginphp loaderphp php(forphp decoratorsphp)

php php php php php/php*php*
php php php php php php*php Setphp pluginphp loader
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Loaderphp_PluginLoaderphp php$loader
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setPluginLoaderphp(Zendphp_Loaderphp_PluginLoaderphp php$loaderphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_loaderphp php=php php$loaderphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp pluginphp loader
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Loaderphp_PluginLoader
php php php php php php*php/
php php php php publicphp functionphp getPluginLoaderphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_loaderphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp aphp prefixphp pathphp forphp thephp pluginphp loader
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$prefix
php php php php php php*php php@paramphp php stringphp php$path
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp addPrefixPathphp(php$prefixphp,php php$pathphp)
php php php php php{
php php php php php php php php php$thisphp-php>getPluginLoaderphp(php)php-php>addPrefixPathphp(php$prefixphp,php php$pathphp)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp severalphp prefixphp pathsphp atphp once
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$spec
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp addPrefixPathsphp(arrayphp php$specphp)
php php php php php{
php php php php php php php php ifphp php(issetphp(php$specphp[php'prefixphp'php]php)php php&php&php issetphp(php$specphp[php'pathphp'php]php)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>addPrefixPathphp(php$specphp[php'prefixphp'php]php,php php$specphp[php'pathphp'php]php)php;
php php php php php php php php php}
php php php php php php php php foreachphp php(php$specphp asphp php$prefixphp php=php>php php$pathsphp)php php{
php php php php php php php php php php php php ifphp php(isphp_numericphp(php$prefixphp)php php&php&php isphp_arrayphp(php$pathsphp)php)php php{
php php php php php php php php php php php php php php php php php$prefixphp php=php nullphp;
php php php php php php php php php php php php php php php php ifphp php(issetphp(php$pathsphp[php'prefixphp'php]php)php php&php&php issetphp(php$pathsphp[php'pathphp'php]php)php)php php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addPrefixPathphp(php$pathsphp[php'prefixphp'php]php,php php$pathsphp[php'pathphp'php]php)php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elseifphp php(php!isphp_numericphp(php$prefixphp)php)php php{
php php php php php php php php php php php php php php php php ifphp php(isphp_stringphp(php$pathsphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addPrefixPathphp(php$prefixphp,php php$pathsphp)php;
php php php php php php php php php php php php php php php php php}php elseifphp php(isphp_arrayphp(php$pathsphp)php)php php{
php php php php php php php php php php php php php php php php php php php php foreachphp php(php$pathsphp asphp php$pathphp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addPrefixPathphp(php$prefixphp,php php$pathphp)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php/php Decorators

php php php php php/php*php*
php php php php php php*php Setphp flagphp tophp disablephp loadingphp defaultphp decorators
php php php php php php*
php php php php php php*php php@paramphp php boolphp php$flag
php php php php php php*php php@returnphp Zendphp_Formphp_Element
php php php php php php*php/
php php php php publicphp functionphp setDisableLoadDefaultDecoratorsphp(php$flagphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_disableLoadDefaultDecoratorsphp php=php php(boolphp)php php$flagphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Shouldphp wephp loadphp thephp defaultphp decoratorsphp?
php php php php php php*
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp loadDefaultDecoratorsIsDisabledphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_disableLoadDefaultDecoratorsphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Loadphp defaultphp decorators
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp loadDefaultDecoratorsphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>loadDefaultDecoratorsIsDisabledphp(php)php)php php{
php php php php php php php php php php php php returnphp php$thisphp;
php php php php php php php php php}

php php php php php php php php php$decoratorsphp php=php php$thisphp-php>getDecoratorsphp(php)php;
php php php php php php php php ifphp php(emptyphp(php$decoratorsphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>addDecoratorphp(php'FormElementsphp'php)
php php php php php php php php php php php php php php php php php php-php>addDecoratorphp(php'HtmlTagphp'php,php arrayphp(php'tagphp'php php=php>php php'dlphp'php)php)
php php php php php php php php php php php php php php php php php php-php>addDecoratorphp(php'Fieldsetphp'php)
php php php php php php php php php php php php php php php php php php-php>addDecoratorphp(php'DtDdWrapperphp'php)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Instantiatephp aphp decoratorphp basedphp onphp classphp namephp orphp classphp namephp fragment
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$name
php php php php php php*php php@paramphp php nullphp|arrayphp php$options
php php php php php php*php php@returnphp Zendphp_Formphp_Decoratorphp_Interface
php php php php php php*php/
php php php php protectedphp functionphp php_getDecoratorphp(php$namephp,php php$optionsphp php=php nullphp)
php php php php php{
php php php php php php php php php$classphp php=php php$thisphp-php>getPluginLoaderphp(php)php-php>loadphp(php$namephp)php;
php php php php php php php php ifphp php(nullphp php=php=php=php php$optionsphp)php php{
php php php php php php php php php php php php php$decoratorphp php=php newphp php$classphp;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php$decoratorphp php=php newphp php$classphp(php$optionsphp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$decoratorphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp aphp decoratorphp forphp renderingphp thephp group
php php php php php php*
php php php php php php*php php@paramphp php stringphp|Zendphp_Formphp_Decoratorphp_Interfacephp php$decorator
php php php php php php*php php@paramphp php arrayphp|Zendphp_Configphp php$optionsphp Optionsphp withphp whichphp tophp initializephp decorator
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp addDecoratorphp(php$decoratorphp,php php$optionsphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(php$decoratorphp instanceofphp Zendphp_Formphp_Decoratorphp_Interfacephp)php php{
php php php php php php php php php php php php php$namephp php=php getphp_classphp(php$decoratorphp)php;
php php php php php php php php php}php elseifphp php(isphp_stringphp(php$decoratorphp)php)php php{
php php php php php php php php php php php php php$namephp php php php php php php=php php$decoratorphp;
php php php php php php php php php php php php php$decoratorphp php=php arrayphp(
php php php php php php php php php php php php php php php php php'decoratorphp'php php=php>php php$namephp,
php php php php php php php php php php php php php php php php php'optionsphp'php php php php=php>php php$optionsphp,
php php php php php php php php php php php php php)php;
php php php php php php php php php}php elseifphp php(isphp_arrayphp(php$decoratorphp)php)php php{
php php php php php php php php php php php php foreachphp php(php$decoratorphp asphp php$namephp php=php>php php$specphp)php php{
php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php}
php php php php php php php php php php php php ifphp php(isphp_numericphp(php$namephp)php)php php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Formphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Formphp_Exceptionphp(php'Invalidphp aliasphp providedphp tophp addDecoratorphp;php mustphp bephp alphanumericphp stringphp'php)php;
php php php php php php php php php php php php php}
php php php php php php php php php php php php ifphp php(isphp_stringphp(php$specphp)php)php php{
php php php php php php php php php php php php php php php php php$decoratorphp php=php arrayphp(
php php php php php php php php php php php php php php php php php php php php php'decoratorphp'php php=php>php php$specphp,
php php php php php php php php php php php php php php php php php php php php php'optionsphp'php php php php=php>php php$optionsphp,
php php php php php php php php php php php php php php php php php)php;
php php php php php php php php php php php php php}php elseifphp php(php$specphp instanceofphp Zendphp_Formphp_Decoratorphp_Interfacephp)php php{
php php php php php php php php php php php php php php php php php$decoratorphp php=php php$specphp;
php php php php php php php php php php php php php}
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Formphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Formphp_Exceptionphp(php'Invalidphp decoratorphp providedphp tophp addDecoratorphp;php mustphp bephp stringphp orphp Zendphp_Formphp_Decoratorphp_Interfacephp'php)php;
php php php php php php php php php}

php php php php php php php php php$thisphp-php>php_decoratorsphp[php$namephp]php php=php php$decoratorphp;

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Addphp manyphp decoratorsphp atphp once
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$decorators
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp addDecoratorsphp(arrayphp php$decoratorsphp)
php php php php php{
php php php php php php php php foreachphp php(php$decoratorsphp asphp php$decoratorNamephp php=php>php php$decoratorInfophp)php php{
php php php php php php php php php php php php ifphp php(isphp_stringphp(php$decoratorInfophp)php php|php|
php php php php php php php php php php php php php php php php php$decoratorInfophp instanceofphp Zendphp_Formphp_Decoratorphp_Interfacephp)php php{
php php php php php php php php php php php php php php php php ifphp php(php!isphp_numericphp(php$decoratorNamephp)php)php php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addDecoratorphp(arrayphp(php$decoratorNamephp php=php>php php$decoratorInfophp)php)php;
php php php php php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addDecoratorphp(php$decoratorInfophp)php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elseifphp php(isphp_arrayphp(php$decoratorInfophp)php)php php{
php php php php php php php php php php php php php php php php php$argcphp php php php php=php countphp(php$decoratorInfophp)php;
php php php php php php php php php php php php php php php php php$optionsphp php=php arrayphp(php)php;
php php php php php php php php php php php php php php php php ifphp php(issetphp(php$decoratorInfophp[php'decoratorphp'php]php)php)php php{
php php php php php php php php php php php php php php php php php php php php php$decoratorphp php=php php$decoratorInfophp[php'decoratorphp'php]php;
php php php php php php php php php php php php php php php php php php php php ifphp php(issetphp(php$decoratorInfophp[php'optionsphp'php]php)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php$optionsphp php=php php$decoratorInfophp[php'optionsphp'php]php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addDecoratorphp(php$decoratorphp,php php$optionsphp)php;
php php php php php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php php php php switchphp php(truephp)php php{
php php php php php php php php php php php php php php php php php php php php php php php php casephp php(php0php php=php=php php$argcphp)php:
php php php php php php php php php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php php php php php php php php php casephp php(php1php <php=php php$argcphp)php:
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php$decoratorphp php php=php arrayphp_shiftphp(php$decoratorInfophp)php;
php php php php php php php php php php php php php php php php php php php php php php php php casephp php(php2php <php=php php$argcphp)php:
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php$optionsphp php=php arrayphp_shiftphp(php$decoratorInfophp)php;
php php php php php php php php php php php php php php php php php php php php php php php php defaultphp:
php php php php php php php php php php php php php php php php php php php php php php php php php php php php php$thisphp-php>addDecoratorphp(php$decoratorphp,php php$optionsphp)php;
php php php php php php php php php php php php php php php php php php php php php php php php php php php php breakphp;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Formphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php php php php php throwphp newphp Zendphp_Formphp_Exceptionphp(php'Invalidphp decoratorphp passedphp tophp addDecoratorsphp(php)php'php)php;
php php php php php php php php php php php php php}
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Overwritephp allphp decorators
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$decorators
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setDecoratorsphp(arrayphp php$decoratorsphp)
php php php php php{
php php php php php php php php php$thisphp-php>clearDecoratorsphp(php)php;
php php php php php php php php returnphp php$thisphp-php>addDecoratorsphp(php$decoratorsphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp aphp registeredphp decorator
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$name
php php php php php php*php php@returnphp falsephp|Zendphp_Formphp_Decoratorphp_Abstract
php php php php php php*php/
php php php php publicphp functionphp getDecoratorphp(php$namephp)
php php php php php{
php php php php php php php php ifphp php(php!issetphp(php$thisphp-php>php_decoratorsphp[php$namephp]php)php)php php{
php php php php php php php php php php php php php$lenphp php=php strlenphp(php$namephp)php;
php php php php php php php php php php php php foreachphp php(php$thisphp-php>php_decoratorsphp asphp php$localNamephp php=php>php php$decoratorphp)php php{
php php php php php php php php php php php php php php php php ifphp php(php$lenphp php>php strlenphp(php$localNamephp)php)php php{
php php php php php php php php php php php php php php php php php php php php continuephp;
php php php php php php php php php php php php php php php php php}

php php php php php php php php php php php php php php php php ifphp php(php0php php=php=php=php substrphp_comparephp(php$localNamephp,php php$namephp,php php-php$lenphp,php php$lenphp,php truephp)php)php php{
php php php php php php php php php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$decoratorphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php returnphp php$thisphp-php>php_loadDecoratorphp(php$decoratorphp,php php$localNamephp)php;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php returnphp php$decoratorphp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}
php php php php php php php php php php php php returnphp falsephp;
php php php php php php php php php}

php php php php php php php php ifphp php(isphp_arrayphp(php$thisphp-php>php_decoratorsphp[php$namephp]php)php)php php{
php php php php php php php php php php php php returnphp php$thisphp-php>php_loadDecoratorphp(php$thisphp-php>php_decoratorsphp[php$namephp]php,php php$namephp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp-php>php_decoratorsphp[php$namephp]php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp allphp decorators
php php php php php php*
php php php php php php*php php@returnphp array
php php php php php php*php/
php php php php publicphp functionphp getDecoratorsphp(php)
php php php php php{
php php php php php php php php foreachphp php(php$thisphp-php>php_decoratorsphp asphp php$keyphp php=php>php php$valuephp)php php{
php php php php php php php php php php php php ifphp php(isphp_arrayphp(php$valuephp)php)php php{
php php php php php php php php php php php php php php php php php$thisphp-php>php_loadDecoratorphp(php$valuephp,php php$keyphp)php;
php php php php php php php php php php php php php}
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp-php>php_decoratorsphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Removephp aphp singlephp decorator
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$name
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp removeDecoratorphp(php$namephp)
php php php php php{
php php php php php php php php php$decoratorphp php=php php$thisphp-php>getDecoratorphp(php$namephp)php;
php php php php php php php php ifphp php(php$decoratorphp)php php{
php php php php php php php php php php php php ifphp php(arrayphp_keyphp_existsphp(php$namephp,php php$thisphp-php>php_decoratorsphp)php)php php{
php php php php php php php php php php php php php php php php unsetphp(php$thisphp-php>php_decoratorsphp[php$namephp]php)php;
php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php$classphp php=php getphp_classphp(php$decoratorphp)php;
php php php php php php php php php php php php php php php php unsetphp(php$thisphp-php>php_decoratorsphp[php$classphp]php)php;
php php php php php php php php php php php php php}
php php php php php php php php php php php php returnphp truephp;
php php php php php php php php php}

php php php php php php php php returnphp falsephp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Clearphp allphp decorators
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp clearDecoratorsphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_decoratorsphp php=php arrayphp(php)php;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp view
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Viewphp_Interfacephp php$view
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setViewphp(Zendphp_Viewphp_Interfacephp php$viewphp php=php nullphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_viewphp php=php php$viewphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp view
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Viewphp_Interface
php php php php php php*php/
php php php php publicphp functionphp getViewphp(php)
php php php php php{
php php php php php php php php ifphp php(nullphp php=php=php=php php$thisphp-php>php_viewphp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Controllerphp/Actionphp/HelperBrokerphp.phpphp'php;
php php php php php php php php php php php php php$viewRendererphp php=php Zendphp_Controllerphp_Actionphp_HelperBrokerphp:php:getStaticHelperphp(php'viewRendererphp'php)php;
php php php php php php php php php php php php php$thisphp-php>setViewphp(php$viewRendererphp-php>viewphp)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp-php>php_viewphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Renderphp displayphp group
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp renderphp(Zendphp_Viewphp_Interfacephp php$viewphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(nullphp php!php=php=php php$viewphp)php php{
php php php php php php php php php php php php php$thisphp-php>setViewphp(php$viewphp)php;
php php php php php php php php php}
php php php php php php php php php$contentphp php=php php'php'php;
php php php php php php php php foreachphp php(php$thisphp-php>getDecoratorsphp(php)php asphp php$decoratorphp)php php{
php php php php php php php php php php php php php$decoratorphp-php>setElementphp(php$thisphp)php;
php php php php php php php php php php php php php$contentphp php=php php$decoratorphp-php>renderphp(php$contentphp)php;
php php php php php php php php php}
php php php php php php php php returnphp php$contentphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Stringphp representationphp ofphp group
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp php_php_toStringphp(php)
php php php php php{
php php php php php php php php tryphp php{
php php php php php php php php php php php php php$returnphp php=php php$thisphp-php>renderphp(php)php;
php php php php php php php php php php php php returnphp php$returnphp;
php php php php php php php php php}php catchphp php(Exceptionphp php$ephp)php php{
php php php php php php php php php php php php triggerphp_errorphp(php$ephp-php>getMessagephp(php)php,php Ephp_USERphp_WARNINGphp)php;
php php php php php php php php php php php php returnphp php'php'php;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Setphp translatorphp object
php php php php php php*
php php php php php php*php php@paramphp php Zendphp_Translatephp|Zendphp_Translatephp_Adapterphp|nullphp php$translator
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setTranslatorphp(php$translatorphp php=php nullphp)
php php php php php{
php php php php php php php php ifphp php(php(nullphp php=php=php=php php$translatorphp)php php|php|php php(php$translatorphp instanceofphp Zendphp_Translatephp_Adapterphp)php)php php{
php php php php php php php php php php php php php$thisphp-php>php_translatorphp php=php php$translatorphp;
php php php php php php php php php}php elseifphp php(php$translatorphp instanceofphp Zendphp_Translatephp)php php{
php php php php php php php php php php php php php$thisphp-php>php_translatorphp php=php php$translatorphp-php>getAdapterphp(php)php;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Formphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Formphp_Exceptionphp(php'Invalidphp translatorphp specifiedphp'php)php;
php php php php php php php php php}
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Retrievephp translatorphp object
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Translatephp_Adapterphp|null
php php php php php php*php/
php php php php publicphp functionphp getTranslatorphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>translatorIsDisabledphp(php)php)php php{
php php php php php php php php php php php php returnphp nullphp;
php php php php php php php php php}

php php php php php php php php ifphp php(nullphp php=php=php=php php$thisphp-php>php_translatorphp)php php{
php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Formphp.phpphp'php;
php php php php php php php php php php php php returnphp Zendphp_Formphp:php:getDefaultTranslatorphp(php)php;
php php php php php php php php php}

php php php php php php php php returnphp php$thisphp-php>php_translatorphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Indicatephp whetherphp orphp notphp translationphp shouldphp bephp disabled
php php php php php php*
php php php php php php*php php@paramphp php boolphp php$flag
php php php php php php*php php@returnphp Zendphp_Formphp_DisplayGroup
php php php php php php*php/
php php php php publicphp functionphp setDisableTranslatorphp(php$flagphp)
php php php php php{
php php php php php php php php php$thisphp-php>php_translatorDisabledphp php=php php(boolphp)php php$flagphp;
php php php php php php php php returnphp php$thisphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Isphp translationphp disabledphp?
php php php php php php*
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp translatorIsDisabledphp(php)
php php php php php{
php php php php php php php php returnphp php$thisphp-php>php_translatorDisabledphp;
php php php php php}

php php php php php/php*php*
php php php php php php*php Overloadingphp:php allowphp renderingphp specificphp decorators
php php php php php php*
php php php php php php*php Callphp renderDecoratorNamephp(php)php tophp renderphp aphp specificphp decoratorphp.
php php php php php php*
php php php php php php*php php@paramphp php stringphp php$method
php php php php php php*php php@paramphp php arrayphp php$args
php php php php php php*php php@returnphp string
php php php php php php*php php@throwsphp Zendphp_Formphp_Exceptionphp forphp invalidphp decoratorphp orphp invalidphp methodphp call
php php php php php php*php/
php php php php publicphp functionphp php_php_callphp(php$methodphp,php php$argsphp)
php php php php php{
php php php php php php php php ifphp php(php'renderphp'php php=php=php substrphp(php$methodphp,php php0php,php php6php)php)php php{
php php php php php php php php php php php php php$decoratorNamephp php=php substrphp(php$methodphp,php php6php)php;
php php php php php php php php php php php php ifphp php(falsephp php!php=php=php php(php$decoratorphp php=php php$thisphp-php>getDecoratorphp(php$decoratorNamephp)php)php)php php{
php php php php php php php php php php php php php php php php php$decoratorphp-php>setElementphp(php$thisphp)php;
php php php php php php php php php php php php php php php php php$seedphp php=php php'php'php;
php php php php php php php php php php php php php php php php ifphp php(php0php <php countphp(php$argsphp)php)php php{
php php php php php php php php php php php php php php php php php php php php php$seedphp php=php arrayphp_shiftphp(php$argsphp)php;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php returnphp php$decoratorphp-php>renderphp(php$seedphp)php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php requirephp_oncephp php'Zendphp/Formphp/Exceptionphp.phpphp'php;
php php php php php php php php php php php php throwphp newphp Zendphp_Formphp_Exceptionphp(sprintfphp(php'Decoratorphp byphp namephp php%sphp doesphp notphp existphp'php,php php$decoratorNamephp)php)php;
php php php php php php php php php}

php php php php php php php php requirephp_oncephp php'Zendphp/Formphp/Exceptionphp.phpphp'php;
php php php php php php php php throwphp newphp Zendphp_Formphp_Exceptionphp(sprintfphp(php'Methodphp php%sphp doesphp notphp existphp'php,php php$methodphp)php)php;
php php php php php}

php php php php php/php/php Interfacesphp:php Iteratorphp,php Countable

php php php php php/php*php*
php php php php php php*php Currentphp element
php php php php php php*
php php php php php php*php php@returnphp Zendphp_Formphp_Element
php php php php php php*php/
php php php php publicphp functionphp currentphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_sortphp(php)php;
php php php php php php php php currentphp(php$thisphp-php>php_elementOrderphp)php;
php php php php php php php php php$keyphp php=php keyphp(php$thisphp-php>php_elementOrderphp)php;
php php php php php php php php returnphp php$thisphp-php>getElementphp(php$keyphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Currentphp element
php php php php php php*
php php php php php php*php php@returnphp string
php php php php php php*php/
php php php php publicphp functionphp keyphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_sortphp(php)php;
php php php php php php php php returnphp keyphp(php$thisphp-php>php_elementOrderphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Movephp pointerphp tophp nextphp element
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp nextphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_sortphp(php)php;
php php php php php php php php nextphp(php$thisphp-php>php_elementOrderphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Movephp pointerphp tophp beginningphp ofphp elementphp loop
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php publicphp functionphp rewindphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_sortphp(php)php;
php php php php php php php php resetphp(php$thisphp-php>php_elementOrderphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Determinephp ifphp currentphp elementphp/subformphp/displayphp groupphp isphp valid
php php php php php php*
php php php php php php*php php@returnphp bool
php php php php php php*php/
php php php php publicphp functionphp validphp(php)
php php php php php{
php php php php php php php php php$thisphp-php>php_sortphp(php)php;
php php php php php php php php returnphp php(currentphp(php$thisphp-php>php_elementOrderphp)php php!php=php=php falsephp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Countphp ofphp elementsphp/subformsphp thatphp arephp iterable
php php php php php php*
php php php php php php*php php@returnphp int
php php php php php php*php/
php php php php publicphp functionphp countphp(php)
php php php php php{
php php php php php php php php returnphp countphp(php$thisphp-php>php_elementsphp)php;
php php php php php}

php php php php php/php*php*
php php php php php php*php Sortphp itemsphp accordingphp tophp theirphp order
php php php php php php*
php php php php php php*php php@returnphp void
php php php php php php*php/
php php php php protectedphp functionphp php_sortphp(php)
php php php php php{
php php php php php php php php ifphp php(php$thisphp-php>php_groupUpdatedphp php|php|php php!isphp_arrayphp(php$thisphp-php>php_elementOrderphp)php)php php{
php php php php php php php php php php php php php$elementOrderphp php=php arrayphp(php)php;
php php php php php php php php php php php php foreachphp php(php$thisphp-php>getElementsphp(php)php asphp php$keyphp php=php>php php$elementphp)php php{
php php php php php php php php php php php php php php php php php$elementOrderphp[php$keyphp]php php=php php$elementphp-php>getOrderphp(php)php;
php php php php php php php php php php php php php}

php php php php php php php php php php php php php$itemsphp php=php arrayphp(php)php;
php php php php php php php php php php php php php$indexphp php=php php0php;
php php php php php php php php php php php php foreachphp php(php$elementOrderphp asphp php$keyphp php=php>php php$orderphp)php php{
php php php php php php php php php php php php php php php php ifphp php(nullphp php=php=php=php php$orderphp)php php{
php php php php php php php php php php php php php php php php php php php php whilephp php(arrayphp_searchphp(php$indexphp,php php$elementOrderphp,php truephp)php)php php{
php php php php php php php php php php php php php php php php php php php php php php php php php+php+php$indexphp;
php php php php php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php php php php php$itemsphp[php$indexphp]php php=php php$keyphp;
php php php php php php php php php php php php php php php php php php php php php+php+php$indexphp;
php php php php php php php php php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php php php php php php php php php$itemsphp[php$orderphp]php php=php php$keyphp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php}

php php php php php php php php php php php php php$itemsphp php=php arrayphp_flipphp(php$itemsphp)php;
php php php php php php php php php php php php asortphp(php$itemsphp)php;
php php php php php php php php php php php php php$thisphp-php>php_elementOrderphp php=php php$itemsphp;
php php php php php php php php php php php php php$thisphp-php>php_groupUpdatedphp php=php falsephp;
php php php php php php php php php}
php php php php php}

php php php php php/php*php*
php php php php php php*php Lazyphp-loadphp aphp decorator
php php php php php php*
php php php php php php*php php@paramphp php arrayphp php$decoratorphp Decoratorphp typephp andphp options
php php php php php php*php php@paramphp php mixedphp php$namephp Decoratorphp namephp orphp alias
php php php php php php*php php@returnphp Zendphp_Formphp_Decoratorphp_Interface
php php php php php php*php/
php php php php protectedphp functionphp php_loadDecoratorphp(arrayphp php$decoratorphp,php php$namephp)
php php php php php{
php php php php php php php php php$sameNamephp php=php falsephp;
php php php php php php php php ifphp php(php$namephp php=php=php php$decoratorphp[php'decoratorphp'php]php)php php{
php php php php php php php php php php php php php$sameNamephp php=php truephp;
php php php php php php php php php}

php php php php php php php php php$instancephp php=php php$thisphp-php>php_getDecoratorphp(php$decoratorphp[php'decoratorphp'php]php,php php$decoratorphp[php'optionsphp'php]php)php;
php php php php php php php php ifphp php(php$sameNamephp)php php{
php php php php php php php php php php php php php$newNamephp php php php php php php php php php php php php=php getphp_classphp(php$instancephp)php;
php php php php php php php php php php php php php$decoratorNamesphp php php php php php=php arrayphp_keysphp(php$thisphp-php>php_decoratorsphp)php;
php php php php php php php php php php php php php$orderphp php php php php php php php php php php php php php php=php arrayphp_flipphp(php$decoratorNamesphp)php;
php php php php php php php php php php php php php$orderphp[php$newNamephp]php php php php php=php php$orderphp[php$namephp]php;
php php php php php php php php php php php php php$decoratorsExchangephp php=php arrayphp(php)php;
php php php php php php php php php php php php unsetphp(php$orderphp[php$namephp]php)php;
php php php php php php php php php php php php asortphp(php$orderphp)php;
php php php php php php php php php php php php foreachphp php(php$orderphp asphp php$keyphp php=php>php php$indexphp)php php{
php php php php php php php php php php php php php php php php ifphp php(php$keyphp php=php=php php$newNamephp)php php{
php php php php php php php php php php php php php php php php php php php php php$decoratorsExchangephp[php$keyphp]php php=php php$instancephp;
php php php php php php php php php php php php php php php php php php php php continuephp;
php php php php php php php php php php php php php php php php php}
php php php php php php php php php php php php php php php php php$decoratorsExchangephp[php$keyphp]php php=php php$thisphp-php>php_decoratorsphp[php$keyphp]php;
php php php php php php php php php php php php php}
php php php php php php php php php php php php php$thisphp-php>php_decoratorsphp php=php php$decoratorsExchangephp;
php php php php php php php php php}php elsephp php{
php php php php php php php php php php php php php$thisphp-php>php_decoratorsphp[php$namephp]php php=php php$instancephp;
php php php php php php php php php}

php php php php php php php php returnphp php$instancephp;
php php php php php}
php}
